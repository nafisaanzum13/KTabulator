(this.webpackJsonpKGWrangler=this.webpackJsonpKGWrangler||[]).push([[0],{49:function(e,t,a){e.exports=a(78)},55:function(e,t,a){},56:function(e,t,a){},78:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(21),o=a.n(l),s=(a(54),a(55),a(56),a(7)),i=a(8),c=a(9),u=a(10),p=a(11),d=a(24),h=a(2),b=a(85),g=a(18),m=a(44),f=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row header-body"},r.a.createElement("div",{className:"col-md-8"},r.a.createElement("a",{href:"index.html",class:"logo"},r.a.createElement("b",null,r.a.createElement("span",null,"KG"),"Wrangler"))),r.a.createElement("div",{className:"offset-md-2 col-md-2 row"},r.a.createElement("div",{className:"col-md-4"},r.a.createElement("button",{className:"btn btn-default",title:"copy table to csv",onClick:function(){return e.props.copyTable()}},r.a.createElement(g.a,{className:"logo-left-color"}))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("button",{className:"btn btn-default",title:"Union Table Settings"},r.a.createElement(m.a,{className:"logo-left-color",onClick:function(){return e.props.openModal()}}))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("button",{className:"btn btn-default",title:"undo previous action",onClick:function(){return e.props.undoPreviousStep()}},r.a.createElement(g.e,{className:"color-wrangler"}))))),r.a.createElement("hr",{class:"header-hr"}))}}]),t}(n.Component),v=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"text-center text-sm"},r.a.createElement("small",null,"University of Waterloo, 2020")))}}]),t}(n.Component),C=a(27),y=a.n(C),A=a(45),E=a.n(A),S=(a(68),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(y.a,{isOpen:this.props.showSetting,className:"setting-modal"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 offset-md-3"},r.a.createElement("h4",null,"Table Union Search Settings"))),r.a.createElement("br",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4"},"Semantic Mapping:"),r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{onChange:function(t){return e.props.toggleSemantic(t)}},r.a.createElement("input",{type:"radio",value:"enabled",checked:"enabled"===this.props.semanticEnabled})," ","Enabled",r.a.createElement("input",{type:"radio",value:"disabled",checked:"disabled"===this.props.semanticEnabled})," ","Disabled"))),r.a.createElement("br",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4"},"Percentage of Columns to Union:"),r.a.createElement("div",{className:"col-md-6"},r.a.createElement(E.a,{value:this.props.unionCutOff,onChange:function(t){return e.props.unionCutOffChange(t)},min:0,max:1,step:.05}))),r.a.createElement("br",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4 offset-md-4"},r.a.createElement("button",{onClick:function(){return e.props.closeModal()}},"Confirm Settings"))))))}}]),t}(n.Component)),k=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){for(var e=this,t=[],a=function(a){t.push(r.a.createElement("div",null,r.a.createElement("input",{type:"checkbox",checked:e.props.dataAndChecked[a].checked,onChange:function(t){return e.props.toggleChecked(t,a)}}),e.props.dataAndChecked[a].data))},n=0;n<this.props.dataAndChecked.length;++n)a(n);return r.a.createElement("div",null,r.a.createElement(y.a,{isOpen:this.props.showFilter,className:"filter-modal"},r.a.createElement("div",{className:"container"},r.a.createElement("div",null,"Here is the list of data to filter from selected column."),r.a.createElement("br",null),r.a.createElement("div",{className:"checkbox-list"},t),r.a.createElement("br",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-1 offset-md-9"},r.a.createElement("button",{onClick:function(t){return e.props.applyFilter(t)}},"OK")),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("button",{onClick:function(t){return e.props.cancelFilter(t)}},"Cancel"))))))}}]),t}(n.Component),D=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.handleURLPaste=a.handleURLPaste.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleURLPaste",value:function(e){e.preventDefault();var t=(e.clipboardData||window.clipboardData).getData("text");this.props.handleURLPaste(t)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"row text-center"},r.a.createElement("div",{className:"col-md-6 offset-md-3"},r.a.createElement("input",{placeholder:"e.g., https://en.wikipedia.org/wiki/Canada",onPaste:this.handleURLPaste,className:" form-control"}))))}}]),t}(n.Component),I=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{class:"landing-page"},r.a.createElement("div",{class:" row text-center"},r.a.createElement("div",{class:"white-form col-md-5"},r.a.createElement("h1",{class:""}," Welcome!"),r.a.createElement("hr",{className:"header-hr"}),r.a.createElement("h4",null,"Enter the URL of a Wikipedia page and start wrangling!"),r.a.createElement(D,{handleURLPaste:this.props.handleURLPaste})))))}}]),t}(n.Component),x=a(35),O=a(17),N=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createSuperTable=a.createSuperTable.bind(Object(h.a)(a)),a.createSelectedTableView=a.createSelectedTableView.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"createSuperTable",value:function(){for(var e=this,t=this.props.tableData.length,a=this.props.tableData[0].length,n=[],l=[],o=function(t){var a=void 0;if(t===e.props.keyColIndex){var n=0===t;a=r.a.createElement("th",{className:"table-head"},r.a.createElement("div",{onClick:function(a){return e.props.getKeyOptions(a,t)},className:"super-header-div"},r.a.createElement(x.a,{className:"selection-header",value:e.props.tableHeader[t],onChange:function(a){return e.props.selectColHeader(a,t)},placeholder:"Choose header",options:e.props.optionsMap[e.props.keyColIndex],isMulti:n}),r.a.createElement(g.b,{className:"search-icon",title:"Set as key column",onClick:function(a){return e.props.openFilter(a,t)}})))}else a=r.a.createElement("th",{className:"table-head"},r.a.createElement("div",{onClick:function(a){return e.props.getOtherOptions(a,t)},className:"super-header-div"},r.a.createElement(x.a,{className:"selection-header",value:e.props.tableHeader[t],onChange:function(a){return e.props.selectColHeader(a,t)},placeholder:"Choose header",options:e.props.optionsMap[t],isMulti:!1}),r.a.createElement(g.b,{className:"search-icon",title:"Set as key column",onClick:function(a){return e.props.openFilter(a,t)}})));l.push(a)},s=0;s<a;++s)o(s);n.push(r.a.createElement("thead",{className:"table-head"},r.a.createElement("tr",null,l)));for(var i=[],c=function(t){for(var n=[],l=function(a){var l="cellRow"+t+"Col"+a,o=void 0;o=a===e.props.keyColIndex?t===e.props.keyEntryIndex?{backgroundColor:"Yellow"}:{backgroundColor:"LightBlue"}:{backgroundColor:"White"},n.push(r.a.createElement("td",{style:o},r.a.createElement(O.b,{id:l},r.a.createElement("input",{className:"twenty-vw",type:"text",value:F(e.props.tableData[t][a].data),title:F(e.props.tableData[t][a].data),onChange:function(n){return e.props.onCellChange(n,t,a)}}))))},o=0;o<a;o++)l(o);i.push(r.a.createElement("tr",null,n))},u=0;u<t;u++)c(u);return n.push(r.a.createElement("tbody",null,i)),n}},{key:"createSelectedTableView",value:function(){for(var e=this.props.tableDataExplore.length,t=this.props.tableDataExplore[0].length,a=[],n=[],l=0;l<t;++l){var o=r.a.createElement("th",{className:"table-head table-col"},this.props.tableDataExplore[0][l].data);n.push(o)}var s=r.a.createElement("tr",{className:"table-head table-col"},n);a.push(r.a.createElement("thead",null,s));for(var i=[],c=1;c<e;c++){for(var u=[],p=0;p<t;p++)u.push(r.a.createElement("td",{className:"table-col"},this.props.tableDataExplore[c][p].data));i.push(r.a.createElement("tr",null,u))}return a.push(r.a.createElement("tbody",null,i)),a}},{key:"render",value:function(){for(var e,t=this,a=[],n=function(e){for(var n=function(n){var l="cellRow"+e+"Col"+n;a.push(r.a.createElement(O.a,{id:l},r.a.createElement(O.c,{onClick:function(e){return t.props.contextAddColumn(e,n)}},"Add Column to the Right"),r.a.createElement(O.c,{divider:!0}),r.a.createElement(O.c,{onClick:function(e){return t.props.contextDeleteColumn(e,n)}},"Delete this column"),r.a.createElement(O.c,{divider:!0}),r.a.createElement(O.c,{onClick:function(e){return t.props.contextSortColumn(e,n,"ascending")}},"Sort ascending"),r.a.createElement(O.c,{onClick:function(e){return t.props.contextSortColumn(e,n,"descending")}},"Sort descending"),r.a.createElement(O.c,{divider:!0}),r.a.createElement(O.c,{onClick:function(a){return t.props.contextSetCell(a,e,n)}},"Set as Search Cell"),r.a.createElement(O.c,{divider:!0}),r.a.createElement(O.c,{onClick:function(a){return t.props.contextCellOrigin(a,e,n)}},"Show Origin of Cell"),r.a.createElement(O.c,{onClick:function(a){return t.props.contextCellPreview(a,e,n)}},"Show Preview of Cell"),r.a.createElement(O.c,{onClick:function(a){return t.props.contextOpenLink(a,e,n)}},"Open Wikipage for Cell")))},l=0;l<t.props.tableData[0].length;++l)n(l)},l=0;l<this.props.tableData.length;++l)n(l);return e=r.a.createElement("div",null,r.a.createElement("table",{class:!0,border:"1",className:"table table-sm table-bordered"},this.createSuperTable()),a),r.a.createElement("div",null,e)}}]),t}(n.Component);function F(e){return e.replace(/_\(.*?\)/g,"").replace(/_/g," ")}var j=a(81),w=a(82),T=a(83),L=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createButtonArray=a.createButtonArray.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"createButtonArray",value:function(){for(var e=this,t=this.props.originTableArray,a=[],n=function(n){for(var l="Table "+n+": ",o=t[n].rows[0].cells,s=0;s<o.length;++s){var i=P(o[s].innerText);"\n"===i[i.length-1]&&(i=i.slice(0,-1)),l=l+i+"| "}var c=r.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.props.originTableArray[n].outerHTML}}),u=void 0;!0===e.props.tableOpenList[n]&&(u=r.a.createElement("button",{onClick:function(t){return e.props.handleStartTable(t,n)}},"Select")),a.push(r.a.createElement("li",{className:"list-group-item"},r.a.createElement("span",{onClick:function(t){return e.props.toggleTable(t,n)}},l," ",r.a.createElement(g.d,null)),u,r.a.createElement(j.a,{isOpen:e.props.tableOpenList[n]},r.a.createElement("div",null,c))))},l=0;l<t.length;++l)n(l);return r.a.createElement("ul",{className:"list-group list-css list-group-flush"},a)}},{key:"render",value:function(){var e=null;return 0!==this.props.originTableArray.length&&(e=r.a.createElement("div",null,this.createButtonArray())),r.a.createElement("div",null,e)}}]),t}(n.Component);function P(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}var M=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=function(e){var t=e,a=e.indexOf("(");-1!==a&&(t=t.slice(0,a-1));return t.replace(/_/g," ")}(this.props.urlPasted.slice(30).replace(/%E2%80%93/,"\u2013"));return r.a.createElement("div",null,r.a.createElement("ul",{class:"list-group list-css list-group-flush"},r.a.createElement("hr",{className:"m-0"}),r.a.createElement("li",{className:"list-group-item",onClick:function(t){return e.props.handleStartSubject(t,"startSubject")}},"Start creating a table about ",decodeURIComponent(t)),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("span",{onClick:function(){return e.props.toggleTableSelection()}},"Start with an existing table from page ",r.a.createElement(g.c,null)),r.a.createElement(j.a,{isOpen:this.props.showTableSelection},r.a.createElement(w.a,null,r.a.createElement(T.a,null,r.a.createElement("div",null,r.a.createElement(L,{originTableArray:this.props.originTableArray,tableOpenList:this.props.tableOpenList,toggleTable:this.props.toggleTable,selectedTableIndex:this.props.selectedTableIndex,handleStartTable:this.props.handleStartTable})))))),r.a.createElement("hr",{className:"m-0"})))}}]),t}(n.Component);var _=a(84),R=a(20),H=(a(76),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createPropertyArray=a.createPropertyArray.bind(Object(h.a)(a)),a.createSiblingArray=a.createSiblingArray.bind(Object(h.a)(a)),a.createTableArray=a.createTableArray.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"createTableArray",value:function(e,t){for(var a=this,n=this.props.propertyNeighbours[e].siblingArray[t].tableArray,l=[],o=function(o){for(var s="Table "+o+": ",i=0;i<n[o].title.length;++i)s=s+n[o].title[i]+"|";l.push(r.a.createElement("div",null,r.a.createElement(_.a,{onClick:function(n){return a.props.toggleOtherTable(n,e,t,o)}},s,r.a.createElement(g.d,null)),r.a.createElement(j.a,{isOpen:n[o].isOpen},r.a.createElement(T.a,null,r.a.createElement(w.a,null,r.a.createElement("div",null,r.a.createElement("ul",{className:"list-group list-css"},r.a.createElement("li",{className:"col-md-4 list-group-item list-button list-button-backgound-pink",onClick:function(r){return a.props.unionTable(e,t,n[o].data,n[o].colMapping)}},"Union table")),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:n[o].data.outerHTML}})))))))},s=0;s<n.length;++s)o(s);return l}},{key:"createSiblingArray",value:function(e){for(var t=this,a=this.props.propertyNeighbours[e].siblingArray,n=[],l=!1,o=function(o){var s="Examine tables on page "+a[o].name,i="list-group-item";a[o].isOpen&&(i="list-group-item list-with-background"),!1===l&&0===a[o].tableArray.length&&(l=!0,n.push(r.a.createElement("li",{className:"list-group-item"},r.a.createElement("hr",null),r.a.createElement("h5",null,"Below are sibling pages on which no similar tables are found:"),r.a.createElement("hr",null)))),n.push(r.a.createElement("li",{className:i,title:s},r.a.createElement("span",{onClick:function(a){return t.props.toggleSibling(a,e,o)}},a[o].name+" ",r.a.createElement(g.c,null)),r.a.createElement(j.a,{isOpen:a[o].isOpen},r.a.createElement("div",null,r.a.createElement("ul",{className:"list-group list-css"},r.a.createElement("li",{className:"col-md-4 list-group-item list-button",onClick:function(a){return t.props.unionPage(e,o)}},"Union from page")),t.createTableArray(e,o)))))},s=0;s<a.length;++s)o(s);return r.a.createElement("ul",{className:"list-group list-css list-group-flush"}," ",n," ")}},{key:"createPropertyArray",value:function(){for(var e=this,t=this.props.propertyNeighbours,a=[],n=function(n){var l=t[n].predicate,o=t[n].object,s=l+": "+o+" ",i="Show other pages with "+l+": "+o,c="list-group-item";e.props.propertyNeighbours[n].isOpen&&(c="list-group-item list-with-background"),a.push(r.a.createElement("li",{class:c,title:i},r.a.createElement("span",{onClick:function(t){return e.props.togglePropertyNeighbours(t,n)}},s,r.a.createElement(g.c,null)),r.a.createElement(j.a,{isOpen:e.props.propertyNeighbours[n].isOpen},r.a.createElement("div",null,r.a.createElement("hr",null),r.a.createElement("ul",{className:"list-group list-css"},r.a.createElement("li",{className:"col-md-4 list-group-item list-button list-button-backgound-pink",onClick:function(t){return e.props.unionProperty(n)}},"Union from all pages")),e.createSiblingArray(n)))))},l=0;l<t.length;++l)n(l);return r.a.createElement("ul",{className:"list-group list-css list-group-flush"},a)}},{key:"render",value:function(){var e,t,a,n=this;if(a=""===this.props.usecaseSelected?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-8"},r.a.createElement("h4",{className:"logo-left-color"},"ACTIONS",r.a.createElement("span",null," "),r.a.createElement("span",{className:"logo-right-color xsmall"},"Select your starting action")))):r.a.createElement("div",{className:"row action-header"},r.a.createElement("div",{className:"col-md-8"},r.a.createElement("h4",{className:"logo-left-color"},"ACTIONS",r.a.createElement("span",null," "),r.a.createElement("span",{className:"logo-right-color xsmall"},"Select your next action")))),""===this.props.usecaseSelected)t=r.a.createElement(M,{handleStartSubject:this.props.handleStartSubject,urlPasted:this.props.urlPasted,showTableSelection:this.props.showTableSelection,toggleTableSelection:this.props.toggleTableSelection,originTableArray:this.props.originTableArray,tableOpenList:this.props.tableOpenList,toggleTable:this.props.toggleTable,selectedTableIndex:this.props.selectedTableIndex,handleStartTable:this.props.handleStartTable});else if(null!==this.props.curActionInfo){var l=this.props.curActionInfo;if("afterStartSubject"===l.task)e=r.a.createElement("div",null,r.a.createElement("p",{className:"suggestion-text"},"Fill the ",r.a.createElement("b",null,"first column header")," by choosing from its ",r.a.createElement("b",null,"dropdown menu")),r.a.createElement("br",null),r.a.createElement("p",null,"(If multiple categories are selected from the dropdown menu, ",r.a.createElement("br",null),"the first column will be filled by entities belonging to the ",r.a.createElement("b",null,"intersection")," of all categories.)"));else if("afterPopulateColumn"===l.task)e=r.a.createElement("div",null,"Fill an ",r.a.createElement("b",null,"empty column header")," by choosing from its ",r.a.createElement("b",null,"dropdown menu"));else if("populateKeyColumn"===l.task){for(var o="",s=0;s<l.neighbourArray.length;++s)s>0&&(o+=" & "),o+=l.neighbourArray[s].label;e=""!==o?r.a.createElement("div",null,r.a.createElement("p",null,"Fill this column with:"),r.a.createElement("p",null,r.a.createElement("b",null,o)," ?"),r.a.createElement("button",{onClick:function(e){return n.props.populateKeyColumn(e,l.colIndex,l.neighbourArray)}},"OK")):r.a.createElement("div",null,r.a.createElement("p",{className:"suggestion-text"},"Fill the ",r.a.createElement("b",null,"first column header")," by choosing from its ",r.a.createElement("b",null,"dropdown menu")))}else if("populateOtherColumn"===l.task){var i="subject"===l.type?l.neighbour:"is "+l.neighbour+" of";e=r.a.createElement("div",null,r.a.createElement("p",null,"Fill this column with:"),r.a.createElement("p",null,r.a.createElement("b",null,i)," ?"),r.a.createElement("button",{onClick:function(e){return n.props.populateOtherColumn(e,l.colIndex,l.neighbour,l.neighbourIndex,l.type,l.range)}},"OK"))}else if("populateSameNeighbour"===l.task){var c="subject"===l.type?l.neighbour:"is "+l.neighbour+" of";e=r.a.createElement("div",null,r.a.createElement("p",null,"Add all other properties with name:"),r.a.createElement("p",null,r.a.createElement("b",null,c)," ?"),r.a.createElement("div",{className:"row"},r.a.createElement("button",{className:"col-md-4",onClick:function(e){return n.props.sameNeighbourOneCol(e,l.colIndex,l.neighbour,l.neighbourIndex,l.type,l.numCols)}},"In One Column"),r.a.createElement("button",{className:"offset-md-1 col-md-4",onClick:function(e){return n.props.sameNeighbourDiffCol(e,l.colIndex,l.neighbour,l.neighbourIndex,l.type,l.numCols,l.range)}},"In Separate Columns")))}else if("populateSameRange"===l.task){for(var u="",p="",d=0;d<l.siblingNeighbour.length;++d)d>0&&(u+=", ",p="s"),u+=l.siblingNeighbour[d].value;e=r.a.createElement("div",null,r.a.createElement("p",null,"Add column",p,": ",r.a.createElement("b",null,u)),r.a.createElement("p",null,"that also has type: ",l.range," ?"),r.a.createElement("button",{onClick:function(e){return n.props.populateSameRange(e,l.colIndex,l.range,l.siblingNeighbour)}},"OK"))}else"contextCellOrigin"===l.task?e=r.a.createElement("div",null,r.a.createElement("p",null,"Origin of selected cell is:"),r.a.createElement("div",null,l.origin)):"contextCellPreview"===l.task&&(e=r.a.createElement("div",null,r.a.createElement("p",null,"Preview of ",r.a.createElement("b",null,B(l.cellValue))," is:"),r.a.createElement("div",null,function(e){console.log(e);for(var t=[],a=0;a<e.length;++a){for(var n=e[a].key,l=B(e[a].value[0]),o=1;o<e[a].value.length;++o)l=l+"; "+B(e[a].value[o]);t.push(r.a.createElement("p",null,r.a.createElement("b",null,n),":","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0",l))}return t}(l.preview))))}if("startSubject"===this.props.usecaseSelected){var h=this.props.tabIndex;t=r.a.createElement("div",null,r.a.createElement(R.d,{selectedIndex:h,onSelect:function(e){return n.props.handleTabSwitch(e)}},r.a.createElement(R.b,null,r.a.createElement(R.a,null,"Wrangling Actions")),r.a.createElement(R.c,null,r.a.createElement("div",{className:"wrangling-actions"},e))))}else if("startTable"===this.props.usecaseSelected)if(-1!==this.props.selectedTableIndex){var b=this.props.tabIndex;t=r.a.createElement("div",null,r.a.createElement(R.d,{selectedIndex:b,onSelect:function(e){return n.props.handleTabSwitch(e)}},r.a.createElement(R.b,null,r.a.createElement(R.a,null,"Wrangling Actions"),r.a.createElement(R.a,null,"Union Tables")),r.a.createElement(R.c,null,e),r.a.createElement(R.c,null,r.a.createElement("small",null,"Explore relations below to look for other pages with similar tables:")," ",r.a.createElement("br",null),this.createPropertyArray())))}else t=e;return r.a.createElement("div",null,a,t)}}]),t}(n.Component));function B(e){return e.replace(/_\(.*?\)/g,"").replace(/_/g," ")}var q=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=null,a="small-padding wiki-page-hidden";if(""!==this.props.iframeURL){var n=r.a.createElement("button",{className:"btn btn-sm btn-info toggle-button",onClick:function(){return e.props.toggleWikiPage()}},r.a.createElement("i",{class:"fa fa-chevron-up","aria-hidden":"true"}),"Show");this.props.pageHidden||(a="small-padding wiki-page",n=r.a.createElement("div",null,r.a.createElement("hr",{className:"m-1"}),r.a.createElement("button",{className:"btn btn-sm btn-info toggle-button",onClick:function(){return e.props.toggleWikiPage()}},r.a.createElement("i",{class:"fa fa-chevron-down","aria-hidden":"true"}),"Hide"))),t=r.a.createElement("div",{className:"page-panel text-right"},n,r.a.createElement("div",{className:a},r.a.createElement("iframe",{id:"iframe",title:"URLPage",src:this.props.iframeURL,className:"iframe-cls"})))}return r.a.createElement("div",null,t)}}]),t}(n.Component),U=a(19),X=a.n(U),W=function(e){function t(e){var a;Object(s.a)(this,t),a=Object(c.a)(this,Object(u.a)(t).call(this,e));for(var n=[],r=[],l=[],o=0;o<30;++o){for(var i=[],p=0;p<4;++p)i.push({data:"",origin:[]});n.push(i)}for(var d=0;d<4;++d){l.push([]),r.push("")}return a.state={urlPasted:"",tablePasted:"",usecaseSelected:"",pageHidden:!1,iframeURL:"",curActionInfo:null,lastAction:"",prevState:"",showSetting:!1,showTableSelection:!1,tabIndex:1,keyColIndex:0,keyEntryIndex:0,tableHeader:r,tableData:n,optionsMap:l,keyColNeighbours:[],originTableArray:[],tableOpenList:[],selectedTableIndex:-1,selectedClassAnnotation:[],tableDataExplore:[],propertyNeighbours:[],semanticEnabled:"disabled",unionCutOff:.75,showFilter:!1,curFilterIndex:-1,dataAndChecked:[]},a.handleURLPaste=a.handleURLPaste.bind(Object(h.a)(a)),a.handleTablePaste=a.handleTablePaste.bind(Object(h.a)(a)),a.handleStartSubject=a.handleStartSubject.bind(Object(h.a)(a)),a.handleStartTable=a.handleStartTable.bind(Object(h.a)(a)),a.cellChange=a.cellChange.bind(Object(h.a)(a)),a.selectColHeader=a.selectColHeader.bind(Object(h.a)(a)),a.getKeyOptions=a.getKeyOptions.bind(Object(h.a)(a)),a.getOtherOptions=a.getOtherOptions.bind(Object(h.a)(a)),a.populateKeyColumn=a.populateKeyColumn.bind(Object(h.a)(a)),a.getOtherColPromise=a.getOtherColPromise.bind(Object(h.a)(a)),a.populateOtherColumn=a.populateOtherColumn.bind(Object(h.a)(a)),a.addAllNeighbour=a.addAllNeighbour.bind(Object(h.a)(a)),a.sameNeighbourDiffCol=a.sameNeighbourDiffCol.bind(Object(h.a)(a)),a.sameNeighbourOneCol=a.sameNeighbourOneCol.bind(Object(h.a)(a)),a.populateSameRange=a.populateSameRange.bind(Object(h.a)(a)),a.contextAddColumn=a.contextAddColumn.bind(Object(h.a)(a)),a.contextDeleteColumn=a.contextDeleteColumn.bind(Object(h.a)(a)),a.contextSetCell=a.contextSetCell.bind(Object(h.a)(a)),a.contextCellOrigin=a.contextCellOrigin.bind(Object(h.a)(a)),a.contextCellPreview=a.contextCellPreview.bind(Object(h.a)(a)),a.contextOpenLink=a.contextOpenLink.bind(Object(h.a)(a)),a.contextSortColumn=a.contextSortColumn.bind(Object(h.a)(a)),a.toggleTable=a.toggleTable.bind(Object(h.a)(a)),a.togglePropertyNeighbours=a.togglePropertyNeighbours.bind(Object(h.a)(a)),a.toggleSibling=a.toggleSibling.bind(Object(h.a)(a)),a.toggleOtherTable=a.toggleOtherTable.bind(Object(h.a)(a)),a.unionTable=a.unionTable.bind(Object(h.a)(a)),a.unionPage=a.unionPage.bind(Object(h.a)(a)),a.unionProperty=a.unionProperty.bind(Object(h.a)(a)),a.toggleSemantic=a.toggleSemantic.bind(Object(h.a)(a)),a.unionCutOffChange=a.unionCutOffChange.bind(Object(h.a)(a)),a.copyTable=a.copyTable.bind(Object(h.a)(a)),a.toggleWikiPage=a.toggleWikiPage.bind(Object(h.a)(a)),a.undoPreviousStep=a.undoPreviousStep.bind(Object(h.a)(a)),a.handleTabSwitch=a.handleTabSwitch.bind(Object(h.a)(a)),a.openModal=a.openModal.bind(Object(h.a)(a)),a.closeModal=a.closeModal.bind(Object(h.a)(a)),a.toggleTableSelection=a.toggleTableSelection.bind(Object(h.a)(a)),a.openFilter=a.openFilter.bind(Object(h.a)(a)),a.cancelFilter=a.cancelFilter.bind(Object(h.a)(a)),a.toggleChecked=a.toggleChecked.bind(Object(h.a)(a)),a.applyFilter=a.applyFilter.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleURLPaste",value:function(e){var t=this;if(document.body.classList.add("waiting"),e.includes("https://en.wikipedia.org/wiki/")){var a=[];a.push(Q(e)),G(a).then((function(a){for(var n=a[0],r=(new DOMParser).parseFromString(n,"text/html").getElementsByClassName("wikitable"),l=[],o=0;o<r.length;++o)l.push(!1);document.body.classList.remove("waiting");t.setState({originTableArray:r,tableOpenList:l,urlPasted:e,iframeURL:e,lastAction:"handleURLPaste",prevState:{urlPasted:"",iframeURL:"",originTableArray:[],tableOpenList:[]}})}))}else alert("Please paste a valid Wikipedia link.")}},{key:"handleTablePaste",value:function(e){this.setState({tablePasted:e})}},{key:"copyTable",value:function(){var e=document.createElement("textarea"),t="";if("startSubject"===this.state.usecaseSelected||"startTable"===this.state.usecaseSelected){for(var a=this.state.tableHeader,n=0;n<a.length;++n){var r=a[n].label;if(void 0===r&&a[n].length>0){r="";for(var l=0;l<a[n].length;++l)l>0&&(r+="&"),r+=a[n][l].label}void 0!==r&&""!==r&&(t=t+r+"\t")}t+="\n";for(var o=this.state.tableData,s=o.length,i=o[0].length,c=0;c<s;++c){for(var u=0;u<i;++u){var p=ie(o[c][u].data);void 0!==p&&""!==p&&(t=t+p+"\t")}t+="\n"}}e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),alert("Table content has been pasted!")}},{key:"toggleWikiPage",value:function(){var e=this.state.pageHidden;this.setState({pageHidden:!e})}},{key:"handleStartSubject",value:function(e,t){if("startSubject"===t){var a=decodeURIComponent(this.state.urlPasted.slice(30)),n=X.a.cloneDeep(this.state.tableData);n[0][0].data=a;var r={usecaseSelected:this.state.usecaseSelected,tableData:this.state.tableData,tabIndex:this.state.tabIndex,curActionInfo:this.state.curActionInfo};this.setState({usecaseSelected:t,tableData:n,lastAction:"handleStartSubject",prevState:r,curActionInfo:{task:"afterStartSubject"},tabIndex:0})}}},{key:"cellChange",value:function(e,t,a){e.preventDefault();var n=this.state.tableData.slice();n[t][a].data=e.target.value,this.setState({tableData:n})}},{key:"getKeyOptions",value:function(e,t){var a=this;if(t===this.state.keyColIndex){for(var n=[],r=0;r<this.state.tableData.length&&""!==this.state.tableData[r][t].data;++r)n.push(V(this.state.tableData[r][t].data));for(var l="SELECT+%3Fsomevar%0D%0AWHERE+%7B",o=0;o<n.length;++o)l+="%0D%0A++++++++dbr%3A"+n[o]+"+%28dct%3Asubject%7Crdf%3Atype%29+%3Fsomevar.";var s="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+l+"%0D%0A%7D%0D%0A&format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+",i=[];i.push(K(s)),G(i).then((function(e){for(var t=e[0],n=[],r=0;r<t.results.bindings.length;++r){var l=t.results.bindings[r].somevar.value;if(l.includes("dbpedia.org/resource/Category:")){var o={},s=l.slice(37);o.label=s,o.value=s,o.dataset="dct",n.push(o)}else if(l.includes("dbpedia.org/ontology/")&&!l.includes("Wikidata")){var i={},c=l.slice(28);i.label=c,i.value=c,i.dataset="rdf",n.push(i)}}var u=a.state.optionsMap.slice();u[a.state.keyColIndex]=n,a.setState({optionsMap:u})}))}}},{key:"getOtherOptions",value:function(e,t){var a=this;if(t!==this.state.keyColIndex){for(var n=!0,r=!0,l=[],o=0;o<this.state.tableData.length;++o)""!==this.state.tableData[o][t].data?(n=!1,l.push([o,this.state.tableData[o][t].data])):r=!1;if(!1===n&&!1===r){for(var s="SELECT+%3Fsomevar%0D%0AWHERE+%7B",i=0;i<l.length;++i){s+="%0D%0A++++++++dbr%3A"+V(this.state.tableData[l[i][0]][this.state.keyColIndex].data)+"+%3Fsomevar+dbr%3A"+V(l[i][1])+"."}var c="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+s+"%0D%0A%7D%0D%0A%0D%0A&format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+",u=[];u.push(K(c)),G(u).then((function(e){for(var n=e[0],r=[],l=0;l<n.results.bindings.length;++l){var o={},s=n.results.bindings[l].somevar.value.slice(28);o.label=s,o.value=s,o.type="subject",r.push(o)}var i=a.state.optionsMap.slice();i[t]=r,a.setState({optionsMap:i})}))}else{var p=this.state.optionsMap.slice();p[t]=this.state.keyColNeighbours,this.setState({optionsMap:p})}}}},{key:"selectColHeader",value:function(e,t){var a=this.state.tableHeader.slice();if(t===this.state.keyColIndex){if(null!==e){var n=e.slice();a[t]=n;var r={task:"populateKeyColumn"};r.colIndex=t,r.neighbourArray=[];for(var l=0;l<n.length;++l)r.neighbourArray.push(n[l]);this.setState({tableHeader:a,curActionInfo:r})}}else{var o=e.value,s=e.label;a[t]={value:o,label:s};var i="";if(0===this.state.keyColIndex)for(var c=0;c<a[this.state.keyColIndex].length;++c)c>0&&(i+="&"),i+=a[this.state.keyColIndex][c].label;else i=a[this.state.keyColIndex].label;""===i&&(i=a[this.state.keyColIndex].label),a[t].label=a[t].label+"--"+i;var u={task:"populateOtherColumn"};u.colIndex=t,u.neighbour=e.value,u.type=e.type,s.includes("*")?u.neighbourIndex=0:u.neighbourIndex=-1,"subject"===e.type&&void 0!==e.range&&(u.range=e.range),this.setState({tableHeader:a,curActionInfo:u})}}},{key:"populateKeyColumn",value:function(e,t,a){var n=this;document.body.classList.add("waiting");for(var r=[],l="select+%3Fsomevar%0D%0Awhere+%7B",o=0;o<a.length;++o)"dct"===a[o].dataset?l=l+"%0D%0A+++++++%3Fsomevar+dct%3Asubject+dbc%3A"+V(a[o].value)+".":"rdf"===a[o].dataset&&(l=l+"%0D%0A+++++++%3Fsomevar+rdf%3Atype+dbo%3A"+V(a[o].value)+".");var s=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+l+"%0D%0A%7D+%0D%0A&format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(s);var i=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%3Frange%0D%0AWHERE+%7B%0D%0A+++++++dbr%3A"+V(this.state.tableData[0][t].data)+"+%3Fp+%3Fo.%0D%0A+++++++OPTIONAL+%7B%3Fp+rdfs%3Arange+%3Frange%7D.%0D%0A+++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A+++++++FILTER%28%0D%0A++++++++++++++%21%28regex%28%3FpString%2C%22wikiPage%7Calign%7Cabstract%7Ccaption%7Cimage%7Cwidth%7Cthumbnail%7Cblank%22%2C%22i%22%29%29+%0D%0A++++++++++++++%26%26+regex%28%3FpString%2C+%22ontology%7Cproperty%22%2C+%22i%22%29%0D%0A++++++++++++++%29%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(i);var c=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%0D%0AWHERE+%7B%0D%0A++++++++%3Fs+%3Fp+dbr%3A"+V(this.state.tableData[0][t].data)+".%0D%0A++++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A++++++++FILTER%28%0D%0A+++++++++++++++%21%28regex%28%3FpString%2C%22wikiPage%7Calign%7Cabstract%7Ccaption%7Cimage%7Cwidth%7Cthumbnail%7Cblank%22%2C%22i%22%29%29+%0D%0A+++++++++++++++%26%26+regex%28%3FpString%2C+%22ontology%7Cproperty%22%2C+%22i%22%29%0D%0A+++++++++++++++%29%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(c),G(r).then((function(e){var a=X.a.cloneDeep(n.state.tableData),r=Math.min(e[0].results.bindings.length,30);if(a.length>r)a=a.slice(0,r);else if(a.length<r)for(var l=r-a.length,o=0;o<l;++o){for(var s=[],i=0;i<4;++i)s.push({data:"",origin:[]});a.push(s)}for(var c=a.length,u=c,p=0;p<c&&""!==a[p][t].data;++p)u--;for(var d=c-u,h=0;h<u;++h)a[h+d][t].data=e[0].results.bindings[h].somevar.value.slice(28);for(var b=0;b<c;++b){for(var g="",m=0;m<n.state.tableHeader[t].length;++m)m>0&&(g+="&"),g+=n.state.tableHeader[t][m].value;var f=g+":"+a[b][t].data;a[b][t].origin.push(f)}a=X.a.uniqBy(a,(function(e){return e[0].data}));var v=[];v=Y(v,e[1].results.bindings,"subject"),v=Y(v,e[2].results.bindings,"object");for(var C=n.state.optionsMap.slice(),y=0;y<C.length;++y)y!==t&&(C[y]=v);document.body.classList.remove("waiting");var A={keyColIndex:n.state.keyColIndex,keyColNeighbours:n.state.keyColNeighbours,curActionInfo:n.state.curActionInfo,tableData:n.state.tableData,optionsMap:n.state.optionsMap};n.setState({keyColIndex:t,keyColNeighbours:v,curActionInfo:{task:"afterPopulateColumn"},tableData:a,optionsMap:C,lastAction:"populateKeyColumn",prevState:A})}))}},{key:"getOtherColPromise",value:function(e,t){for(var a=[],n=0;n<this.state.tableData.length;++n){var r=V(this.state.tableData[n][this.state.keyColIndex].data);"N/A"===r&&(r="NONEXISTINGSTRING");var l=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("subject"===t?"SELECT+%3Fsomevar%0D%0AWHERE+%7B%0D%0A++++++++dbr%3A"+r+"+%28dbo%3A"+V(e)+"%7Cdbp%3A"+V(e)+"%29+%3Fsomevar.%0D%0A%7D%0D%0A%0D%0A&":"SELECT+%3Fsomevar+%0D%0AWHERE+%7B%0D%0A++++++++%3Fsomevar+%28dbo%3A"+V(e)+"%7Cdbp%3A"+V(e)+"%29+dbr%3A"+r+"%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");a.push(l)}return a}},{key:"populateOtherColumn",value:function(e,t,a,n,r,l){var o=this;document.body.classList.add("waiting"),G(this.getOtherColPromise(a,r)).then((function(e){for(var s=X.a.cloneDeep(o.state.tableData),i=-1===n?1:n+1,c=0;c<e.length;++c)if(e[c].results.bindings.length<i)""===s[c][o.state.keyColIndex].data?s[c][t].data="":s[c][t].data="N/A";else{var u=e[c].results.bindings[i-1].somevar.value;u=$(u),s[c][t].data=u;var p=void 0;p="subject"===r?a+":"+u:"is "+a+" of:"+u;var d=s[c][o.state.keyColIndex].origin.slice();d.push(p),s[c][t].origin=d}var h=Math.min(e[o.state.keyEntryIndex].results.bindings.length,50)-n-1,b={};if(-1!==n&&h>0)b.task="populateSameNeighbour",b.colIndex=t,b.neighbour=a,b.neighbourIndex=n,b.type=r,b.numCols=h,void 0!==l&&(b.range=l);else if(void 0!==l){for(var g=[],m=0;m<o.state.keyColNeighbours.length;++m)o.state.keyColNeighbours[m].range===l&&o.state.keyColNeighbours[m].value!==a&&g.push(o.state.keyColNeighbours[m]);if(g.length>0){var f="";f=l.includes("http://dbpedia.org/ontology/")?l.slice(28):l.includes("http://www.w3.org/2001/XMLSchema#")?l.slice(33):l,b.task="populateSameRange",b.colIndex=t,b.range=f,b.siblingNeighbour=g}else b.task="afterPopulateColumn"}else b.task="afterPopulateColumn";document.body.classList.remove("waiting");var v={curActionInfo:o.state.curActionInfo,tableData:o.state.tableData};o.setState({curActionInfo:b,tableData:s,lastAction:"populateOtherColumn",prevState:v})}))}},{key:"addAllNeighbour",value:function(e,t,a,n,r,l,o,s,i,c,u){var p=s.length,d=s[0].length,h=u;e<u&&(h+=r);for(var b=[],g=0;g<p;++g){for(var m=[],f=0;f<e+1;++f)m.push(s[g][f]);for(var v=0;v<r;++v)m.push({data:"",origin:[]});for(var C=e+1;C<d;++C)m.push(s[g][C]);b.push(m)}for(var y=[],A=0;A<e+1;++A)y.push(o[A]);var E="";if(0===u)for(var S=0;S<o[0].length;++S)S>0&&(E+="&"),E+=o[0][S].value;else E=o[u].label;for(var k=0;k<r;++k){var D="";D="subject"===n?D+t+"-"+(a+2+k)+"--"+E:D+"is "+t+" of-"+(a+2+k)+"--"+E,y.push({value:t,label:D})}for(var I=e+1;I<d;++I)y.push(o[I]);for(var x=[],O=0;O<e;++O)x.push(c[O]);for(var N=0;N<r;++N)x.push([]);for(var F=e;F<d-1;++F)x.push(c[F]);for(var j=[],w=0;w<e+1;++w)j.push(i[w]);for(var T=0;T<r;++T)j.push([]);for(var L=e+1;L<d;++L)j.push(i[L]);for(var P=e+1;P<e+1+r;++P)for(var M=a+P-e+1,_=0;_<l.length;++_)if(l[_].results.bindings.length<M)b[_][P].data="N/A";else{var R=l[_].results.bindings[M-1].somevar.value;R=$(R),b[_][P].data=R;var H=void 0;H="subject"===n?t+":"+R:"is "+t+" of:"+R;var B=b[_][h].origin.slice();B.push(H),b[_][P].origin=B}return{tableHeader:y,tableData:b,optionsMap:j,selectedClassAnnotation:x,keyColIndex:h}}},{key:"sameNeighbourDiffCol",value:function(e,t,a,n,r,l,o){var s=this;G(this.getOtherColPromise(a,r)).then((function(e){for(var i=s.addAllNeighbour(t,a,n,r,l,e,s.state.tableHeader,s.state.tableData,s.state.optionsMap,s.state.selectedClassAnnotation,s.state.keyColIndex),c={},u=[],p=0;p<s.state.keyColNeighbours.length;++p)void 0!==o&&s.state.keyColNeighbours[p].range===o&&s.state.keyColNeighbours[p].value!==a&&u.push(s.state.keyColNeighbours[p]);if(u.length>0){var d="";d=o.includes("http://dbpedia.org/ontology/")?o.slice(28):o.includes("http://www.w3.org/2001/XMLSchema#")?o.slice(33):o,c.task="populateSameRange",c.colIndex=t+l,c.range=d,console.log(u),c.siblingNeighbour=u}else c.task="afterPopulateColumn";var h={curActionInfo:s.state.curActionInfo,tableData:s.state.tableData,tableHeader:s.state.tableHeader,optionsMap:s.state.optionsMap,selectedClassAnnotation:s.state.selectedClassAnnotation,keyColIndex:s.state.keyColIndex};s.setState({curActionInfo:c,tableData:i.tableData,tableHeader:i.tableHeader,optionsMap:i.optionsMap,selectedClassAnnotation:i.selectedClassAnnotation,keyColIndex:i.keyColIndex,lastAction:"sameNeighbourDiffCol",prevState:h})}))}},{key:"sameNeighbourOneCol",value:function(e,t,a,n,r,l){var o=this,s=X.a.cloneDeep(this.state.tableData);G(this.getOtherColPromise(a,r)).then((function(e){for(var a=n+2;a<n+l+2;++a)for(var r=0;r<e.length;++r)if(e[r].results.bindings.length>=a){var i=e[r].results.bindings[a-1].somevar.value;i=$(i),s[r][t].data=s[r][t].data+";"+i;var c=s[r][t].origin.slice();c[c.length-1]=c[c.length-1]+";"+i,s[r][t].origin=c}var u={curActionInfo:o.state.curActionInfo,tableData:o.state.tableData};o.setState({curActionInfo:{task:"afterPopulateColumn"},tableData:s,lastAction:"sameNeighbourOneCol",prevState:u})}))}},{key:"populateSameRange",value:function(e,t,a,n){var r=this;document.body.classList.add("waiting");for(var l=[],o=0;o<n.length;++o)for(var s=this.getOtherColPromise(n[o].value,"subject"),i=0;i<s.length;++i)l.push(s[i]);G(l).then((function(e){for(var a=r.state.tableHeader,l=r.state.tableData,o=r.state.optionsMap,s=r.state.selectedClassAnnotation,i=r.state.keyColIndex,c=t,u=0;u<n.length;++u){for(var p=[],d=0;d<l.length;++d)p.push(e[l.length*u+d]);var h=r.addAllNeighbour(c,n[u].value,-1,"subject",n[u].count,p,a,l,o,s,i);c+=n[u].count,a=h.tableHeader,l=h.tableData,o=h.optionsMap,s=h.selectedClassAnnotation,i=h.keyColIndex}document.body.classList.remove("waiting");var b={curActionInfo:r.state.curActionInfo,tableData:r.state.tableData,tableHeader:r.state.tableHeader,optionsMap:r.state.optionsMap,selectedClassAnnotation:r.state.selectedClassAnnotation,keyColIndex:r.state.keyColIndex};r.setState({curActionInfo:{task:"afterPopulateColumn"},tableData:l,tableHeader:a,optionsMap:o,selectedClassAnnotation:s,keyColIndex:i,lastAction:"populateSameRange",prevState:b})}))}},{key:"contextAddColumn",value:function(e,t){for(var a=this.state.tableData.length,n=this.state.tableData[0].length,r=[],l=0;l<a;++l){for(var o=[],s=0;s<t+1;++s)o.push(this.state.tableData[l][s]);o.push({data:"",origin:[]});for(var i=t+1;i<n;++i)o.push(this.state.tableData[l][i]);r.push(o)}for(var c=[],u=[],p=0;p<t+1;++p)c.push(this.state.optionsMap[p]),u.push(this.state.tableHeader[p]);c.push(this.state.keyColNeighbours),u.push("");for(var d=t+1;d<n;++d)c.push(this.state.optionsMap[d]),u.push(this.state.tableHeader[d]);for(var h=[],b=0;b<t;++b)h.push(this.state.selectedClassAnnotation[b]);h.push([]);for(var g=t;g<n-1;++g)h.push(this.state.selectedClassAnnotation[g]);var m=this.state.keyColIndex;t<m&&++m;var f={tableData:this.state.tableData,tableHeader:this.state.tableHeader,curActionInfo:this.state.curActionInfo,optionsMap:this.state.optionsMap,keyColIndex:this.state.keyColIndex,selectedClassAnnotation:this.state.selectedClassAnnotation,tabIndex:this.state.tabIndex};this.setState({tableData:r,tableHeader:u,curActionInfo:{task:"afterPopulateColumn"},optionsMap:c,keyColIndex:m,selectedClassAnnotation:h,tabIndex:0,lastAction:"contextAddColumn",prevState:f})}},{key:"contextDeleteColumn",value:function(e,t){if(t===this.state.keyColIndex)alert("The current column is the search column.\n\nPlease set another search column before deleting the current column.");else if(0===t)alert("Deleting the first column causes unexpected behavior.\n\nPlease do not delete the first column.");else{for(var a=X.a.cloneDeep(this.state.tableData),n=this.state.tableHeader.slice(),r=this.state.optionsMap.slice(),l=this.state.selectedClassAnnotation.slice(),o=0;o<a.length;++o)a[o].splice(t,1);n.splice(t,1),r.splice(t,1),t>0&&l.splice(t-1,1);var s=this.state.keyColIndex;t<s&&--s;var i=X.a.cloneDeep(this.state.propertyNeighbours);if(1===this.state.tabIndex)for(var c=0;c<i.length;++c)i[c].isOpen=!1;var u={tableData:this.state.tableData,tableHeader:this.state.tableHeader,optionsMap:this.state.optionsMap,selectedClassAnnotation:this.state.selectedClassAnnotation,keyColIndex:this.state.keyColIndex,propertyNeighbours:this.state.propertyNeighbours,curActionInfo:this.state.curActionInfo};this.setState({tableData:a,tableHeader:n,optionsMap:r,selectedClassAnnotation:l,keyColIndex:s,propertyNeighbours:i,curActionInfo:{task:"afterPopulateColumn"},lastAction:"contextDeleteColumn",prevState:u})}}},{key:"contextSortColumn",value:function(e,t,a){for(var n=X.a.cloneDeep(this.state.tableData),r=!0,l=0;l<n.length;++l)if("N/A"!==n[l][t].data&&isNaN(Number(n[l][t].data))){r=!1;break}var o,s=n[this.state.keyEntryIndex].slice();r?n.sort((function(e,n){var r=e[t].data,l=n[t].data;return"N/A"===r?1:"N/A"===l?-1:"ascending"===a?Number(r)-Number(l):Number(l)-Number(r)})):n.sort((function(e,n){var r=e[t].data,l=n[t].data;return"N/A"===r?1:"N/A"===l?-1:"ascending"===a?r<l?-1:1:r<l?1:-1}));for(var i=0;i<n.length;++i){for(var c=!0,u=0;u<s.length;++u)if(s[u].data!==n[i][u].data){c=!1;break}if(!0===c){o=i;break}}var p={tableData:this.state.tableData,keyEntryIndex:this.state.keyEntryIndex,curActionInfo:this.state.curActionInfo};this.setState({tableData:n,keyEntryIndex:o,curActionInfo:{task:"afterPopulateColumn"},lastAction:"contextSortColumn",prevState:p})}},{key:"contextSetCell",value:function(e,t,a){var n=this;if(document.body.classList.add("waiting"),"N/A"===this.state.tableData[t][a].data)alert("N/A should not be set as search cell.");else{var r=[],l=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%3Frange%0D%0AWHERE+%7B%0D%0A+++++++dbr%3A"+V(this.state.tableData[t][a].data)+"+%3Fp+%3Fo.%0D%0A+++++++OPTIONAL+%7B%3Fp+rdfs%3Arange+%3Frange%7D.%0D%0A+++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A+++++++FILTER%28%0D%0A++++++++++++++%21%28regex%28%3FpString%2C%22wikiPage%7Calign%7Cabstract%7Ccaption%7Cimage%7Cwidth%7Cthumbnail%7Cblank%22%2C%22i%22%29%29+%0D%0A++++++++++++++%26%26+regex%28%3FpString%2C+%22ontology%7Cproperty%22%2C+%22i%22%29%0D%0A++++++++++++++%29%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(l);var o=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%0D%0AWHERE+%7B%0D%0A++++++++%3Fs+%3Fp+dbr%3A"+V(this.state.tableData[t][a].data)+".%0D%0A++++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A++++++++FILTER%28%0D%0A+++++++++++++++%21%28regex%28%3FpString%2C%22wikiPage%7Calign%7Cabstract%7Ccaption%7Cimage%7Cwidth%7Cthumbnail%7Cblank%22%2C%22i%22%29%29+%0D%0A+++++++++++++++%26%26+regex%28%3FpString%2C+%22ontology%7Cproperty%22%2C+%22i%22%29%0D%0A+++++++++++++++%29%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(o),G(r).then((function(e){console.log(e[0]),console.log(e[1]);var r=[];r=Y(r,e[0].results.bindings,"subject"),r=Y(r,e[1].results.bindings,"object");for(var l=n.state.optionsMap.slice(),o=0;o<l.length;++o)o!==a&&(l[o]=r);document.body.classList.remove("waiting");var s={keyEntryIndex:n.state.keyEntryIndex,keyColIndex:n.state.keyColIndex,keyColNeighbours:n.state.keyColNeighbours,curActionInfo:n.state.curActionInfo,optionsMap:n.state.optionsMap,tabIndex:n.state.tabIndex};n.setState({keyEntryIndex:t,keyColIndex:a,keyColNeighbours:r,curActionInfo:{task:"afterPopulateColumn"},optionsMap:l,tabIndex:0,lastAction:"contextSetCell",prevState:s})}))}}},{key:"contextCellOrigin",value:function(e,t,a){for(var n=this.state.tableData[t][a],l=[],o=0;o<n.origin.length;++o)l.push(r.a.createElement("p",null,n.origin[o]));var s={task:"contextCellOrigin"};s.origin=l;var i={curActionInfo:this.state.curActionInfo,tabIndex:this.state.tabIndex};this.setState({curActionInfo:s,tabIndex:0,lastAction:"contextCellOrigin",prevState:i})}},{key:"contextCellPreview",value:function(e,t,a){var n=this;document.body.classList.add("waiting");var r=[],l=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%3Fvalue%0D%0AWHERE+%7B%0D%0A+++++++dbr%3A"+V(this.state.tableData[t][a].data)+"+%3Fp+%3Fvalue.%0D%0A+++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A+++++++FILTER%28%0D%0A++++++++++++++%21%28regex%28%3FpString%2C%22wikiPage%7Calign%7Cabstract%7Ccaption%7Cimage%7Cwidth%7Cthumbnail%7Cblank%22%2C%22i%22%29%29%0D%0A++++++++++++++%26%26+regex%28%3FpString%2C+%22ontology%7Cproperty%22%2C+%22i%22%29%0D%0A+++++++%29%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(l);var o=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%3Fvalue%0D%0AWHERE+%7B%0D%0A+++++++%3Fvalue+%3Fp+dbr%3A"+V(this.state.tableData[t][a].data)+".%0D%0A+++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A+++++++FILTER%28%0D%0A++++++++++++++%21%28regex%28%3FpString%2C%22wikiPage%7Calign%7Cabstract%7Ccaption%7Cimage%7Cwidth%7Cthumbnail%7Cblank%22%2C%22i%22%29%29%0D%0A++++++++++++++%26%26+regex%28%3FpString%2C+%22ontology%7Cproperty%22%2C+%22i%22%29%0D%0A+++++++%29%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(o),G(r).then((function(e){var r=z(e[0].results.bindings,"subject"),l=z(e[1].results.bindings,"object"),o=r.concat(l),s={task:"contextCellPreview"};s.cellValue=n.state.tableData[t][a].data,s.preview=o,document.body.classList.remove("waiting");var i={curActionInfo:n.state.curActionInfo,tabIndex:n.state.tabIndex};n.setState({curActionInfo:s,tabIndex:0,lastAction:"contextCellPreview",prevState:i})}))}},{key:"contextOpenLink",value:function(e,t,a){var n="https://en.wikipedia.org/wiki/"+this.state.tableData[t][a].data;this.setState({pageHidden:!1,iframeURL:n})}},{key:"toggleTable",value:function(e,t){var a=this.state.tableOpenList.slice();a[t]=!a[t];for(var n=0;n<a.length;++n)n!==t&&(a[n]=!1);!0===a[t]?this.setState({tableOpenList:a,curActionInfo:{task:"selectTableIndex",tableIndex:t}}):this.setState({tableOpenList:a,curActionInfo:null})}},{key:"handleStartTable",value:function(e,t){var a=this;document.body.classList.add("waiting");var n=[],r=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%3Fo%0D%0AWHERE+%7B%0D%0A++++++dbr%3A"+J(this.state.urlPasted.slice(30))+"+%3Fp+%3Fo.%0D%0A++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A++++++FILTER%28isIRI%28%3Fo%29+%26%26+regex%28%3FpString%2C%22property%22%2C%22i%22%29+%26%26+%28%21regex%28%3FpString%2C%22text%22%2C%22i%22%29%29%29.%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");n.push(r);var l=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fo%0D%0AWHERE+%7B%0D%0A++++++dbr%3A"+J(this.state.urlPasted.slice(30))+"+dct%3Asubject+%3Fo%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");n.push(l),n.push(ne(this.state.originTableArray[t])),G(n).then((function(e){var n=e[2],r=[],l=[],o=[];o=e[0].results.bindings;for(var s=0;s<o.length;++s){var i=o[s].p.value.slice(28),c=o[s].o.value.slice(28);c.includes("/")&&(c="NONEXISTING");var u=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fs+%0D%0AWHERE+%7B%0D%0A%09%3Fs+dbp%3A"+V(i)+"+dbr%3A"+V(c)+"%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push({predicate:i,object:c}),l.push(u)}o=e[1].results.bindings;for(var p=0;p<o.length;++p){var d=o[p].o.value.slice(37),h=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fs%0D%0AWHERE+%7B%0D%0A++++++%3Fs+dct%3Asubject+dbc%3A"+V(d)+"%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push({predicate:"subject",object:d}),l.push(h)}G(l).then((function(e){for(var l=[],o=decodeURIComponent(a.state.urlPasted.slice(30)),s=0;s<e.length;++s){var i=e[s].results.bindings;if(i.length>1&&i.length<150){for(var c=[],u=0;u<i.length;++u){var p=i[u].s.value.slice(28);c.push({isOpen:!1,name:p,tableArray:[]})}l.push({predicate:r[s].predicate,object:r[s].object,isOpen:!1,siblingArray:c})}}l.sort((function(e,t){return e.siblingArray.length<t.siblingArray.length?1:-1}));var d={task:"showPropertyNeighbours"};G([se(re(a.state.originTableArray[t],o),n)]).then((function(e){var r=e[0];document.body.classList.remove("waiting");var o={selectedTableIndex:a.state.selectedTableIndex,propertyNeighbours:a.state.propertyNeighbours,curActionInfo:a.state.curActionInfo,selectedClassAnnotation:a.state.selectedClassAnnotation,keyColIndex:a.state.keyColIndex,keyColNeighbours:a.state.keyColNeighbours,tableData:a.state.tableData,tableHeader:a.state.tableHeader,optionsMap:a.state.optionsMap,usecaseSelected:a.state.usecaseSelected,tabIndex:a.state.tabIndex};a.setState({selectedTableIndex:t,propertyNeighbours:l,curActionInfo:d,selectedClassAnnotation:n,keyColIndex:r.keyColIndex,keyColNeighbours:r.keyColNeighbours,tableData:r.tableData,tableHeader:r.tableHeader,optionsMap:r.optionsMap,usecaseSelected:"startTable",tabIndex:1,lastAction:"handleStartTable",prevState:o})}))}))}))}},{key:"togglePropertyNeighbours",value:function(e,t){var a=this;document.body.classList.add("waiting");var n=this.state.propertyNeighbours.slice();if(n[t].isOpen=!n[t].isOpen,!0===n[t].isOpen){for(var r=n[t].siblingArray,l=[],o=[],s=[],i=0;i<r.length;++i){var c=r[i].name,u=Q("https://en.wikipedia.org/wiki/"+c);s.push(u),o.push(c)}G(s).then((function(e){for(var r=[],s=0;s<e.length;++s){var i=e[s];r.push(te(a.state.tableHeader,i,a.state.selectedClassAnnotation,a.state.semanticEnabled,a.state.unionCutOff,o[s]))}G(r).then((function(e){for(var r=0;r<e.length;++r)l.push({isOpen:!1,name:o[r],tableArray:e[r]});l.sort((function(e,t){var a=e.tableArray.length,n=t.tableArray.length,r=e.name,l=t.name;return a===n?r<l?-1:r>l?1:0:a>n?-1:1})),n[t].siblingArray=l,document.body.classList.remove("waiting"),a.setState({propertyNeighbours:n})}))}))}else document.body.classList.remove("waiting"),this.setState({propertyNeighbours:n})}},{key:"toggleSibling",value:function(e,t,a){var n=this.state.propertyNeighbours.slice(),r=n[t].siblingArray[a];if(0===r.tableArray.length){var l="https://en.wikipedia.org/wiki/"+r.name;this.setState({pageHidden:!1,iframeURL:l})}else if(r.isOpen=!r.isOpen,!0===r.isOpen){var o="https://en.wikipedia.org/wiki/"+r.name;n[t].isOpen=!0,this.setState({propertyNeighbours:n,iframeURL:o})}else this.setState({propertyNeighbours:n})}},{key:"toggleOtherTable",value:function(e,t,a,n){var r=this.state.propertyNeighbours.slice(),l=r[t].siblingArray[a].tableArray[n];l.isOpen=!l.isOpen,this.setState({propertyNeighbours:r})}},{key:"unionTable",value:function(e,t,a,n){var r=X.a.cloneDeep(this.state.tableData),l=re(a,this.state.propertyNeighbours[e].siblingArray[t].name);r=Z(r,l=le(l),n.slice());var o={tableData:this.state.tableData};this.setState({tableData:r,lastAction:"unionTable",prevState:o})}},{key:"unionPage",value:function(e,t){for(var a=X.a.cloneDeep(this.state.tableData),n=this.state.propertyNeighbours[e].siblingArray[t].tableArray,r=this.state.propertyNeighbours[e].siblingArray[t].name,l=0;l<n.length;++l){var o=re(n[l].data,r),s=o[0];o=le(o);var i=!1;if(r===decodeURIComponent(this.state.urlPasted.slice(30))&&s.length===a[0].length){for(var c=!1,u=0;u<s.length;++u)if(s[u].data!==this.state.tableHeader[u].value){c=!0;break}!1===c&&(i=!0)}var p=n[l].colMapping.slice();!1===i&&(a=Z(a,o,p))}var d={tableData:this.state.tableData};this.setState({tableData:a,lastAction:"unionPage",prevState:d})}},{key:"unionProperty",value:function(e){for(var t=X.a.cloneDeep(this.state.tableData),a=this.state.propertyNeighbours[e].siblingArray,n=0;n<a.length;++n){var r=a[n].tableArray,l=a[n].name;if(0===r.length)break;for(var o=0;o<r.length;++o){var s=re(r[o].data,l),i=s[0];s=le(s);var c=!1;if(l===decodeURIComponent(this.state.urlPasted.slice(30))&&i.length===t[0].length){for(var u=!1,p=0;p<i.length;++p)if(i[p].data!==this.state.tableHeader[p].value){u=!0;break}!1===u&&(c=!0)}var d=r[o].colMapping.slice();!1===c&&(t=Z(t,s,d))}}var h={tableData:this.state.tableData};this.setState({tableData:t,lastAction:"unionProperty",prevState:h})}},{key:"toggleSemantic",value:function(e){for(var t=this.state.propertyNeighbours.slice(),a=0;a<t.length;++a)t[a].isOpen=!1;this.setState({semanticEnabled:e.target.value,propertyNeighbours:t})}},{key:"unionCutOffChange",value:function(e){for(var t=this.state.propertyNeighbours.slice(),a=0;a<t.length;++a)t[a].isOpen=!1;this.setState({unionCutOff:e.target.value,propertyNeighbours:t})}},{key:"openFilter",value:function(e,t){for(var a=[],n=0;n<this.state.tableData.length;++n)a.push(this.state.tableData[n][t].data);(a=Object(d.a)(new Set(a))).sort((function(e,t){return"N/A"===e?-1:"N/A"===t?1:0}));for(var r=[],l=0;l<a.length;++l)r.push({data:a[l],checked:!0});this.setState({dataAndChecked:r,showFilter:!0,curFilterIndex:t})}},{key:"cancelFilter",value:function(e){this.setState({dataAndChecked:[],showFilter:!1,curFilterIndex:-1})}},{key:"toggleChecked",value:function(e,t){var a=this.state.dataAndChecked;a[t].checked=!a[t].checked,this.setState({dataAndChecked:a})}},{key:"applyFilter",value:function(e){for(var t=[],a=0;a<this.state.dataAndChecked.length;++a)!0===this.state.dataAndChecked[a].checked&&t.push(this.state.dataAndChecked[a].data);for(var n=X.a.cloneDeep(this.state.tableData),r=0;r<n.length;++r)t.includes(n[r][this.state.curFilterIndex].data)||(n.splice(r,1),--r);var l={tableData:this.state.tableData,curActionInfo:this.state.curActionInfo};this.setState({dataAndChecked:[],showFilter:!1,curFilterIndex:-1,tableData:n,lastAction:"applyFilter",prevState:l})}},{key:"handleTabSwitch",value:function(e){if(1===e){for(var t=this.state.propertyNeighbours.slice(),a=0;a<t.length;++a)t[a].isOpen=!1;this.setState({propertyNeighbours:t,tabIndex:e})}else this.setState({tabIndex:e})}},{key:"undoPreviousStep",value:function(){var e=this.state.lastAction,t=this.state.prevState;"handleURLPaste"===e?this.setState({urlPasted:t.urlPasted,iframeURL:t.iframeURL,originTableArray:t.originTableArray,tableOpenList:t.tableOpenList}):"handleStartSubject"===e?this.setState({usecaseSelected:t.usecaseSelected,tableData:t.tableData,tabIndex:t.tabIndex,curActionInfo:t.curActionInfo,lastAction:""}):"handleStartTable"===e?this.setState({selectedTableIndex:t.selectedTableIndex,propertyNeighbours:t.propertyNeighbours,curActionInfo:t.curActionInfo,selectedClassAnnotation:t.selectedClassAnnotation,keyColIndex:t.keyColIndex,keyColNeighbours:t.keyColNeighbours,tableData:t.tableData,tableHeader:t.tableHeader,optionsMap:t.optionsMap,usecaseSelected:t.usecaseSelected,tabIndex:t.tabIndex,lastAction:""}):"populateKeyColumn"===e?this.setState({keyColIndex:t.keyColIndex,keyColNeighbours:t.keyColNeighbours,curActionInfo:t.curActionInfo,tableData:t.tableData,optionsMap:t.optionsMap,lastAction:""}):"populateOtherColumn"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,lastAction:""}):"sameNeighbourDiffCol"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,tableHeader:t.tableHeader,optionsMap:t.optionsMap,selectedClassAnnotation:t.selectedClassAnnotation,keyColIndex:t.keyColIndex,lastAction:""}):"sameNeighbourOneCol"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,lastAction:""}):"populateSameRange"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,tableHeader:t.tableHeader,optionsMap:t.optionsMap,selectedClassAnnotation:t.selectedClassAnnotation,keyColIndex:t.keyColIndex,lastAction:""}):"unionTable"===e||"unionPage"===e||"unionProperty"===e?this.setState({tableData:t.tableData,lastAction:""}):"contextAddColumn"===e?this.setState({tableData:t.tableData,tableHeader:t.tableHeader,curActionInfo:t.curActionInfo,optionsMap:t.optionsMap,keyColIndex:t.keyColIndex,selectedClassAnnotation:t.selectedClassAnnotation,tabIndex:t.tabIndex,lastAction:""}):"contextSetCell"===e?this.setState({keyEntryIndex:t.keyEntryIndex,keyColIndex:t.keyColIndex,keyColNeighbours:t.keyColNeighbours,curActionInfo:t.curActionInfo,optionsMap:t.optionsMap,tabIndex:t.tabIndex,lastAction:""}):"contextCellOrigin"===e?this.setState({curActionInfo:t.curActionInfo,tabIndex:t.tabIndex,lastAction:""}):"contextCellPreview"===e?this.setState({curActionInfo:t.curActionInfo,tabIndex:t.tabIndex,lastAction:""}):"contextDeleteColumn"===e?this.setState({tableData:t.tableData,tableHeader:t.tableHeader,optionsMap:t.optionsMap,selectedClassAnnotation:t.selectedClassAnnotation,keyColIndex:t.keyColIndex,propertyNeighbours:t.propertyNeighbours,curActionInfo:t.curActionInfo,lastAction:""}):"contextSortColumn"===e?this.setState({tableData:t.tableData,keyEntryIndex:t.keyEntryIndex,curActionInfo:t.curActionInfo,lastAction:""}):"applyFilter"===e&&this.setState({tableData:t.tableData,curActionInfo:t.curActionInfo,lastAction:""})}},{key:"openModal",value:function(){this.setState({showSetting:!0})}},{key:"closeModal",value:function(){this.setState({showSetting:!1})}},{key:"toggleTableSelection",value:function(){var e=!this.state.showTableSelection;this.setState({showTableSelection:e})}},{key:"render",value:function(){var e,t=" bottom-content",a="row top-content";return this.state.pageHidden&&(t=" bottom-content-hidden",a="row top-content-large"),e=""===this.state.urlPasted?r.a.createElement(I,{handleURLPaste:this.handleURLPaste}):r.a.createElement("div",null,r.a.createElement("div",{className:"header"},r.a.createElement(f,{copyTable:this.copyTable,undoPreviousStep:this.undoPreviousStep,openModal:this.openModal})),r.a.createElement("div",{className:"mainbody"},r.a.createElement("div",{className:""},r.a.createElement("div",{className:a},r.a.createElement("div",{className:"col-md-7 small-padding  table-panel"},r.a.createElement(N,{urlPasted:this.state.urlPasted,usecaseSelected:this.state.usecaseSelected,tableHeader:this.state.tableHeader,tableData:this.state.tableData,keyColIndex:this.state.keyColIndex,keyEntryIndex:this.state.keyEntryIndex,onCellChange:this.cellChange,selectColHeader:this.selectColHeader,getKeyOptions:this.getKeyOptions,getOtherOptions:this.getOtherOptions,optionsMap:this.state.optionsMap,contextAddColumn:this.contextAddColumn,contextDeleteColumn:this.contextDeleteColumn,contextSetCell:this.contextSetCell,contextCellOrigin:this.contextCellOrigin,contextCellPreview:this.contextCellPreview,contextOpenLink:this.contextOpenLink,contextSortColumn:this.contextSortColumn,openFilter:this.openFilter})),r.a.createElement("div",{className:"col-md-5 small-padding action-panel"},r.a.createElement(H,{urlPasted:this.state.urlPasted,usecaseSelected:this.state.usecaseSelected,curActionInfo:this.state.curActionInfo,handleStartSubject:this.handleStartSubject,populateKeyColumn:this.populateKeyColumn,populateOtherColumn:this.populateOtherColumn,sameNeighbourDiffCol:this.sameNeighbourDiffCol,sameNeighbourOneCol:this.sameNeighbourOneCol,populateSameRange:this.populateSameRange,handleStartTable:this.handleStartTable,propertyNeighbours:this.state.propertyNeighbours,togglePropertyNeighbours:this.togglePropertyNeighbours,toggleSibling:this.toggleSibling,toggleOtherTable:this.toggleOtherTable,unionTable:this.unionTable,unionPage:this.unionPage,unionProperty:this.unionProperty,tabIndex:this.state.tabIndex,handleTabSwitch:this.handleTabSwitch,showTableSelection:this.state.showTableSelection,toggleTableSelection:this.toggleTableSelection,originTableArray:this.state.originTableArray,tableOpenList:this.state.tableOpenList,toggleTable:this.toggleTable,selectedTableIndex:this.state.selectedTableIndex}))),r.a.createElement("div",{className:t},r.a.createElement("div",null,r.a.createElement(q,{pageHidden:this.state.pageHidden,iframeURL:this.state.iframeURL,toggleWikiPage:this.toggleWikiPage}))),r.a.createElement("div",null,r.a.createElement(S,{showSetting:this.state.showSetting,closeModal:this.closeModal,semanticEnabled:this.state.semanticEnabled,toggleSemantic:this.toggleSemantic,unionCutOff:this.state.unionCutOff,unionCutOffChange:this.unionCutOffChange})),r.a.createElement("div",null,r.a.createElement(k,{showFilter:this.state.showFilter,dataAndChecked:this.state.dataAndChecked,applyFilter:this.applyFilter,cancelFilter:this.cancelFilter,toggleChecked:this.toggleChecked})))),r.a.createElement("div",{className:"footer"},r.a.createElement(v,null))),r.a.createElement("div",null,e)}}]),t}(n.Component);function K(e){return fetch("https://mysterious-ridge-15861.herokuapp.com/"+e).then((function(e){return e.json()}))}function Q(e){return fetch("https://mysterious-ridge-15861.herokuapp.com/"+e).then((function(e){return e.text()}))}function G(e){return Promise.all(e)}function V(e){return e.replace(/\$/g,"%5Cu0024").replace(/%/g,"%5Cu0025").replace(/!/g,"%5Cu0021").replace(/"/g,"%5Cu0022").replace(/#/g,"%5Cu0023").replace(/&/g,"%5Cu0026").replace(/'/g,"%5Cu0027").replace(/\(/g,"%5Cu0028").replace(/\)/g,"%5Cu0029").replace(/\*/g,"%5Cu002A").replace(/\+/g,"%5Cu002B").replace(/-/g,"%5Cu002D").replace(/;/g,"%5Cu003B").replace(/=/g,"%5Cu003D").replace(/\?/g,"%5Cu003F").replace(/\./g,"%5Cu002E").replace(/\//g,"%5Cu002F").replace(/,/g,"%5Cu002C").replace(/\s/g,"_")}function J(e){return e.replace(/%E2%80%93/g,"%5Cu2013").replace(/\$/g,"%5Cu0024").replace(/!/g,"%5Cu0021").replace(/"/g,"%5Cu0022").replace(/#/g,"%5Cu0023").replace(/&/g,"%5Cu0026").replace(/'/g,"%5Cu0027").replace(/\(/g,"%5Cu0028").replace(/\)/g,"%5Cu0029").replace(/\*/g,"%5Cu002A").replace(/\+/g,"%5Cu002B").replace(/-/g,"%5Cu002D").replace(/;/g,"%5Cu003B").replace(/=/g,"%5Cu003D").replace(/\?/g,"%5Cu003F").replace(/\./g,"%5Cu002E").replace(/\//g,"%5Cu002F").replace(/,/g,"%5Cu002C").replace(/\s/g,"_")}function $(e){return!0===e.includes("http://dbpedia.org/resource/")&&(e=e.slice(28)),e}function Y(e,t,a){var n=t.sort((function(e,t){return e.p.value.slice(28)>t.p.value.slice(28)?1:-1}));if((n=n.filter((function(e){return e.p.value.slice(28).length>1}))).length>0){var r=1,l=n[0].p.value.slice(28),o="";void 0!==n[0].range&&(o=n[0].range.value);for(var s=1;s<n.length;++s){var i=n[s].p.value.slice(28);if(i===l)++r;else{if(r<=50){var c=l;"object"===a&&(c="is "+c+" of"),r>1&&(c+=" *");var u={value:l,label:c,type:a,count:r};"subject"===a&&""!==o&&(u.range=o),e.push(u)}r=1,l=i,o="",void 0!==n[s].range&&(o=n[s].range.value)}}if(r<=50){var p=l;"object"===a&&(p="is "+p+" of"),r>1&&(p+=" *");var d={value:l,label:p,type:a,count:r};"subject"===a&&""!==o&&(d.range=o),e.push(d)}}return e}function z(e,t){var a=e.sort((function(e,t){return e.p.value.slice(28)>t.p.value.slice(28)?1:-1})),n=[];if((a=a.filter((function(e){return e.p.value.slice(28).length>1}))).length>1){n.push({key:"subject"===t?a[0].p.value.slice(28):"is "+a[0].p.value.slice(28)+" of",value:[$(a[0].value.value)]});for(var r=0,l=1;l<a.length;++l){a[l].p.value.slice(28)===a[l-1].p.value.slice(28)?n[r].value.length<5&&n[r].value.push($(a[l].value.value)):(n.push({key:"subject"===t?a[l].p.value.slice(28):"is "+a[l].p.value.slice(28)+" of",value:[$(a[l].value.value)]}),++r)}}return n}function Z(e,t,a){for(var n=0;n<a.length;++n)"null"!==a[n]&&a[n]++;a.splice(0,0,0);for(var r=[],l=0;l<t.length;++l){for(var o=[],s=0;s<a.length;++s){var i=a[s];"null"!==i?o.push(t[l][i]):o.push({data:"N/A"})}r.push(o)}return e.concat(r)}function ee(e){return"\n"===e[e.length-1]?e.slice(0,-1).trim().split("[")[0]:e.trim().split("[")[0]}function te(e,t,a,n,r,l){for(var o=[],s=1;s<e.length;++s)o.push(e[s].value);for(var i=(new DOMParser).parseFromString(t,"text/html").getElementsByClassName("wikitable"),c=[],u=0;u<i.length;++u)"TH"!==i[u].tagName&&c.push(i[u]);for(var p=[],d=[],h=0;h<c.length;++h)d.push(ae(c[h],o,a,n,r,l));return G(d).then((function(e){for(var t=0;t<e.length;++t)p.push(e[t]);return(p=p.filter((function(e){return-1!==e}))).sort((function(e,t){return e.unionScore<t.unionScore?1:-1})),Promise.resolve(p)}))}function ae(e,t,a,n,r,l){for(var o=e.rows[0].cells,s=[],i=[],c=[],u=[],p=0;p<o.length;++p){var d=ee(o[p].innerText);s.push(d),i.push(p)}if(s.length>=t.length*r){for(var h=0,b=[],g=0;g<t.length;++g){var m=s.indexOf(t[g]);-1!==m?(b.push(m),h+=1/t.length):b.push("null")}if(s.length===t.length){for(var f=!0,v=0;v<b.length;++v)if("null"!==b[v]&&b[v]!==v){f=!1;break}if(!0===f)for(var C=0;C<b.length;++C)"null"===b[C]&&(s[C].includes(t[C])||t[C].includes(s[C]))&&(b[C]=C,h+=1/t.length);1===h&&(h+=.01)}if("enabled"===n){if(h<.999){i=i.filter((function(e){return b.indexOf(e)<0}));for(var y=0;y<b.length;++y)"null"===b[y]&&c.push(y);u.push(ne(e,i,l))}return G(u).then((function(n){if(h>=.999)return Promise.resolve({isOpen:!1,unionScore:h,colMapping:b,data:e,title:s});var l=function(){var l=n[0].slice();if(l.length>0)for(var o=0;o<c.length;++o){var u=c[o];if(a[u].length>0)for(var p=function(e){if(l[e].length>0)if("Number"===a[u][0]||"Number"===l[e][0]){if(a[u][0]===l[e][0])return b[u]=i[e],h+=1/t.length,i.splice(e,1),l.splice(e,1),--e,d=e,"break"}else{var n=a[u].filter((function(t){return d=e,l[e].indexOf(t)>=0}));if(n.length>0){var r=a[u].length,o=l[e].length;if(oe(n.length,780,r,o)>.999)return b[u]=i[e],h+=1/t.length,i.splice(e,1),l.splice(e,1),--e,d=e,"break"}}d=e},d=0;d<i.length;++d){if("break"===p(d))break}}return h>=r?{v:Promise.resolve({isOpen:!1,unionScore:h,colMapping:b,data:e,title:s})}:{v:Promise.resolve(-1)}}();return"object"===typeof l?l.v:void 0}))}return h>=r?Promise.resolve({isOpen:!1,unionScore:h,colMapping:b,data:e,title:s}):Promise.resolve(-1)}return Promise.resolve(-1)}function ne(e,t,a){for(var n=e,r=[],l=0;l<n.rows.length;++l){for(var o=[],s=0;s<n.rows[l].cells.length;++s){var i=ee(n.rows[l].cells[s].innerText);if(1===l)for(var c=n.rows[l].cells[s].getElementsByTagName("a"),u=0;u<c.length;++u)if(""!==c[u].innerText&&"["!==c[u].innerText[0]){var p=c[u].href.split("/");i=p[p.length-1]}var h=n.rows[l].cells[s].rowSpan,b=n.rows[l].cells[s].colSpan;o.push({data:i,rowSpan:h,colSpan:b})}r.push(o)}for(var g=0;g<r.length;++g)for(var m=0;m<r[g].length;++m){var f=r[g][m].data;if(r[g][m].colSpan>1)for(var v=1;v<r[g][m].colSpan;++v)r[g].splice(m+1,0,{data:f,rowSpan:1,colSpan:1})}for(var C=0;C<r.length;++C)for(var y=0;y<r[C].length;++y){var A=r[C][y].data;if(r[C][y].rowSpan>1)for(var E=1;E<r[C][y].rowSpan;++E)C+E<r.length&&r[C+E].splice(y,0,{data:A,rowSpan:1,colSpan:1})}var S=[],k=Math.min(1,r.length-1);if(void 0===t){t=[];for(var D=0;D<r[0].length;++D)t.push(D)}for(var I=0;I<t.length;++I)for(var x=t[I],O=1;O<=k;++O){var N=void 0===r[O][x]?"NONEXISTING":V(r[O][x].data);if(isNaN(Number(N))||""===N)if(N.length>40)S.push(Promise.resolve(["Null"]));else{void 0!==N&&""!==N||(N="NONEXISTING");var F="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fo%0D%0AWHERE+%7B%0D%0A++++++dbr%3A"+N+"+rdf%3Atype+%3Fo.%0D%0A++++++BIND%28STR%28%3Fo%29+AS+%3FoString+%29.%0D%0A++++++FILTER%28regex%28%3FoString%2C%22dbpedia.org%2Fontology%2F%22%2C%22i%22%29%29%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+";S.push(K(F))}else S.push(Promise.resolve(["Number"]))}return G(S).then((function(e){for(var a=[],n=0;n<t.length;++n){var r=[];if(void 0!==e[k*n])if(void 0!==e[k*n][0])"Number"===e[k*n][0]?a.push(["Number"]):"Null"===e[k*n][0]&&a.push([]);else{for(var l=0;l<k;++l){for(var o=[],s=e[k*n+l].results.bindings,i=0;i<s.length;++i)o.push(s[i].o.value.slice(28));r=Object(d.a)(new Set([].concat(Object(d.a)(r),o)))}a.push(r)}}return Promise.resolve(a)}))}function re(e,t){for(var a=e,n=[],r=0;r<a.rows.length;++r){for(var l=[],o=0;o<a.rows[r].cells.length;++o){var s=ee(a.rows[r].cells[o].innerText);if(r>0)for(var i=a.rows[r].cells[o].getElementsByTagName("a"),c=0;c<i.length;++c)if(""!==i[c].innerText&&"["!==i[c].innerText[0]){var u=i[c].href.split("/");s=decodeURIComponent(u[u.length-1])}var p=a.rows[r].cells[o].rowSpan,d=a.rows[r].cells[o].colSpan;l.push({data:s,origin:t,rowSpan:p,colSpan:d})}n.push(l)}for(var h=0;h<n.length;++h)for(var b=0;b<n[h].length;++b){var g=n[h][b].data;if(n[h][b].colSpan>1)for(var m=1;m<n[h][b].colSpan;++m)n[h].splice(b+1,0,{data:g,origin:t,rowSpan:n[h][b].rowSpan,colSpan:1})}for(var f=0;f<n.length;++f)for(var v=0;v<n[f].length;++v){var C=n[f][v].data;if(n[f][v].rowSpan>1)for(var y=1;y<n[f][v].rowSpan;++y)f+y<n.length&&n[f+y].splice(v,0,{data:C,origin:t,rowSpan:1,colSpan:1})}n[0].splice(0,0,{data:"OriginURL",origin:t,rowSpan:1,colSpan:1});for(var A=1;A<n.length;++A)n[A].splice(0,0,{data:t,origin:"null",rowSpan:1,colSpan:1});return n}function le(e){for(var t=[],a=0;a<e[0].length;++a)t.push({value:e[0][a].data,label:e[0][a].data});for(var n=[],r=1;r<e.length;++r){for(var l=[],o=0;o<e[r].length;++o){var s=e[r][o].data,i=[],c=e[r][o].origin+": "+t[o].value+": "+e[r][o].data;i.push(c),l.push({data:s,origin:i})}n.push(l)}return n}function oe(e,t,a,n){for(var r=0,l=Object(b.a)(t,n),o=0;o<=e;++o)r+=Object(b.a)(a,o)*Object(b.a)(t-a,n-o)/l;return r}function se(e,t){for(var a=-1,n=0;n<t.length;++n)if(t[n].length>0&&(1!==t[n].length||"Number"!==t[n][0])){a=n+1;break}-1===a&&(a=0);for(var r=[],l=0;l<e[0].length;++l)r.push({value:e[0][l].data,label:e[0][l].data});for(var o=[],s=1;s<e.length;++s){for(var i=[],c=0;c<e[s].length;++c){var u=e[s][c].data,p=[],d=e[s][c].origin+": "+r[c].value+": "+e[s][c].data;p.push(d),i.push({data:u,origin:p})}o.push(i)}var h=[],b=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%3Frange%0D%0AWHERE+%7B%0D%0A+++++++dbr%3A"+V(o[0][a].data)+"+%3Fp+%3Fo.%0D%0A+++++++OPTIONAL+%7B%3Fp+rdfs%3Arange+%3Frange%7D.%0D%0A+++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A+++++++FILTER%28%0D%0A++++++++++++++%21%28regex%28%3FpString%2C%22wikiPage%7Calign%7Cabstract%7Ccaption%7Cimage%7Cwidth%7Cthumbnail%7Cblank%22%2C%22i%22%29%29+%0D%0A++++++++++++++%26%26+regex%28%3FpString%2C+%22ontology%7Cproperty%22%2C+%22i%22%29%0D%0A++++++++++++++%29%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");h.push(b);var g=K("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%0D%0AWHERE+%7B%0D%0A++++++++%3Fs+%3Fp+dbr%3A"+V(o[0][a].data)+".%0D%0A++++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A++++++++FILTER%28%0D%0A+++++++++++++++%21%28regex%28%3FpString%2C%22wikiPage%7Calign%7Cabstract%7Ccaption%7Cimage%7Cwidth%7Cthumbnail%7Cblank%22%2C%22i%22%29%29+%0D%0A+++++++++++++++%26%26+regex%28%3FpString%2C+%22ontology%7Cproperty%22%2C+%22i%22%29%0D%0A+++++++++++++++%29%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");return h.push(g),G(h).then((function(e){var t=[];t=Y(t,e[0].results.bindings,"subject"),t=Y(t,e[1].results.bindings,"object");for(var n=[],l=0;l<r.length;++l)n.push([]);return Promise.resolve({keyColIndex:a,tableHeader:r,tableData:o,keyColNeighbours:t,optionsMap:n})}))}function ie(e){var t=e,a=e.indexOf("(");return-1!==a&&(t=t.slice(0,a-1)),t.replace(/_/g," ")}var ce=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"wrapper "},r.a.createElement("div",{className:"font-body"},r.a.createElement("div",null,r.a.createElement(W,null))))}}]),t}(n.Component);o.a.render(r.a.createElement(ce,null),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.b6026638.chunk.js.map