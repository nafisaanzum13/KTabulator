(this.webpackJsonpKGWrangler=this.webpackJsonpKGWrangler||[]).push([[0],{49:function(e,t,a){e.exports=a(78)},55:function(e,t,a){},56:function(e,t,a){},78:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),r=a(21),o=a.n(r),i=(a(54),a(55),a(56),a(7)),s=a(8),c=a(9),u=a(10),p=a(11),h=a(24),d=a(2),b=a(85),g=a(17),f=a(44),m=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"row header-body"},l.a.createElement("div",{className:"col-md-8"},l.a.createElement("a",{href:"index.html",class:"logo"},l.a.createElement("b",null,l.a.createElement("span",null,"KG"),"Wrangler"))),l.a.createElement("div",{className:"offset-md-2 col-md-2 row"},l.a.createElement("div",{className:"col-md-4"},l.a.createElement("button",{className:"btn btn-default",title:"copy table to csv",onClick:function(){return e.props.copyTable()}},l.a.createElement(g.b,{className:"logo-left-color"}))),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("button",{className:"btn btn-default",title:"Union Table Settings"},l.a.createElement(f.a,{className:"logo-left-color",onClick:function(){return e.props.openModal()}}))),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("button",{className:"btn btn-default",title:"undo previous action",onClick:function(){return e.props.undoPreviousStep()}},l.a.createElement(g.f,{className:"color-wrangler"}))))),l.a.createElement("hr",{class:"header-hr"}))}}]),t}(n.Component),v=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"text-center text-sm"},l.a.createElement("small",null,"University of Waterloo, 2020")))}}]),t}(n.Component),C=a(27),y=a.n(C),k=a(45),E=a.n(k),A=(a(68),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement(y.a,{isOpen:this.props.showSetting,className:"setting-modal"},l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 offset-md-3"},l.a.createElement("h4",null,"Table Union Search Settings"))),l.a.createElement("br",null),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-4"},"Semantic Mapping:"),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{onChange:function(t){return e.props.toggleSemantic(t)}},l.a.createElement("input",{type:"radio",value:"enabled",checked:"enabled"===this.props.semanticEnabled})," ","Enabled",l.a.createElement("input",{type:"radio",value:"disabled",checked:"disabled"===this.props.semanticEnabled})," ","Disabled"))),l.a.createElement("br",null),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-4"},"Percentage of Columns to Union:"),l.a.createElement("div",{className:"col-md-6"},l.a.createElement(E.a,{value:this.props.unionCutOff,onChange:function(t){return e.props.unionCutOffChange(t)},min:0,max:1,step:.05}))),l.a.createElement("br",null),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-4 offset-md-4"},l.a.createElement("button",{onClick:function(){return e.props.closeModal()}},"Confirm Settings"))))))}}]),t}(n.Component)),N=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){for(var e=this,t=[],a=function(a){t.push(l.a.createElement("div",null,l.a.createElement("input",{type:"checkbox",checked:e.props.dataAndChecked[a].checked,onChange:function(t){return e.props.toggleChecked(t,a)}}),e.props.dataAndChecked[a].data))},n=0;n<this.props.dataAndChecked.length;++n)a(n);return l.a.createElement("div",null,l.a.createElement(y.a,{isOpen:this.props.showFilter,className:"filter-modal"},l.a.createElement("div",{className:"container"},l.a.createElement("div",null,"Here is the list of data to filter from selected column."),l.a.createElement("br",null),l.a.createElement("div",{className:"checkbox-list"},t),l.a.createElement("br",null),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-1 offset-md-9"},l.a.createElement("button",{onClick:function(t){return e.props.applyFilter(t)}},"OK")),l.a.createElement("div",{className:"col-md-2"},l.a.createElement("button",{onClick:function(t){return e.props.cancelFilter(t)}},"Cancel"))))))}}]),t}(n.Component),O=a(35),S=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement(y.a,{isOpen:this.props.showJoin,className:"join-modal"},l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-5"},"Choose join column from table panel"),l.a.createElement("div",{className:"offset-md-1 col-md-5"},"Choose join column from selected table")),l.a.createElement("br",null),l.a.createElement("div",{className:"row"},l.a.createElement(O.a,{className:"col-md-5",value:this.props.originColOptions[this.props.originJoinIndex],onChange:function(t){return e.props.selectJoinColumn(t,"originTable")},placeholder:"Choose Join Column",options:this.props.originColOptions,isMulti:!1}),l.a.createElement(O.a,{className:"offset-md-1 col-md-5",value:this.props.joinColOptions[this.props.joinJoinIndex],onChange:function(t){return e.props.selectJoinColumn(t,"joinTable")},placeholder:"Choose Join Column",options:this.props.joinColOptions,isMulti:!1})),l.a.createElement("br",null),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-1 offset-md-9"},l.a.createElement("button",{onClick:function(t){return e.props.runJoin(t)}},"OK")),l.a.createElement("div",{className:"col-md-2"},l.a.createElement("button",{onClick:function(t){return e.props.cancelJoin(t)}},"Cancel"))))))}}]),t}(n.Component),D=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.handleURLPaste=a.handleURLPaste.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"handleURLPaste",value:function(e){e.preventDefault();var t=(e.clipboardData||window.clipboardData).getData("text");this.props.handleURLPaste(t)}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{className:"row text-center"},l.a.createElement("div",{className:"col-md-6 offset-md-3"},l.a.createElement("input",{placeholder:"e.g., https://en.wikipedia.org/wiki/Canada",onPaste:this.handleURLPaste,className:" form-control"}))))}}]),t}(n.Component),I=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{class:"landing-page"},l.a.createElement("div",{class:" row text-center"},l.a.createElement("div",{class:"white-form col-md-5"},l.a.createElement("h1",{class:""}," Welcome!"),l.a.createElement("hr",{className:"header-hr"}),l.a.createElement("h4",null,"Enter the URL of a Wikipedia page and start wrangling!"),l.a.createElement(D,{handleURLPaste:this.props.handleURLPaste})))))}}]),t}(n.Component),x=a(20),j=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createSuperTable=a.createSuperTable.bind(Object(d.a)(a)),a.createSelectedTableView=a.createSelectedTableView.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"columnHeaderGen",value:function(e){var t="";if(0===e)for(var a=0;a<this.props.tableHeader[0].length;++a){t+=a>0?"\nAND "+w(this.props.tableHeader[0][a].label):w(this.props.tableHeader[0][a].label)}else for(var n=0;n<this.props.tableHeader[e].length;++n){var r="object"===this.props.tableHeader[e][n].type?"is "+this.props.tableHeader[e][n].value+" of":this.props.tableHeader[e][n].value;t+=r=n>0?"\nOR "+r:r}return l.a.createElement("div",null,t)}},{key:"createSuperTable",value:function(){for(var e=this,t=this.props.tableData.length,a=this.props.tableData[0].length,n=[],r=[],o=function(t){var a=void 0;if(0===t){var n=null,o=l.a.createElement("div",null,l.a.createElement("br",null));!0===e.props.firstColFilled&&(o=e.columnHeaderGen(t),"OriginURL"!==e.props.tableHeader[0][0].value&&(n=l.a.createElement("div",null,l.a.createElement("button",{className:"btn btn-default",title:"Add entities",onClick:function(){return e.props.handlePlusClick()}},l.a.createElement(g.a,null)),l.a.createElement("button",{className:"btn btn-default",title:"Set as key column",onClick:function(a){return e.props.contextSetColumn(a,t)}},l.a.createElement(g.d,null))))),a=l.a.createElement("th",{className:"table-head"},l.a.createElement("div",{className:"super-header-div"}),n,o)}else if(t===e.props.keyColIndex){var i=e.columnHeaderGen(t),s=l.a.createElement("div",null,l.a.createElement("br",null));a=l.a.createElement("th",{className:"table-head"},s,i)}else{var c=e.columnHeaderGen(t),u=l.a.createElement("div",null,l.a.createElement("br",null));!0===e.props.firstColFilled&&(u=l.a.createElement("div",null,l.a.createElement("button",{className:"btn btn-default",title:"Add entities",onClick:function(a){return e.props.getOtherOptions(a,t)}},l.a.createElement(g.a,null)),l.a.createElement("button",{className:"btn btn-default",title:"Set as key column",onClick:function(a){return e.props.contextSetColumn(a,t)}},l.a.createElement(g.d,null)))),a=l.a.createElement("th",{className:"table-head"},u,c)}r.push(a)},i=0;i<a;++i)o(i);n.push(l.a.createElement("thead",{className:"table-head"},l.a.createElement("tr",null,r)));for(var s=[],c=function(t){for(var n=[],r=function(a){var r="cellRow"+t+"Col"+a,o=void 0;o=a===e.props.keyColIndex?{backgroundColor:"LightBlue"}:{backgroundColor:"White"},n.push(l.a.createElement("td",{style:o},l.a.createElement(x.b,{id:r},l.a.createElement("input",{className:"twenty-vw",type:"text",value:w(e.props.tableData[t][a].data),title:w(e.props.tableData[t][a].data),onChange:function(n){return e.props.onCellChange(n,t,a)}}))))},o=0;o<a;o++)r(o);s.push(l.a.createElement("tr",null,n))},u=0;u<t;u++)c(u);return n.push(l.a.createElement("tbody",null,s)),n}},{key:"createSelectedTableView",value:function(){for(var e=this.props.tableDataExplore.length,t=this.props.tableDataExplore[0].length,a=[],n=[],r=0;r<t;++r){var o=l.a.createElement("th",{className:"table-head table-col"},this.props.tableDataExplore[0][r].data);n.push(o)}var i=l.a.createElement("tr",{className:"table-head table-col"},n);a.push(l.a.createElement("thead",null,i));for(var s=[],c=1;c<e;c++){for(var u=[],p=0;p<t;p++)u.push(l.a.createElement("td",{className:"table-col"},this.props.tableDataExplore[c][p].data));s.push(l.a.createElement("tr",null,u))}return a.push(l.a.createElement("tbody",null,s)),a}},{key:"render",value:function(){for(var e,t=this,a=[],n=function(e){for(var n=function(n){var r="cellRow"+e+"Col"+n;a.push(l.a.createElement(x.a,{id:r},l.a.createElement(x.c,{onClick:function(e){return t.props.contextAddColumn(e,n)}},"Add Column to the Right"),l.a.createElement(x.c,{onClick:function(e){return t.props.contextDeleteColumn(e,n)}},"Delete this column"),l.a.createElement(x.c,{divider:!0}),l.a.createElement(x.c,{onClick:function(e){return t.props.openFilter(e,n)}},"Filter this column"),l.a.createElement(x.c,{onClick:function(e){return t.props.contextSortColumn(e,n,"ascending")}},"Sort ascending"),l.a.createElement(x.c,{onClick:function(e){return t.props.contextSortColumn(e,n,"descending")}},"Sort descending"),l.a.createElement(x.c,{divider:!0}),l.a.createElement(x.c,{onClick:function(a){return t.props.contextCellOrigin(a,e,n)}},"Show Origin of Cell"),l.a.createElement(x.c,{onClick:function(a){return t.props.contextCellPreview(a,e,n)}},"Show Preview of Cell"),l.a.createElement(x.c,{onClick:function(a){return t.props.contextOpenLink(a,e,n)}},"Open Wikipage for Cell")))},r=0;r<t.props.tableData[0].length;++r)n(r)},r=0;r<this.props.tableData.length;++r)n(r);return e=l.a.createElement("div",null,l.a.createElement("table",{class:!0,border:"1",className:"table table-sm table-bordered"},this.createSuperTable()),a),l.a.createElement("div",null,e)}}]),t}(n.Component);function w(e){return e.replace(/_\(.*?\)/g,"").replace(/_/g," ")}var F=a(81),T=a(82),P=a(83),L=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createButtonArray=a.createButtonArray.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createButtonArray",value:function(){for(var e=this,t=this.props.originTableArray,a=[],n=function(n){for(var r="Table "+n+": ",o=t[n].rows[0].cells,i=0;i<o.length;++i){var s=M(o[i].innerText);"\n"===s[s.length-1]&&(s=s.slice(0,-1)),r=r+s+"| "}var c=l.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.props.originTableArray[n].outerHTML}}),u=void 0;if(!0===e.props.tableOpenList[n]){var p="";p="select"===e.props.listType?"Select":"Join",u=l.a.createElement("button",{onClick:function(t){return e.props.buttonFunction(t,n)}},p)}a.push(l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{onClick:function(t){return e.props.toggleTable(t,n)}},r," ",l.a.createElement(g.e,null)),u,l.a.createElement(F.a,{isOpen:e.props.tableOpenList[n]},l.a.createElement("div",null,c))))},r=0;r<t.length;++r)n(r);return l.a.createElement("ul",{className:"list-group list-css list-group-flush"},a)}},{key:"render",value:function(){var e=null;return 0!==this.props.originTableArray.length&&(e=l.a.createElement("div",null,this.createButtonArray())),l.a.createElement("div",null,e)}}]),t}(n.Component);function M(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}var H=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=function(e){var t=e,a=e.indexOf("(");-1!==a&&(t=t.slice(0,a-1));return t.replace(/_/g," ")}(this.props.urlPasted.slice(30).replace(/%E2%80%93/,"\u2013"));return l.a.createElement("div",null,l.a.createElement("ul",{class:"list-group list-css list-group-flush"},l.a.createElement("hr",{className:"m-0"}),l.a.createElement("li",{className:"list-group-item",onClick:function(t){return e.props.handleStartSubject(t,"startSubject")}},"Start creating a table about ",decodeURIComponent(t)),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{onClick:function(){return e.props.toggleTableSelection()}},"Start with an existing table from page ",l.a.createElement(g.c,null)),l.a.createElement(F.a,{isOpen:this.props.showTableSelection},l.a.createElement(T.a,null,l.a.createElement(P.a,null,l.a.createElement("div",null,l.a.createElement(L,{originTableArray:this.props.originTableArray,tableOpenList:this.props.tableOpenList,toggleTable:this.props.toggleTable,buttonFunction:this.props.handleStartTable,listType:"select"})))))),l.a.createElement("hr",{className:"m-0"})))}}]),t}(n.Component);var R=a(84),_=a(19),J=(a(76),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createFirstColSelection=a.createFirstColSelection.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createFirstColSelection",value:function(){var e=this,t=this.props.keyCheckedIndex,a=this.props.firstColSelection,n=this.props.firstColChecked,r=null,o=[];n.length!==a.length&&alert("Some error exists");for(var i=0;i<n.length;++i)!0===n[i]&&o.push(a[i]);if(-1!==t&&o.length>0){for(var s=!1===this.props.firstColFilled?"Populate first column with entities that":"Add to first column with entities that",c=0;c<o.length;++c){var u=c>0?", and":"";s+=u="dct"===o[c].pDataset?u+" are "+U(o[c].oValue):u+" have "+o[c].pValue+"="+U(o[c].oValue)}s+="?";var p=!1===this.props.firstColFilled?l.a.createElement("button",{onClick:function(t){return e.props.populateKeyColumn(t,0,o)}},"Okay"):l.a.createElement("button",{onClick:function(t){return e.props.confirmAddFirstCol(t,o)}},"Okay");r=l.a.createElement("div",null,l.a.createElement("p",null,l.a.createElement("b",null,s),p))}for(var h=[],d=function(o){var i=o===t?r:null;"category"===a[o].pValue?h.push(l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("p",null,l.a.createElement("input",{type:"checkbox",checked:n[o],onChange:function(t){return e.props.toggleFirstNeighbour(t,o)}}),"\xa0","\xa0",U(a[o].oValue))),i)):h.push(l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("p",null,l.a.createElement("input",{type:"checkbox",checked:n[o],onChange:function(t){return e.props.toggleFirstNeighbour(t,o)}}),"\xa0","\xa0",a[o].pValue,":","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0",U(a[o].oValue))),i))},b=0;b<a.length;++b)d(b);return h}},{key:"render",value:function(){var e=this.createFirstColSelection();return l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("p",null,l.a.createElement("b",null,"Choose from attributes below")," to determine the content for the first column")),l.a.createElement("br",null),l.a.createElement("div",null,e))}}]),t}(n.Component));function U(e){return e.replace(/_\(.*?\)/g,"").replace(/_/g," ")}var B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createOtherColSelection=a.createOtherColSelection.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createOtherColSelection",value:function(){var e=this,t=this.props.otherColSelection,a=this.props.otherColChecked,n=this.props.otherCheckedIndex;a.length!==t.length&&console.log("Some error exists");for(var r=[],o=0;o<a.length;++o)!0===a[o]&&r.push(t[o]);var i=null;if(-1!==n&&r.length>0){for(var s="Populate this column with attributes ",c=0;c<r.length;++c){var u=c>0?" OR "+r[c].value:r[c].value;s+=u="subject"===r[c].type?u:"is "+u+" of"}s+="?",i=l.a.createElement("div",null,l.a.createElement("p",null,l.a.createElement("b",null,s)),l.a.createElement("button",{onClick:function(t){return e.props.populateOtherColumn(t,e.props.colIndex,r)}},"OK"))}for(var p=[],h=function(r){var o=r===n?i:null;p.push(l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("p",null,l.a.createElement("input",{type:"checkbox",checked:a[r],onChange:function(t){return e.props.toggleOtherNeighbour(t,r)}}),"\xa0","\xa0",t[r].label)),o))},d=0;d<t.length;++d)h(d);return p}},{key:"render",value:function(){var e=this.createOtherColSelection();return l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("p",null,l.a.createElement("b",null,"Choose from attributes below")," to determine the content for the this column")),l.a.createElement("br",null),l.a.createElement("div",null,e))}}]),t}(n.Component),q=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createPropertyArray=a.createPropertyArray.bind(Object(d.a)(a)),a.createSiblingArray=a.createSiblingArray.bind(Object(d.a)(a)),a.createTableArray=a.createTableArray.bind(Object(d.a)(a)),a.createRecommendArray=a.createRecommendArray.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createTableArray",value:function(e,t){for(var a=this,n=this.props.propertyNeighbours[e].siblingArray[t].tableArray,r=[],o=function(o){for(var i="Table "+o+": ",s=0;s<n[o].title.length;++s)i=i+n[o].title[s]+"|";r.push(l.a.createElement("div",null,l.a.createElement(R.a,{onClick:function(n){return a.props.toggleOtherTable(n,e,t,o)}},i,l.a.createElement(g.e,null)),l.a.createElement(F.a,{isOpen:n[o].isOpen},l.a.createElement(P.a,null,l.a.createElement(T.a,null,l.a.createElement("div",null,l.a.createElement("ul",{className:"list-group list-css"},l.a.createElement("li",{className:"col-md-4 list-group-item list-button list-button-backgound-pink",onClick:function(l){return a.props.unionTable(e,t,n[o].data,n[o].colMapping)}},"Union table")),l.a.createElement("div",{dangerouslySetInnerHTML:{__html:n[o].data.outerHTML}})))))))},i=0;i<n.length;++i)o(i);return r}},{key:"createSiblingArray",value:function(e){for(var t=this,a=this.props.propertyNeighbours[e].siblingArray,n=[],r=!1,o=function(o){var i="Examine tables on page "+a[o].name,s="list-group-item";a[o].isOpen&&(s="list-group-item list-with-background"),!1===r&&0===a[o].tableArray.length&&(r=!0,n.push(l.a.createElement("li",{className:"list-group-item"},l.a.createElement("hr",null),l.a.createElement("h5",null,"Below are sibling pages on which no similar tables are found:"),l.a.createElement("hr",null)))),n.push(l.a.createElement("li",{className:s,title:i},l.a.createElement("span",{onClick:function(a){return t.props.toggleSibling(a,e,o)}},a[o].name+" ",l.a.createElement(g.c,null)),l.a.createElement(F.a,{isOpen:a[o].isOpen},l.a.createElement("div",null,l.a.createElement("ul",{className:"list-group list-css"},l.a.createElement("li",{className:"col-md-4 list-group-item list-button",onClick:function(a){return t.props.unionPage(e,o)}},"Union from page")),t.createTableArray(e,o)))))},i=0;i<a.length;++i)o(i);return l.a.createElement("ul",{className:"list-group list-css list-group-flush"}," ",n," ")}},{key:"createPropertyArray",value:function(){for(var e=this,t=this.props.propertyNeighbours,a=[],n=function(n){var r=t[n].predicate,o=t[n].object,i=r+": "+o+" ",s="Show other pages with "+r+": "+o,c="list-group-item";e.props.propertyNeighbours[n].isOpen&&(c="list-group-item list-with-background"),a.push(l.a.createElement("li",{class:c,title:s},l.a.createElement("span",{onClick:function(t){return e.props.togglePropertyNeighbours(t,n)}},i,l.a.createElement(g.c,null)),l.a.createElement(F.a,{isOpen:e.props.propertyNeighbours[n].isOpen},l.a.createElement("div",null,l.a.createElement("hr",null),e.createSiblingArray(n)))))},r=0;r<t.length;++r)n(r);return l.a.createElement("ul",{className:"list-group list-css list-group-flush"},a)}},{key:"createRecommendArray",value:function(e,t){for(var a=this,n=[],r=[],o=function(o){var i=[{value:t[o].value,type:t[o].type}],s="subject"===t[o].type?t[o].value:"is "+t[o].value+" of";"string"===t[o].relation?n.push(l.a.createElement("div",null,l.a.createElement(R.a,{onClick:function(t){return a.props.populateRecommendation(t,e,i)}},"add ",s))):r.push(l.a.createElement("div",null,l.a.createElement(R.a,{onClick:function(t){return a.props.populateRecommendation(t,e,i)}},"add ",s)))},i=0;i<t.length;++i)o(i);return l.a.createElement("div",null,l.a.createElement("p",null,"Recommendations of attributes to add:"),n,r)}},{key:"render",value:function(){var e,t,a,n=this;if(a=""===this.props.usecaseSelected?l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-8"},l.a.createElement("h4",{className:"logo-left-color"},"ACTIONS",l.a.createElement("span",null," "),l.a.createElement("span",{className:"logo-right-color xsmall"},"Select your starting action")))):l.a.createElement("div",{className:"row action-header"},l.a.createElement("div",{className:"col-md-8"},l.a.createElement("h4",{className:"logo-left-color"},"ACTIONS",l.a.createElement("span",null," "),l.a.createElement("span",{className:"logo-right-color xsmall"},"Select your next action")))),""===this.props.usecaseSelected)t=l.a.createElement(H,{handleStartSubject:this.props.handleStartSubject,urlPasted:this.props.urlPasted,showTableSelection:this.props.showTableSelection,toggleTableSelection:this.props.toggleTableSelection,originTableArray:this.props.originTableArray,tableOpenList:this.props.tableOpenList,toggleTable:this.props.toggleTable,selectedTableIndex:this.props.selectedTableIndex,handleStartTable:this.props.handleStartTable});else if(null!==this.props.curActionInfo){var r=this.props.curActionInfo;if("afterStartSubject"===r.task)e=l.a.createElement(J,{firstColSelection:this.props.firstColSelection,firstColChecked:this.props.firstColChecked,firstColFilled:this.props.firstColFilled,toggleFirstNeighbour:this.props.toggleFirstNeighbour,tableHeader:this.props.tableHeader,keyCheckedIndex:this.props.keyCheckedIndex,populateKeyColumn:this.props.populateKeyColumn,confirmAddFirstCol:this.props.confirmAddFirstCol});else if("showOtherColSelection"===r.task)e=l.a.createElement(B,{otherColSelection:this.props.otherColSelection,otherColChecked:this.props.otherColChecked,otherCheckedIndex:this.props.otherCheckedIndex,toggleOtherNeighbour:this.props.toggleOtherNeighbour,populateOtherColumn:this.props.populateOtherColumn,colIndex:r.colIndex});else if("plusClicked"===r.task)e=l.a.createElement("div",null,l.a.createElement("p",null,"Add more entities to the first column?"),l.a.createElement("button",{onClick:function(){return n.props.addToFirstCol()}},"OK"));else if("afterPopulateColumn"===r.task)e=l.a.createElement("div",null,"Fill an ",l.a.createElement("b",null,"empty column header")," by choosing from its ",l.a.createElement("b",null,"down arrow"));else if("populateKeyColumn"===r.task){for(var o="",i=0;i<r.neighbourArray.length;++i)i>0&&(o+=" & "),o+=r.neighbourArray[i].label;e=""!==o?l.a.createElement("div",null,l.a.createElement("p",null,"Fill this column with:"),l.a.createElement("p",null,l.a.createElement("b",null,o)," ?"),l.a.createElement("button",{onClick:function(e){return n.props.populateKeyColumn(e,r.colIndex,r.neighbourArray)}},"OK")):l.a.createElement("div",null,l.a.createElement("p",{className:"suggestion-text"},"Fill the ",l.a.createElement("b",null,"first column header")," by choosing from its ",l.a.createElement("b",null,"down arrow")))}else if("populateOtherColumn"===r.task){var s=W(r.neighbourArray);e=l.a.createElement("div",null,l.a.createElement("p",null,"Fill this column with:"),l.a.createElement("p",null,l.a.createElement("b",null,s)," ?"),l.a.createElement("button",{onClick:function(e){return n.props.populateOtherColumn(e,r.colIndex,r.neighbourArray)}},"OK"))}else if("populateSameNeighbour"===r.task){var c=W(r.neighbourArray);e=l.a.createElement("div",null,l.a.createElement("p",null,"Add all other properties with name:"),l.a.createElement("p",null,l.a.createElement("b",null,c)," ?"),l.a.createElement("div",{className:"row"},l.a.createElement("button",{className:"col-md-4",onClick:function(e){return n.props.sameNeighbourOneCol(e,r.colIndex,r.neighbourArray)}},"In One Column"),l.a.createElement("button",{className:"offset-md-1 col-md-4",onClick:function(e){return n.props.sameNeighbourDiffCol(e,r.colIndex,r.neighbourArray,r.numCols)}},"In Separate Columns")))}else if("populateSameRange"===r.task){for(var u="",p="",h=0;h<r.siblingNeighbour.length;++h)h>0&&(u+=", ",p="s"),u+=r.siblingNeighbour[h].value;e=l.a.createElement("div",null,l.a.createElement("p",null,"Add column",p,": ",l.a.createElement("b",null,u)),l.a.createElement("p",null,"that also has type: ",r.range," ?"),l.a.createElement("button",{onClick:function(e){return n.props.populateSameRange(e,r.colIndex,r.range,r.siblingNeighbour)}},"OK"))}else if("populateRecommendation"===r.task){var d=this.createRecommendArray(r.colIndex,r.recommendArray);e=l.a.createElement("div",null,d)}else"contextCellOrigin"===r.task?e=l.a.createElement("div",null,l.a.createElement("p",null,"Origin of selected cell is:"),l.a.createElement("div",null,r.origin)):"contextCellPreview"===r.task&&(e=l.a.createElement("div",null,l.a.createElement("p",null,"Preview of ",l.a.createElement("b",null,X(r.cellValue))," is:"),l.a.createElement("div",null,function(e){console.log(e);for(var t=[],a=0;a<e.length;++a){for(var n=e[a].key,r=X(e[a].value[0]),o=1;o<e[a].value.length;++o)r=r+"; "+X(e[a].value[o]);t.push(l.a.createElement("p",null,l.a.createElement("b",null,n),":","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0",r))}return t}(r.preview))))}if("startSubject"===this.props.usecaseSelected){var b=this.props.tabIndex;t=l.a.createElement("div",null,l.a.createElement(_.d,{selectedIndex:b,onSelect:function(e){return n.props.handleTabSwitch(e)}},l.a.createElement(_.b,null,l.a.createElement(_.a,null,"Wrangling Actions"),l.a.createElement(_.a,null,"Table Actions")),l.a.createElement(_.c,null,e),l.a.createElement(_.c,null,l.a.createElement("div",null,l.a.createElement("ul",{class:"list-group list-css list-group-flush"},l.a.createElement("hr",{className:"m-0"}),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{onClick:function(e){return n.props.toggleUnionJoin(e,"union")}},"Union Tables from Wikipedia"),l.a.createElement(F.a,{isOpen:this.props.showUnionTables},l.a.createElement(T.a,null,l.a.createElement(P.a,null,"Currently, finding unionable tables for customized table is not supported.")))),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{onClick:function(e){return n.props.toggleUnionJoin(e,"join")}},"Join Tables from Wikipedia"),l.a.createElement(F.a,{isOpen:this.props.showJoinTables},l.a.createElement(T.a,null,l.a.createElement(P.a,null,l.a.createElement(L,{originTableArray:this.props.originTableArray,tableOpenList:this.props.tableOpenList,toggleTable:this.props.toggleTable,buttonFunction:this.props.handleJoinTable,listType:"join"}))))),l.a.createElement("hr",{className:"m-0"}))))))}else if("startTable"===this.props.usecaseSelected)if(-1!==this.props.selectedTableIndex){var g=this.props.tabIndex;t=l.a.createElement("div",null,l.a.createElement(_.d,{selectedIndex:g,onSelect:function(e){return n.props.handleTabSwitch(e)}},l.a.createElement(_.b,null,l.a.createElement(_.a,null,"Wrangling Actions"),l.a.createElement(_.a,null,"Table Actions")),l.a.createElement(_.c,null,e),l.a.createElement(_.c,null,l.a.createElement("div",null,l.a.createElement("ul",{class:"list-group list-css list-group-flush"},l.a.createElement("hr",{className:"m-0"}),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{onClick:function(e){return n.props.toggleUnionJoin(e,"union")}},"Union Tables from Wikipedia"),l.a.createElement(F.a,{isOpen:this.props.showUnionTables},l.a.createElement(T.a,null,l.a.createElement(P.a,null,"Expand relations below to look at other pages with similar tables:",l.a.createElement("br",null),l.a.createElement("br",null),this.createPropertyArray())))),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("span",{onClick:function(e){return n.props.toggleUnionJoin(e,"join")}},"Join Tables from Wikipedia"),l.a.createElement(F.a,{isOpen:this.props.showJoinTables},l.a.createElement(T.a,null,l.a.createElement(P.a,null,l.a.createElement(L,{originTableArray:this.props.originTableArray,tableOpenList:this.props.tableOpenList,toggleTable:this.props.toggleTable,buttonFunction:this.props.handleJoinTable,listType:"join"}))))),l.a.createElement("hr",{className:"m-0"}))))))}else t=e;return l.a.createElement("div",null,l.a.createElement("div",null,a),l.a.createElement("div",null,t))}}]),t}(n.Component);function X(e){return e.replace(/_\(.*?\)/g,"").replace(/_/g," ")}function W(e){for(var t="",a=0;a<e.length;++a){a>0&&(t+=" OR "),t+="subject"===e[a].type?e[a].value:"is "+e[a].value+" of"}return t}var K=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=null,a="small-padding wiki-page-hidden";if(""!==this.props.iframeURL){var n=l.a.createElement("button",{className:"btn btn-sm btn-info toggle-button",onClick:function(){return e.props.toggleWikiPage()}},l.a.createElement("i",{class:"fa fa-chevron-up","aria-hidden":"true"}),"Show");this.props.pageHidden||(a="small-padding wiki-page",n=l.a.createElement("div",null,l.a.createElement("hr",{className:"m-1"}),l.a.createElement("button",{className:"btn btn-sm btn-info toggle-button",onClick:function(){return e.props.toggleWikiPage()}},l.a.createElement("i",{class:"fa fa-chevron-down","aria-hidden":"true"}),"Hide"))),t=l.a.createElement("div",{className:"page-panel text-right"},n,l.a.createElement("div",{className:a},l.a.createElement("iframe",{id:"iframe",title:"URLPage",src:this.props.iframeURL,className:"iframe-cls"})))}return l.a.createElement("div",null,t)}}]),t}(n.Component),V=a(13),G=a.n(V),Q=function(e){function t(e){var a;Object(i.a)(this,t),a=Object(c.a)(this,Object(u.a)(t).call(this,e));for(var n=[],l=[],r=[],o=0;o<10;++o){for(var s=[],p=0;p<4;++p)s.push({data:"",origin:[]});n.push(s)}for(var h=0;h<4;++h){r.push([]),l.push([])}return a.state={urlPasted:"",tablePasted:"",usecaseSelected:"",pageHidden:!1,iframeURL:"",curActionInfo:null,lastAction:"",prevState:"",showSetting:!1,showTableSelection:!1,tabIndex:1,showUnionTables:!1,showJoinTables:!1,keyColIndex:0,keyEntryIndex:0,tableHeader:l,tableData:n,optionsMap:r,keyColNeighbours:[],firstDegNeighbours:[],firstColSelection:[],firstColChecked:[],firstColFilled:!1,keyCheckedIndex:-1,otherColSelection:[],otherColChecked:[],otherCheckedIndex:-1,originTableArray:[],tableOpenList:[],selectedTableIndex:-1,selectedClassAnnotation:[],tableDataExplore:[],propertyNeighbours:[],semanticEnabled:"disabled",unionCutOff:.75,showFilter:!1,curFilterIndex:-1,dataAndChecked:[],showJoinModal:!1,joinTableIndex:-1,joinTableData:[],originColOptions:[],joinColOptions:[],originJoinIndex:-1,joinJoinIndex:-1},a.handleURLPaste=a.handleURLPaste.bind(Object(d.a)(a)),a.handleTablePaste=a.handleTablePaste.bind(Object(d.a)(a)),a.handleStartSubject=a.handleStartSubject.bind(Object(d.a)(a)),a.handleStartTable=a.handleStartTable.bind(Object(d.a)(a)),a.cellChange=a.cellChange.bind(Object(d.a)(a)),a.selectColHeader=a.selectColHeader.bind(Object(d.a)(a)),a.getKeyOptions=a.getKeyOptions.bind(Object(d.a)(a)),a.getOtherOptions=a.getOtherOptions.bind(Object(d.a)(a)),a.getNeighbourPromise=a.getNeighbourPromise.bind(Object(d.a)(a)),a.populateKeyColumn=a.populateKeyColumn.bind(Object(d.a)(a)),a.getOtherColPromise=a.getOtherColPromise.bind(Object(d.a)(a)),a.populateOtherColumn=a.populateOtherColumn.bind(Object(d.a)(a)),a.addAllNeighbour=a.addAllNeighbour.bind(Object(d.a)(a)),a.getTableStates=a.getTableStates.bind(Object(d.a)(a)),a.sameNeighbourDiffCol=a.sameNeighbourDiffCol.bind(Object(d.a)(a)),a.sameNeighbourOneCol=a.sameNeighbourOneCol.bind(Object(d.a)(a)),a.populateRecommendation=a.populateRecommendation.bind(Object(d.a)(a)),a.contextAddColumn=a.contextAddColumn.bind(Object(d.a)(a)),a.contextDeleteColumn=a.contextDeleteColumn.bind(Object(d.a)(a)),a.contextSetColumn=a.contextSetColumn.bind(Object(d.a)(a)),a.contextCellOrigin=a.contextCellOrigin.bind(Object(d.a)(a)),a.contextCellPreview=a.contextCellPreview.bind(Object(d.a)(a)),a.contextOpenLink=a.contextOpenLink.bind(Object(d.a)(a)),a.contextSortColumn=a.contextSortColumn.bind(Object(d.a)(a)),a.toggleTable=a.toggleTable.bind(Object(d.a)(a)),a.togglePropertyNeighbours=a.togglePropertyNeighbours.bind(Object(d.a)(a)),a.toggleSibling=a.toggleSibling.bind(Object(d.a)(a)),a.toggleOtherTable=a.toggleOtherTable.bind(Object(d.a)(a)),a.unionTable=a.unionTable.bind(Object(d.a)(a)),a.unionPage=a.unionPage.bind(Object(d.a)(a)),a.unionProperty=a.unionProperty.bind(Object(d.a)(a)),a.toggleSemantic=a.toggleSemantic.bind(Object(d.a)(a)),a.unionCutOffChange=a.unionCutOffChange.bind(Object(d.a)(a)),a.copyTable=a.copyTable.bind(Object(d.a)(a)),a.toggleWikiPage=a.toggleWikiPage.bind(Object(d.a)(a)),a.undoPreviousStep=a.undoPreviousStep.bind(Object(d.a)(a)),a.handleTabSwitch=a.handleTabSwitch.bind(Object(d.a)(a)),a.openModal=a.openModal.bind(Object(d.a)(a)),a.closeModal=a.closeModal.bind(Object(d.a)(a)),a.toggleTableSelection=a.toggleTableSelection.bind(Object(d.a)(a)),a.toggleUnionJoin=a.toggleUnionJoin.bind(Object(d.a)(a)),a.openFilter=a.openFilter.bind(Object(d.a)(a)),a.cancelFilter=a.cancelFilter.bind(Object(d.a)(a)),a.toggleChecked=a.toggleChecked.bind(Object(d.a)(a)),a.applyFilter=a.applyFilter.bind(Object(d.a)(a)),a.handleJoinTable=a.handleJoinTable.bind(Object(d.a)(a)),a.cancelJoin=a.cancelJoin.bind(Object(d.a)(a)),a.selectJoinColumn=a.selectJoinColumn.bind(Object(d.a)(a)),a.runJoin=a.runJoin.bind(Object(d.a)(a)),a.toggleFirstNeighbour=a.toggleFirstNeighbour.bind(Object(d.a)(a)),a.handlePlusClick=a.handlePlusClick.bind(Object(d.a)(a)),a.addToFirstCol=a.addToFirstCol.bind(Object(d.a)(a)),a.confirmAddFirstCol=a.confirmAddFirstCol.bind(Object(d.a)(a)),a.toggleOtherNeighbour=a.toggleOtherNeighbour.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"handleURLPaste",value:function(e){var t=this;if(document.body.classList.add("waiting"),e.includes("https://en.wikipedia.org/wiki/")){var a=[];a.push(z(e)),Y(a).then((function(a){for(var n=a[0],l=(new DOMParser).parseFromString(n,"text/html").getElementsByClassName("wikitable"),r=[],o=0;o<l.length;++o)r.push(!1);document.body.classList.remove("waiting");t.setState({originTableArray:l,tableOpenList:r,urlPasted:e,iframeURL:e,lastAction:"handleURLPaste",prevState:{urlPasted:"",iframeURL:"",originTableArray:[],tableOpenList:[]}})}))}else alert("Please paste a valid Wikipedia link.")}},{key:"handleTablePaste",value:function(e){this.setState({tablePasted:e})}},{key:"copyTable",value:function(){var e=document.createElement("textarea"),t="";if("startSubject"===this.state.usecaseSelected||"startTable"===this.state.usecaseSelected){for(var a=this.state.tableHeader,n=0;n<a.length;++n){var l=a[n].label;if(void 0===l&&a[n].length>0){l="";for(var r=0;r<a[n].length;++r)r>0&&(l+=0===n?" AND ":" OR "),l+=he(a[n][r].label)}void 0!==l&&""!==l&&(t=t+l+"\t")}t+="\n";for(var o=this.state.tableData,i=o.length,s=o[0].length,c=0;c<i;++c){for(var u=0;u<s;++u){var p=he(o[c][u].data);void 0!==p&&""!==p&&(t=t+p+"\t")}t+="\n"}}e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),alert("Table content has been pasted!")}},{key:"toggleWikiPage",value:function(){var e=this.state.pageHidden;this.setState({pageHidden:!e})}},{key:"handleStartSubject",value:function(e,t){var a=this;if("startSubject"===t){document.body.classList.add("waiting");var n=decodeURIComponent(this.state.urlPasted.slice(30)),l=G.a.cloneDeep(this.state.tableData);l[0][0].data=n;Y([$("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("select+%3Fp+%3Fo%0D%0Awhere+%7B%0D%0Adbr%3A"+Z(n)+"+%3Fp+%3Fo.%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+")]).then((function(e){for(var n=function(e){for(var t=e.filter((function(e){return e.p.value.slice(28).length>1&&(e.p.value.includes("ontology")||e.p.value.includes("property")||e.p.value.includes("dc/terms/subject"))&&!(e.p.value.includes("wikiPage")||e.p.value.includes("align")||e.p.value.includes("abstract")||e.p.value.includes("caption")||e.p.value.includes("image")||e.p.value.includes("width")||e.p.value.includes("thumbnail")||e.p.value.includes("blank")||e.p.value.includes("fec")||e.p.value.includes("viaf")||e.p.value.includes("soundRecording")||e.p.value.includes("votesmart")||e.p.value.includes("wordnet")||e.p.value.includes("float")||e.p.value.includes("bbr")||"http://dbpedia.org/property/alt"===e.p.value||"http://dbpedia.org/property/by"===e.p.value||"http://dbpedia.org/property/onlinebooks"===e.p.value||"http://dbpedia.org/property/signature"===e.p.value||"http://dbpedia.org/property/video"===e.p.value||"http://dbpedia.org/property/logo"===e.p.value)})),a=[],n=[],l=0;l<t.length;++l)"http://purl.org/dc/terms/subject"===t[l].p.value?a.push(t[l]):n.push(t[l]);a.sort((function(e,t){return e.o.value.slice(37)<t.o.value.slice(37)?-1:1})),n.sort((function(e,t){return e.p.value.slice(28)<t.p.value.slice(28)?-1:1})),n[0].p.count=ve(n[0].p.value,n);for(var r=1;r<n.length;++r){var o=n[r-1],i=n[r];o.p.value===i.p.value?i.p.count=o.p.count:i.p.count=ve(n[r].p.value,n)}n.sort((function(e,t){return void 0===e.o.datatype&&void 0!==t.o.datatype?-1:void 0===t.o.datatype&&void 0!==e.o.datatype?1:e.p.count===t.p.count?e.p.value.slice(28)<t.p.value.slice(28)?-1:1:e.p.count<t.p.count?-1:1})),t=a.concat(n);for(var s=[],c=0;c<t.length;++c)"http://purl.org/dc/terms/subject"===t[c].p.value?s.push({pValue:"category",pDataset:"dct",oValue:t[c].o.value.slice(37),oType:"",value:"category",label:t[c].o.value.slice(37)}):s.push({pValue:t[c].p.value.slice(28),pDataset:t[c].p.value.includes("property")?"dbp":"dbo",oValue:te(t[c].o.value),oType:void 0===t[c].o.datatype?"":t[c].o.datatype,value:t[c].p.value.slice(28),label:t[c].p.value.slice(28)+":"+te(t[c].o.value)});return s}(e[0].results.bindings),r=[],o=0;o<n.length;++o)r.push(!1);var i={usecaseSelected:a.state.usecaseSelected,tableData:a.state.tableData,tabIndex:a.state.tabIndex,curActionInfo:a.state.curActionInfo,firstColSelection:a.state.firstColSelection,firstColChecked:a.state.firstColChecked};document.body.classList.remove("waiting"),a.setState({usecaseSelected:t,tableData:l,firstColSelection:n,firstColChecked:r,lastAction:"handleStartSubject",prevState:i,curActionInfo:{task:"afterStartSubject"},tabIndex:0})}))}}},{key:"toggleFirstNeighbour",value:function(e,t){var a=this.state.firstColChecked.slice(),n=t;a[t]=!a[t],this.setState({firstColChecked:a,keyCheckedIndex:n})}},{key:"toggleOtherNeighbour",value:function(e,t){var a=this.state.otherColChecked.slice(),n=t;a[t]=!a[t],this.setState({otherColChecked:a,otherCheckedIndex:n})}},{key:"handlePlusClick",value:function(){this.setState({curActionInfo:{task:"plusClicked"},tabIndex:0})}},{key:"addToFirstCol",value:function(){for(var e=[],t=0;t<this.state.firstColChecked.length;++t)e.push(!1);this.setState({firstColChecked:e,keyCheckedIndex:-1,curActionInfo:{task:"afterStartSubject"}})}},{key:"cellChange",value:function(e,t,a){e.preventDefault();var n=this.state.tableData.slice();n[t][a].data=e.target.value,this.setState({tableData:n})}},{key:"getKeyOptions",value:function(e,t){var a=this;if(t===this.state.keyColIndex){for(var n=[],l=0;l<this.state.tableData.length&&""!==this.state.tableData[l][t].data;++l)n.push(Z(this.state.tableData[l][t].data));for(var r="SELECT+%3Fsomevar%0D%0AWHERE+%7B",o=0;o<n.length;++o)r+="%0D%0A++++++++dbr%3A"+n[o]+"+%28dct%3Asubject%7Crdf%3Atype%29+%3Fsomevar.";var i="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+r+"%0D%0A%7D%0D%0A&format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+",s=[];s.push($(i)),Y(s).then((function(e){for(var t=e[0],n=[],l=0;l<t.results.bindings.length;++l){var r=t.results.bindings[l].somevar.value;if(r.includes("dbpedia.org/resource/Category:")){var o={},i=r.slice(37);o.label=i,o.value=i,o.dataset="dct",n.push(o)}else if(r.includes("dbpedia.org/ontology/")&&!r.includes("Wikidata")){var s={},c=r.slice(28);s.label=c,s.value=c,s.dataset="rdf",n.push(s)}}var u=a.state.optionsMap.slice();u[a.state.keyColIndex]=n,a.setState({optionsMap:u})}))}}},{key:"getOtherOptions",value:function(e,t){for(var a=this,n=[],l=!0,r=!0,o=[],i=0;i<this.state.tableData.length;++i)""!==this.state.tableData[i][t].data?(l=!1,o.push([i,this.state.tableData[i][t].data])):r=!1;if(!1===l&&!1===r){for(var s="SELECT+%3Fsomevar%0D%0AWHERE+%7B",c=0;c<o.length;++c){s+="%0D%0A++++++++dbr%3A"+Z(this.state.tableData[o[c][0]][this.state.keyColIndex].data)+"+%3Fsomevar+dbr%3A"+Z(o[c][1])+"."}var u="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+s+"%0D%0A%7D%0D%0A%0D%0A&format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+",p=[];p.push($(u)),Y(p).then((function(e){for(var l=e[0],r=0;r<l.results.bindings.length;++r){var o={},i=l.results.bindings[r].somevar.value.slice(28);o.label=i,o.value=i,o.type="subject",n.push(o)}0===n.length&&(n=a.state.keyColNeighbours);for(var s=[],c=0;c<n.length;++c)s.push(!1);var u={task:"showOtherColSelection",colIndex:t};a.setState({otherColSelection:n,otherColChecked:s,otherCheckedIndex:-1,curActionInfo:u})}))}else{n=this.state.keyColNeighbours;for(var h=[],d=0;d<n.length;++d)h.push(!1);var b={task:"showOtherColSelection",colIndex:t};this.setState({otherColSelection:n,otherColChecked:h,otherCheckedIndex:-1,curActionInfo:b})}}},{key:"selectColHeader",value:function(e,t){var a=this.state.tableHeader.slice();if(null!==e){var n=G.a.cloneDeep(e);if(a[t]=n,t===this.state.keyColIndex){var l={task:"populateKeyColumn"};l.colIndex=t,l.neighbourArray=[];for(var r=0;r<n.length;++r)l.neighbourArray.push(n[r]);this.setState({tableHeader:a,curActionInfo:l})}else{for(var o="",i=0;i<a[this.state.keyColIndex].length;++i){o+=i>0?"&"+a[this.state.keyColIndex][i].label:a[this.state.keyColIndex][i].label}for(var s=0;s<n.length;++s){var c="subject"===a[t][s].type?a[t][s].value:"is "+a[t][s].value+" of";a[t][s].label=c+"--"+o}var u={task:"populateOtherColumn"};u.colIndex=t,u.neighbourArray=[];for(var p=0;p<n.length;++p)u.neighbourArray.push(n[p]);this.setState({tableHeader:a,curActionInfo:u})}}}},{key:"getNeighbourPromise",value:function(e,t,a){for(var n=[],l=0;l<e.length;++l){var r="N/A"===e[l][a].data?"NONEXISTINGSTRING":Z(e[l][a].data),o=$("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("subject"===t?"select+%3Fp+%3Fo+%3Frange+%3FsubPropertyOf%0D%0Awhere+%7B%0D%0Adbr%3A"+r+"+%3Fp+%3Fo.%0D%0AOPTIONAL+%7B%3Fp+rdfs%3Arange+%3Frange%7D.%0D%0AOPTIONAL+%7B%3Fp+rdfs%3AsubPropertyOf+%3FsubPropertyOf%7D.%0D%0A%7D&":"select+%3Fs+%3Fp+%3Frange+%3FsubPropertyOf%0D%0Awhere+%7B%0D%0A%3Fs+%3Fp+dbr%3A"+r+".%0D%0AOPTIONAL+%7B%3Fp+rdfs%3Arange+%3Frange%7D.%0D%0AOPTIONAL+%7B%3Fp+rdfs%3AsubPropertyOf+%3FsubPropertyOf%7D.%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");n.push(o)}return n}},{key:"populateKeyColumn",value:function(e,t,a){var n=this,l=Ce(a);"ERROR"===l?alert("Unsupported datatype in selected neighbours. Please select some other neighbours."):(document.body.classList.add("waiting"),Y([$(l)]).then((function(e){var l=G.a.cloneDeep(n.state.tableHeader);l[0]=a;var r=G.a.cloneDeep(n.state.tableData);0===n.state.tableHeader[0].length&&(r=function(e,t,a,n){var l=Math.min(e.length,10);if(t.length>l)t=t.slice(0,l);else if(t.length<l)for(var r=l-t.length,o=0;o<r;++o){for(var i=[],s=0;s<4;++s)i.push({data:"",origin:[]});t.push(i)}for(var c=t.length,u=c,p=0;p<c&&""!==t[p][n].data;++p)u--;for(var h=c-u,d=0;d<u;++d)t[d+h][n].data=e[d].somevar.value.slice(28);for(var b=0;b<c;++b){var g=t[b][n].data;t[b][n].origin.push(g)}return t=G.a.uniqBy(t,(function(e){return e[0].data}))}(e[0].results.bindings,r,0,t));var o=n.getNeighbourPromise(r,"subject",t),i=n.getNeighbourPromise(r,"object",t);Y(o).then((function(e){Y(i).then((function(a){var o=ye(e,a),i=o.keyColNeighbours,s=o.firstDegNeighbours,c={keyColIndex:n.state.keyColIndex,keyColNeighbours:n.state.keyColNeighbours,firstDegNeighbours:n.state.firstDegNeighbours,curActionInfo:n.state.curActionInfo,tableData:n.state.tableData,tableHeader:n.state.tableHeader,firstColFilled:n.state.firstColFilled};document.body.classList.remove("waiting"),n.setState({keyColIndex:t,keyColNeighbours:i,firstDegNeighbours:s,curActionInfo:{task:"afterPopulateColumn"},tableData:r,tableHeader:l,firstColFilled:!0,lastAction:"populateKeyColumn",prevState:c})}))}))})))}},{key:"confirmAddFirstCol",value:function(e,t){var a=this,n=Ce(t);"ERROR"===n?alert("Unsupported datatype in selected neighbours. Please select some other neighbours."):(document.body.classList.add("waiting"),Y([$(n)]).then((function(e){for(var t=Math.min(e[0].results.bindings.length,10),n=[],l=0;l<t;++l){for(var r=[],o=0;o<a.state.tableHeader.length;++o)0===o?r.push({data:e[0].results.bindings[l].somevar.value.slice(28),origin:[e[0].results.bindings[l].somevar.value.slice(28)]}):r.push({data:"",origin:[]});n.push(r)}n=G.a.cloneDeep(a.state.tableData).concat(n),n=G.a.uniqBy(n,(function(e){return e[0].data}));var i=a.getNeighbourPromise(n,"subject",0),s=a.getNeighbourPromise(n,"object",0);Y(i).then((function(e){Y(s).then((function(t){var l=ye(e,t),r=l.keyColNeighbours,o=l.firstDegNeighbours;document.body.classList.remove("waiting"),a.setState({keyColNeighbours:r,firstDegNeighbours:o,curActionInfo:{task:"afterPopulateColumn"},tableData:n})}))}))})))}},{key:"getOtherColPromise",value:function(e,t){for(var a=[],n=0;n<this.state.tableData.length;++n){var l=Z(this.state.tableData[n][this.state.keyColIndex].data);"N/A"===l&&(l="NONEXISTINGSTRING");var r=$("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("subject"===t?"SELECT+%3Fsomevar%0D%0AWHERE+%7B%0D%0A++++++++dbr%3A"+l+"+%28dbo%3A"+Z(e)+"%7Cdbp%3A"+Z(e)+"%29+%3Fsomevar.%0D%0A%7D%0D%0A%0D%0A&":"SELECT+%3Fsomevar+%0D%0AWHERE+%7B%0D%0A++++++++%3Fsomevar+%28dbo%3A"+Z(e)+"%7Cdbp%3A"+Z(e)+"%29+dbr%3A"+l+"%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");a.push(r)}return a}},{key:"populateOtherColumn",value:function(e,t,a){for(var n=G.a.cloneDeep(this.state.tableData),l=[],r=0;r<n.length;++r){for(var o=[],i=0;i<a.length;++i){var s=a[i],c=("subject"===s.type?this.state.firstDegNeighbours.subject:this.state.firstDegNeighbours.object)[r][s.value];void 0!==c&&(o=o.concat(c))}if(0===o.length)n[r][t].data="N/A";else{n[r][t].data=o[0];var u=ge(a)+":"+o[0],p=n[r][this.state.keyColIndex].origin.slice();p.push(u),n[r][t].origin=p,o.length>l.length&&(l=o)}}var h=G.a.cloneDeep(this.state.tableHeader);h[t]=a;var d=Math.min(l.length,50)-1,b=me(a),g={};d>0?(g.task="populateSameNeighbour",g.colIndex=t,g.neighbourArray=a,g.numCols=d):b.length>0?(g.task="populateRecommendation",g.colIndex=t,g.recommendArray=b):g.task="afterPopulateColumn";var f={curActionInfo:this.state.curActionInfo,tableData:this.state.tableData,tableHeader:this.state.tableHeader};this.setState({curActionInfo:g,tableData:n,tableHeader:h,lastAction:"populateOtherColumn",prevState:f})}},{key:"addAllNeighbour",value:function(e,t,a,n,l,r,o,i,s){var c=r.length,u=r[0].length,p=n;e<n&&(p+=a);for(var h=[],d=0;d<c;++d){for(var b=[],g=0;g<e+1;++g)b.push(r[d][g]);for(var f=0;f<a;++f)b.push({data:"",origin:[]});for(var m=e+1;m<u;++m)b.push(r[d][m]);h.push(b)}for(var v,C=[],y=0;y<e+1;++y)C.push(l[y]);if(!1===s)v=l[e];else{for(var k="",E=0;E<l[n].length;++E){k+=E>0?"&"+l[n][E].label:l[n][E].label}var A="subject"===t[0].type?t[0].value:"is "+t[0].value+" of";v=[{value:t[0].value,label:A+"--"+k,type:t[0].type}]}for(var N=0;N<a;++N)C.push(v);for(var O=e+1;O<u;++O)C.push(l[O]);for(var S=[],D=0;D<e;++D)S.push(i[D]);for(var I=0;I<a;++I)S.push([]);for(var x=e;x<u-1;++x)S.push(i[x]);for(var j=[],w=0;w<e+1;++w)j.push(o[w]);for(var F=0;F<a;++F)j.push([]);for(var T=e+1;T<u;++T)j.push(o[T]);for(var P=0;P<r.length;++P){for(var L=[],M=0;M<t.length;++M){var H=t[M],R=("subject"===H.type?this.state.firstDegNeighbours.subject:this.state.firstDegNeighbours.object)[P][H.value];void 0!==R&&(L=L.concat(R))}for(var _=e+1;_<e+1+a;++_){var J=!0===s?_-e:_-e+1;if(L.length<J)h[P][_].data="N/A";else{var U=L[J-1];h[P][_].data=U;var B=ge(t)+":"+U,q=h[P][p].origin.slice();q.push(B),h[P][_].origin=q}}}return{tableHeader:C,tableData:h,optionsMap:j,selectedClassAnnotation:S,keyColIndex:p}}},{key:"sameNeighbourDiffCol",value:function(e,t,a,n){var l=this.addAllNeighbour(t,a,n,this.state.keyColIndex,this.state.tableHeader,this.state.tableData,this.state.optionsMap,this.state.selectedClassAnnotation,!1),r={},o=me(a);o.length>0?(r.task="populateRecommendation",r.colIndex=t+n,r.recommendArray=o):r.task="afterPopulateColumn";var i={curActionInfo:this.state.curActionInfo,tableData:this.state.tableData,tableHeader:this.state.tableHeader,optionsMap:this.state.optionsMap,selectedClassAnnotation:this.state.selectedClassAnnotation,keyColIndex:this.state.keyColIndex};this.setState({curActionInfo:r,tableData:l.tableData,tableHeader:l.tableHeader,optionsMap:l.optionsMap,selectedClassAnnotation:l.selectedClassAnnotation,keyColIndex:l.keyColIndex,lastAction:"sameNeighbourDiffCol",prevState:i})}},{key:"sameNeighbourOneCol",value:function(e,t,a){for(var n=G.a.cloneDeep(this.state.tableData),l=0;l<n.length;++l){for(var r=[],o=0;o<a.length;++o){var i=a[o],s=("subject"===i.type?this.state.firstDegNeighbours.subject:this.state.firstDegNeighbours.object)[l][i.value];void 0!==s&&(r=r.concat(s))}if(0===r.length)n[l][t].data="N/A";else{for(var c="",u=0;u<r.length;++u){c+=u>0?";"+r[u]:r[u]}n[l][t].data=c;var p=ge(a)+":"+c,h=n[l][this.state.keyColIndex].origin.slice();h.push(p),n[l][t].origin=h}}var d={},b=me(a);b.length>0?(d.task="populateRecommendation",d.colIndex=t,d.recommendArray=b):d.task="afterPopulateColumn";var g={curActionInfo:this.state.curActionInfo,tableData:this.state.tableData};this.setState({curActionInfo:d,tableData:n,lastAction:"sameNeighbourOneCol",prevState:g})}},{key:"populateRecommendation",value:function(e,t,a){console.log(t),console.log(a);for(var n=0,l="subject"===a[0].type?this.state.firstDegNeighbours.subject:this.state.firstDegNeighbours.object,r=0;r<l.length;++r){var o=l[r][a[0].value];void 0!==o&&o.length>n&&(n=o.length)}var i=this.addAllNeighbour(t,a,n,this.state.keyColIndex,this.state.tableHeader,this.state.tableData,this.state.optionsMap,this.state.selectedClassAnnotation,!0),s=G.a.cloneDeep(this.state.curActionInfo);s.colIndex+=n;var c={tableData:this.state.tableData,tableHeader:this.state.tableHeader,optionsMap:this.state.optionsMap,selectedClassAnnotation:this.state.selectedClassAnnotation,keyColIndex:this.state.keyColIndex,curActionInfo:this.state.curActionInfo};this.setState({tableData:i.tableData,tableHeader:i.tableHeader,optionsMap:i.optionsMap,selectedClassAnnotation:i.selectedClassAnnotation,keyColIndex:i.keyColIndex,curActionInfo:s,lastAction:"populateRecommendation",prevState:c})}},{key:"contextAddColumn",value:function(e,t){for(var a=this.state.tableData.length,n=this.state.tableData[0].length,l=[],r=0;r<a;++r){for(var o=[],i=0;i<t+1;++i)o.push(this.state.tableData[r][i]);o.push({data:"",origin:[]});for(var s=t+1;s<n;++s)o.push(this.state.tableData[r][s]);l.push(o)}for(var c=[],u=[],p=0;p<t+1;++p)c.push(this.state.optionsMap[p]),u.push(this.state.tableHeader[p]);c.push(this.state.keyColNeighbours),u.push("");for(var h=t+1;h<n;++h)c.push(this.state.optionsMap[h]),u.push(this.state.tableHeader[h]);for(var d=[],b=0;b<t;++b)d.push(this.state.selectedClassAnnotation[b]);d.push([]);for(var g=t;g<n-1;++g)d.push(this.state.selectedClassAnnotation[g]);var f=this.state.keyColIndex;t<f&&++f;var m={tableData:this.state.tableData,tableHeader:this.state.tableHeader,curActionInfo:this.state.curActionInfo,optionsMap:this.state.optionsMap,keyColIndex:this.state.keyColIndex,selectedClassAnnotation:this.state.selectedClassAnnotation,tabIndex:this.state.tabIndex};this.setState({tableData:l,tableHeader:u,curActionInfo:{task:"afterPopulateColumn"},optionsMap:c,keyColIndex:f,selectedClassAnnotation:d,tabIndex:0,lastAction:"contextAddColumn",prevState:m})}},{key:"contextDeleteColumn",value:function(e,t){if(t===this.state.keyColIndex)alert("The current column is the search column.\n\nPlease set another search column before deleting the current column.");else if(0===t)alert("Deleting the first column causes unexpected behavior.\n\nPlease do not delete the first column.");else{for(var a=G.a.cloneDeep(this.state.tableData),n=this.state.tableHeader.slice(),l=this.state.optionsMap.slice(),r=this.state.selectedClassAnnotation.slice(),o=0;o<a.length;++o)a[o].splice(t,1);n.splice(t,1),l.splice(t,1),t>0&&r.splice(t-1,1);var i=this.state.keyColIndex;t<i&&--i;var s=G.a.cloneDeep(this.state.propertyNeighbours);if(1===this.state.tabIndex)for(var c=0;c<s.length;++c)s[c].isOpen=!1;var u={tableData:this.state.tableData,tableHeader:this.state.tableHeader,optionsMap:this.state.optionsMap,selectedClassAnnotation:this.state.selectedClassAnnotation,keyColIndex:this.state.keyColIndex,propertyNeighbours:this.state.propertyNeighbours,curActionInfo:this.state.curActionInfo};this.setState({tableData:a,tableHeader:n,optionsMap:l,selectedClassAnnotation:r,keyColIndex:i,propertyNeighbours:s,curActionInfo:{task:"afterPopulateColumn"},lastAction:"contextDeleteColumn",prevState:u})}}},{key:"contextSortColumn",value:function(e,t,a){for(var n=G.a.cloneDeep(this.state.tableData),l=!0,r=0;r<n.length;++r)if("N/A"!==n[r][t].data&&isNaN(Number(n[r][t].data))){l=!1;break}var o,i=n[this.state.keyEntryIndex].slice();l?n.sort((function(e,n){var l=e[t].data,r=n[t].data;return"N/A"===l?1:"N/A"===r?-1:"ascending"===a?Number(l)-Number(r):Number(r)-Number(l)})):n.sort((function(e,n){var l=e[t].data,r=n[t].data;return"N/A"===l?1:"N/A"===r?-1:"ascending"===a?l<r?-1:1:l<r?1:-1}));for(var s=0;s<n.length;++s){for(var c=!0,u=0;u<i.length;++u)if(i[u].data!==n[s][u].data){c=!1;break}if(!0===c){o=s;break}}var p={tableData:this.state.tableData,keyEntryIndex:this.state.keyEntryIndex,curActionInfo:this.state.curActionInfo};this.setState({tableData:n,keyEntryIndex:o,curActionInfo:{task:"afterPopulateColumn"},lastAction:"contextSortColumn",prevState:p})}},{key:"contextSetColumn",value:function(e,t){var a=this;document.body.classList.add("waiting");var n=G.a.cloneDeep(this.state.tableData),l=this.getNeighbourPromise(n,"subject",t),r=this.getNeighbourPromise(n,"object",t);Y(l).then((function(e){Y(r).then((function(n){var l=ye(e,n),r=l.keyColNeighbours,o=l.firstDegNeighbours;document.body.classList.remove("waiting");var i={keyColIndex:a.state.keyColIndex,keyColNeighbours:a.state.keyColNeighbours,firstDegNeighbours:a.state.firstDegNeighbours,curActionInfo:a.state.curActionInfo,tabIndex:a.state.tabIndex};a.setState({keyColIndex:t,keyColNeighbours:r,firstDegNeighbours:o,curActionInfo:{task:"afterPopulateColumn"},tabIndex:0,lastAction:"contextSetColumn",prevState:i})}))}))}},{key:"contextCellOrigin",value:function(e,t,a){for(var n=this.state.tableData[t][a],r=[],o=0;o<n.origin.length;++o)r.push(l.a.createElement("p",null,he(n.origin[o])));var i={task:"contextCellOrigin"};i.origin=r;var s={curActionInfo:this.state.curActionInfo,tabIndex:this.state.tabIndex};this.setState({curActionInfo:i,tabIndex:0,lastAction:"contextCellOrigin",prevState:s})}},{key:"contextCellPreview",value:function(e,t,a){var n=this;document.body.classList.add("waiting");var l=[],r=$("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("select+%3Fp+%3Fvalue%0D%0Awhere+%7B%0D%0Adbr%3A"+Z(this.state.tableData[t][a].data)+"+%3Fp+%3Fvalue.%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");l.push(r);var o=$("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("select+%3Fp+%3Fvalue%0D%0Awhere+%7B%0D%0A%3Fvalue+%3Fp+dbr%3A"+Z(this.state.tableData[t][a].data)+".%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");l.push(o),Y(l).then((function(e){var l=ne(e[0].results.bindings,"subject"),r=ne(e[1].results.bindings,"object"),o=l.concat(r),i={task:"contextCellPreview"};i.cellValue=n.state.tableData[t][a].data,i.preview=o,document.body.classList.remove("waiting");var s={curActionInfo:n.state.curActionInfo,tabIndex:n.state.tabIndex};n.setState({curActionInfo:i,tabIndex:0,lastAction:"contextCellPreview",prevState:s})}))}},{key:"contextOpenLink",value:function(e,t,a){var n="https://en.wikipedia.org/wiki/"+this.state.tableData[t][a].data;this.setState({pageHidden:!1,iframeURL:n})}},{key:"toggleTable",value:function(e,t){var a=this.state.tableOpenList.slice();a[t]=!a[t];for(var n=0;n<a.length;++n)n!==t&&(a[n]=!1);!0===a[t]?this.setState({tableOpenList:a,curActionInfo:{task:"selectTableIndex",tableIndex:t}}):this.setState({tableOpenList:a,curActionInfo:null})}},{key:"getTableStates",value:function(e,t){for(var a=-1,n=0;n<t.length;++n)if(t[n].length>0&&(1!==t[n].length||"Number"!==t[n][0])&&(1!==t[n].length||"originURL"!==t[n][0])){a=n+1;break}-1===a&&(a=0);for(var l=[],r=0;r<e[0].length;++r)l.push([{value:e[0][r].data,label:e[0][r].data}]);for(var o=[],i=1;i<e.length;++i){for(var s=[],c=0;c<e[i].length;++c){var u=e[i][c].data,p=[],h=e[i][c].origin+": "+l[c][0].value+": "+e[i][c].data;p.push(h),s.push({data:u,origin:p})}o.push(s)}var d=this.getNeighbourPromise(o,"subject",a),b=this.getNeighbourPromise(o,"object",a);return Y(d).then((function(e){return Y(b).then((function(t){var n=ye(e,t),r=n.keyColNeighbours,i=n.firstDegNeighbours;return Promise.resolve({keyColIndex:a,tableHeader:l,tableData:o,keyColNeighbours:r,firstDegNeighbours:i})}))}))}},{key:"handleStartTable",value:function(e,t){var a=this;document.body.classList.add("waiting");var n=[],l=$("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%3Fo%0D%0AWHERE+%7B%0D%0A++++++dbr%3A"+ee(this.state.urlPasted.slice(30))+"+%3Fp+%3Fo.%0D%0A++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A++++++FILTER%28isIRI%28%3Fo%29+%26%26+regex%28%3FpString%2C%22property%22%2C%22i%22%29+%26%26+%28%21regex%28%3FpString%2C%22text%22%2C%22i%22%29%29%29.%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");n.push(l);var r=$("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fo%0D%0AWHERE+%7B%0D%0A++++++dbr%3A"+ee(this.state.urlPasted.slice(30))+"+dct%3Asubject+%3Fo%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");n.push(r),n.push(se(this.state.originTableArray[t])),Y(n).then((function(e){var n=e[2];console.log(n);var l=[],r=[],o=[];o=e[0].results.bindings;for(var i=0;i<o.length;++i){var s=o[i].p.value.slice(28),c=o[i].o.value.slice(28);c.includes("/")&&(c="NONEXISTING");var u=$("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fs+%0D%0AWHERE+%7B%0D%0A%09%3Fs+dbp%3A"+Z(s)+"+dbr%3A"+Z(c)+"%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");l.push({predicate:s,object:c}),r.push(u)}o=e[1].results.bindings;for(var p=0;p<o.length;++p){var h=o[p].o.value.slice(37),d=$("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fs%0D%0AWHERE+%7B%0D%0A++++++%3Fs+dct%3Asubject+dbc%3A"+Z(h)+"%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");l.push({predicate:"subject",object:h}),r.push(d)}Y(r).then((function(e){for(var r=[],o=decodeURIComponent(a.state.urlPasted.slice(30)),i=0;i<e.length;++i){var s=e[i].results.bindings;if(s.length>1&&s.length<150){for(var c=[],u=0;u<s.length;++u){var p=s[u].s.value.slice(28);c.push({isOpen:!1,name:p,tableArray:[]})}r.push({predicate:l[i].predicate,object:l[i].object,isOpen:!1,siblingArray:c})}}r.sort((function(e,t){return e.siblingArray.length<t.siblingArray.length?1:-1}));var h={task:"showPropertyNeighbours"},d=ce(a.state.originTableArray[t],o);Y([a.getTableStates(d,n)]).then((function(e){var l=e[0];document.body.classList.remove("waiting");var o={firstColFilled:a.state.firstColFilled,selectedTableIndex:a.state.selectedTableIndex,propertyNeighbours:a.state.propertyNeighbours,curActionInfo:a.state.curActionInfo,selectedClassAnnotation:a.state.selectedClassAnnotation,keyColIndex:a.state.keyColIndex,keyColNeighbours:a.state.keyColNeighbours,firstDegNeighbours:a.state.firstDegNeighbours,tableData:a.state.tableData,tableHeader:a.state.tableHeader,usecaseSelected:a.state.usecaseSelected,tabIndex:a.state.tabIndex};a.setState({firstColFilled:!0,selectedTableIndex:t,propertyNeighbours:r,curActionInfo:h,selectedClassAnnotation:n,keyColIndex:l.keyColIndex,keyColNeighbours:l.keyColNeighbours,firstDegNeighbours:l.firstDegNeighbours,tableData:l.tableData,tableHeader:l.tableHeader,usecaseSelected:"startTable",tabIndex:1,lastAction:"handleStartTable",prevState:o})}))}))}))}},{key:"togglePropertyNeighbours",value:function(e,t){var a=this;document.body.classList.add("waiting");var n=this.state.propertyNeighbours.slice();if(n[t].isOpen=!n[t].isOpen,!0===n[t].isOpen){for(var l=n[t].siblingArray,r=[],o=[],i=[],s=0;s<l.length;++s){var c=l[s].name,u=z("https://en.wikipedia.org/wiki/"+c);i.push(u),o.push(c)}Y(i).then((function(e){for(var l=[],i=0;i<e.length;++i){var s=e[i];l.push(oe(a.state.tableHeader,s,a.state.selectedClassAnnotation,a.state.semanticEnabled,a.state.unionCutOff,o[i]))}Y(l).then((function(e){for(var l=0;l<e.length;++l)r.push({isOpen:!1,name:o[l],tableArray:e[l]});r.sort((function(e,t){var a=e.tableArray.length,n=t.tableArray.length,l=e.name,r=t.name;return a===n?l<r?-1:l>r?1:0:a>n?-1:1})),n[t].siblingArray=r,document.body.classList.remove("waiting"),a.setState({propertyNeighbours:n})}))}))}else document.body.classList.remove("waiting"),this.setState({propertyNeighbours:n})}},{key:"toggleSibling",value:function(e,t,a){var n=this.state.propertyNeighbours.slice(),l=n[t].siblingArray[a];if(0===l.tableArray.length){var r="https://en.wikipedia.org/wiki/"+l.name;this.setState({pageHidden:!1,iframeURL:r})}else if(l.isOpen=!l.isOpen,!0===l.isOpen){var o="https://en.wikipedia.org/wiki/"+l.name;n[t].isOpen=!0,this.setState({propertyNeighbours:n,iframeURL:o})}else this.setState({propertyNeighbours:n})}},{key:"toggleOtherTable",value:function(e,t,a,n){var l=this.state.propertyNeighbours.slice(),r=l[t].siblingArray[a].tableArray[n];r.isOpen=!r.isOpen,this.setState({propertyNeighbours:l})}},{key:"unionTable",value:function(e,t,a,n){var l=this;document.body.classList.add("waiting");var r=G.a.cloneDeep(this.state.tableData),o=ce(a,this.state.propertyNeighbours[e].siblingArray[t].name);o=ue(o);var i=n.slice();r=le(r,o,i);var s=this.getNeighbourPromise(r,"subject",this.state.keyColIndex),c=this.getNeighbourPromise(r,"object",this.state.keyColIndex);Y(s).then((function(e){Y(c).then((function(t){var a=ye(e,t),n=a.keyColNeighbours,o=a.firstDegNeighbours;document.body.classList.remove("waiting");var i={tableData:l.state.tableData,keyColNeighbours:l.state.keyColNeighbours,firstDegNeighbours:l.state.firstDegNeighbours};l.setState({tableData:r,keyColNeighbours:n,firstDegNeighbours:o,lastAction:"unionTable",prevState:i})}))}))}},{key:"unionPage",value:function(e,t){var a=this;document.body.classList.add("waiting");for(var n=G.a.cloneDeep(this.state.tableData),l=this.state.propertyNeighbours[e].siblingArray[t].tableArray,r=this.state.propertyNeighbours[e].siblingArray[t].name,o=0;o<l.length;++o){var i=ce(l[o].data,r),s=i[0];i=ue(i);var c=!1;if(r===decodeURIComponent(this.state.urlPasted.slice(30))&&s.length===n[0].length){for(var u=!1,p=0;p<s.length;++p)if(s[p].data!==this.state.tableHeader[p].value){u=!0;break}!1===u&&(c=!0)}var h=l[o].colMapping.slice();!1===c&&(n=le(n,i,h))}var d=this.getNeighbourPromise(n,"subject",this.state.keyColIndex),b=this.getNeighbourPromise(n,"object",this.state.keyColIndex);Y(d).then((function(e){Y(b).then((function(t){var l=ye(e,t),r=l.keyColNeighbours,o=l.firstDegNeighbours;document.body.classList.remove("waiting");var i={tableData:a.state.tableData,keyColNeighbours:a.state.keyColNeighbours,firstDegNeighbours:a.state.firstDegNeighbours};a.setState({tableData:n,keyColNeighbours:r,firstDegNeighbours:o,lastAction:"unionPage",prevState:i})}))}))}},{key:"unionProperty",value:function(e){for(var t=G.a.cloneDeep(this.state.tableData),a=this.state.propertyNeighbours[e].siblingArray,n=0;n<a.length;++n){var l=a[n].tableArray,r=a[n].name;if(0===l.length)break;for(var o=0;o<l.length;++o){var i=ce(l[o].data,r),s=i[0];i=ue(i);var c=!1;if(r===decodeURIComponent(this.state.urlPasted.slice(30))&&s.length===t[0].length){for(var u=!1,p=0;p<s.length;++p)if(s[p].data!==this.state.tableHeader[p].value){u=!0;break}!1===u&&(c=!0)}var h=l[o].colMapping.slice();!1===c&&(t=le(t,i,h))}}var d={tableData:this.state.tableData};this.setState({tableData:t,lastAction:"unionProperty",prevState:d})}},{key:"toggleSemantic",value:function(e){for(var t=this.state.propertyNeighbours.slice(),a=0;a<t.length;++a)t[a].isOpen=!1;this.setState({semanticEnabled:e.target.value,propertyNeighbours:t})}},{key:"unionCutOffChange",value:function(e){for(var t=this.state.propertyNeighbours.slice(),a=0;a<t.length;++a)t[a].isOpen=!1;this.setState({unionCutOff:e.target.value,propertyNeighbours:t})}},{key:"openFilter",value:function(e,t){for(var a=[],n=0;n<this.state.tableData.length;++n)a.push(this.state.tableData[n][t].data);(a=Object(h.a)(new Set(a))).sort((function(e,t){return"N/A"===e?-1:"N/A"===t?1:0}));for(var l=[],r=0;r<a.length;++r)l.push({data:a[r],checked:!0});this.setState({dataAndChecked:l,showFilter:!0,curFilterIndex:t})}},{key:"cancelFilter",value:function(e){this.setState({dataAndChecked:[],showFilter:!1,curFilterIndex:-1})}},{key:"toggleChecked",value:function(e,t){var a=this.state.dataAndChecked;a[t].checked=!a[t].checked,this.setState({dataAndChecked:a})}},{key:"applyFilter",value:function(e){for(var t=this,a=[],n=0;n<this.state.dataAndChecked.length;++n)!0===this.state.dataAndChecked[n].checked&&a.push(this.state.dataAndChecked[n].data);for(var l=G.a.cloneDeep(this.state.tableData),r=0;r<l.length;++r)a.includes(l[r][this.state.curFilterIndex].data)||(l.splice(r,1),--r);var o=this.getNeighbourPromise(l,"subject",this.state.keyColIndex),i=this.getNeighbourPromise(l,"object",this.state.keyColIndex);Y(o).then((function(e){Y(i).then((function(a){var n=ye(e,a),r=n.keyColNeighbours,o=n.firstDegNeighbours,i={tableData:t.state.tableData,curActionInfo:t.state.curActionInfo,keyColNeighbours:t.state.keyColNeighbours,firstDegNeighbours:t.state.firstDegNeighbours};t.setState({dataAndChecked:[],showFilter:!1,curFilterIndex:-1,tableData:l,keyColNeighbours:r,firstDegNeighbours:o,lastAction:"applyFilter",prevState:i})}))}))}},{key:"handleTabSwitch",value:function(e){if(1===e){for(var t=this.state.propertyNeighbours.slice(),a=0;a<t.length;++a)t[a].isOpen=!1;this.setState({propertyNeighbours:t,tabIndex:e})}else this.setState({tabIndex:e})}},{key:"undoPreviousStep",value:function(){var e=this.state.lastAction,t=this.state.prevState;"handleURLPaste"===e?this.setState({urlPasted:t.urlPasted,iframeURL:t.iframeURL,originTableArray:t.originTableArray,tableOpenList:t.tableOpenList}):"handleStartSubject"===e?this.setState({usecaseSelected:t.usecaseSelected,tableData:t.tableData,firstColSelection:t.firstColSelection,firstColChecked:t.firstColChecked,tabIndex:t.tabIndex,curActionInfo:t.curActionInfo,lastAction:""}):"handleStartTable"===e?this.setState({firstColFilled:t.firstColFilled,selectedTableIndex:t.selectedTableIndex,propertyNeighbours:t.propertyNeighbours,curActionInfo:t.curActionInfo,selectedClassAnnotation:t.selectedClassAnnotation,keyColIndex:t.keyColIndex,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,tableData:t.tableData,tableHeader:t.tableHeader,optionsMap:t.optionsMap,usecaseSelected:t.usecaseSelected,tabIndex:t.tabIndex,lastAction:""}):"populateKeyColumn"===e?this.setState({keyColIndex:t.keyColIndex,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,curActionInfo:t.curActionInfo,tableData:t.tableData,tableHeader:t.tableHeader,firstColFilled:t.firstColFilled,optionsMap:t.optionsMap,lastAction:""}):"populateOtherColumn"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,tableHeader:t.tableHeader,lastAction:""}):"sameNeighbourDiffCol"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,tableHeader:t.tableHeader,optionsMap:t.optionsMap,selectedClassAnnotation:t.selectedClassAnnotation,keyColIndex:t.keyColIndex,lastAction:""}):"sameNeighbourOneCol"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,lastAction:""}):"populateSameRange"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,tableHeader:t.tableHeader,optionsMap:t.optionsMap,selectedClassAnnotation:t.selectedClassAnnotation,keyColIndex:t.keyColIndex,lastAction:""}):"unionTable"===e||"unionPage"===e||"unionProperty"===e?this.setState({tableData:t.tableData,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,lastAction:""}):"contextAddColumn"===e?this.setState({tableData:t.tableData,tableHeader:t.tableHeader,curActionInfo:t.curActionInfo,optionsMap:t.optionsMap,keyColIndex:t.keyColIndex,selectedClassAnnotation:t.selectedClassAnnotation,tabIndex:t.tabIndex,lastAction:""}):"contextSetColumn"===e?this.setState({keyEntryIndex:t.keyEntryIndex,keyColIndex:t.keyColIndex,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,curActionInfo:t.curActionInfo,optionsMap:t.optionsMap,tabIndex:t.tabIndex,lastAction:""}):"contextCellOrigin"===e?this.setState({curActionInfo:t.curActionInfo,tabIndex:t.tabIndex,lastAction:""}):"contextCellPreview"===e?this.setState({curActionInfo:t.curActionInfo,tabIndex:t.tabIndex,lastAction:""}):"contextDeleteColumn"===e?this.setState({tableData:t.tableData,tableHeader:t.tableHeader,optionsMap:t.optionsMap,selectedClassAnnotation:t.selectedClassAnnotation,keyColIndex:t.keyColIndex,propertyNeighbours:t.propertyNeighbours,curActionInfo:t.curActionInfo,lastAction:""}):"contextSortColumn"===e?this.setState({tableData:t.tableData,keyEntryIndex:t.keyEntryIndex,curActionInfo:t.curActionInfo,lastAction:""}):"applyFilter"===e?this.setState({tableData:t.tableData,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,curActionInfo:t.curActionInfo,lastAction:""}):"runJoin"===e&&this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,tableHeader:t.tableHeader,optionsMap:t.optionsMap,selectedClassAnnotation:t.selectedClassAnnotation,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,lastAction:""})}},{key:"openModal",value:function(){this.setState({showSetting:!0})}},{key:"closeModal",value:function(){this.setState({showSetting:!1})}},{key:"toggleTableSelection",value:function(){var e=!this.state.showTableSelection;this.setState({showTableSelection:e})}},{key:"toggleUnionJoin",value:function(e,t){if("union"===t)this.setState({showUnionTables:!this.state.showUnionTables,showJoinTables:!1});else{for(var a=this.state.tableOpenList.slice(),n=0;n<a.length;++n)a[n]=!1;this.setState({showUnionTables:!1,showJoinTables:!this.state.showJoinTables,tableOpenList:a})}}},{key:"handleJoinTable",value:function(e,t){var a=G.a.cloneDeep(this.state.tableHeader),n=[],l=[];console.log(a);for(var r=0;r<a.length&&0!==a[r].length;++r){for(var o="",i=0;i<a[r].length;++i){o+=i>0?"&"+a[r][i].value:a[r][i].value}n.push({value:o,label:o,index:r})}console.log(n);for(var s=decodeURIComponent(this.state.urlPasted.slice(30)),c=ce(this.state.originTableArray[t],s),u=0;u<c[0].length;++u)l.push({value:c[0][u].data,label:c[0][u].data,index:u});this.setState({showJoinModal:!0,joinTableIndex:t,joinTableData:c,originColOptions:n,joinColOptions:l})}},{key:"cancelJoin",value:function(e){this.setState({showJoinModal:!1})}},{key:"selectJoinColumn",value:function(e,t){"originTable"===t?this.setState({originJoinIndex:e.index}):this.setState({joinJoinIndex:e.index})}},{key:"runJoin",value:function(e){for(var t=this,a=this.state.joinTableData.slice(),n=this.state.originJoinIndex,l=this.state.joinJoinIndex,r=this.state.tableHeader.slice(),o=this.state.optionsMap.slice(),i=this.state.selectedClassAnnotation.slice(),s=0;s<r.length;++s)""===r[s]&&(r.splice(s,1),--s);for(var c=0;c<a[0].length;++c)c!==l&&r.push([{value:a[0][c].data,label:a[0][c].data}]);for(var u=1;u<a[0].length;++u)o.push([]);Y([se(this.state.originTableArray[this.state.joinTableIndex])]).then((function(e){e[0].splice(0,0,[]);for(var s=0;s<e[0].length;++s)s!==l&&i.push(e[0][s]);console.log(i);for(var c=G.a.cloneDeep(t.state.tableData),u=[],p=[],h=0;h<a[0].length;++h)p.push({value:a[0][h].data,label:a[0][h].data});for(var d=[],b=1;b<a.length;++b){for(var g=[],f=0;f<a[b].length;++f){var m=a[b][f].data,v=[],C=a[b][f].origin+": "+p[f].value+": "+a[b][f].data;v.push(C),g.push({data:m,origin:v})}d.push(g)}for(var y=0;y<c.length;++y){var k=c[y][n].data;console.log("Current entry to join is "+k);for(var E=!1,A=0;A<d.length;++A)if(d[A][l].data===k){for(var N=G.a.cloneDeep(c[y]),O=0;O<d[A].length;++O)O!==l&&N.push(d[A][O]);u.push(N),E=!0}if(!1===E){for(var S=G.a.cloneDeep(c[y]),D=0;D<d[0].length;++D)D!==l&&S.push({data:"N/A",origin:[]});u.push(S)}}var I=t.getNeighbourPromise(u,"subject",t.state.keyColIndex),x=t.getNeighbourPromise(u,"object",t.state.keyColIndex);Y(I).then((function(e){Y(x).then((function(a){var n=ye(e,a),l=n.keyColNeighbours,s=n.firstDegNeighbours,c={curActionInfo:t.state.curActionInfo,tableData:t.state.tableData,keyColNeighbours:t.state.keyColNeighbours,firstDegNeighbours:t.state.firstDegNeighbours,tableHeader:t.state.tableHeader,optionsMap:t.state.optionsMap,selectedClassAnnotation:t.state.selectedClassAnnotation};t.setState({curActionInfo:{task:"afterPopulateColumn"},tableData:u,tableHeader:r,keyColNeighbours:l,firstDegNeighbours:s,optionsMap:o,selectedClassAnnotation:i,showJoinModal:!1,lastAction:"runJoin",prevState:c})}))}))}))}},{key:"render",value:function(){var e,t=" bottom-content",a="row top-content";return this.state.pageHidden&&(t=" bottom-content-hidden",a="row top-content-large"),e=""===this.state.urlPasted?l.a.createElement(I,{handleURLPaste:this.handleURLPaste}):l.a.createElement("div",null,l.a.createElement("div",{className:"header"},l.a.createElement(m,{copyTable:this.copyTable,undoPreviousStep:this.undoPreviousStep,openModal:this.openModal})),l.a.createElement("div",{className:"mainbody"},l.a.createElement("div",{className:""},l.a.createElement("div",{className:a},l.a.createElement("div",{className:"col-md-7 small-padding table-panel"},l.a.createElement(j,{urlPasted:this.state.urlPasted,usecaseSelected:this.state.usecaseSelected,tableHeader:this.state.tableHeader,tableData:this.state.tableData,keyColIndex:this.state.keyColIndex,keyEntryIndex:this.state.keyEntryIndex,onCellChange:this.cellChange,selectColHeader:this.selectColHeader,getKeyOptions:this.getKeyOptions,optionsMap:this.state.optionsMap,contextAddColumn:this.contextAddColumn,contextDeleteColumn:this.contextDeleteColumn,contextSetColumn:this.contextSetColumn,contextCellOrigin:this.contextCellOrigin,contextCellPreview:this.contextCellPreview,contextOpenLink:this.contextOpenLink,contextSortColumn:this.contextSortColumn,openFilter:this.openFilter,firstColFilled:this.state.firstColFilled,handlePlusClick:this.handlePlusClick,getOtherOptions:this.getOtherOptions})),l.a.createElement("div",{className:"col-md-5 small-padding action-panel"},l.a.createElement(q,{urlPasted:this.state.urlPasted,usecaseSelected:this.state.usecaseSelected,curActionInfo:this.state.curActionInfo,handleStartSubject:this.handleStartSubject,populateKeyColumn:this.populateKeyColumn,populateOtherColumn:this.populateOtherColumn,sameNeighbourDiffCol:this.sameNeighbourDiffCol,sameNeighbourOneCol:this.sameNeighbourOneCol,populateRecommendation:this.populateRecommendation,handleStartTable:this.handleStartTable,propertyNeighbours:this.state.propertyNeighbours,togglePropertyNeighbours:this.togglePropertyNeighbours,toggleSibling:this.toggleSibling,toggleOtherTable:this.toggleOtherTable,unionTable:this.unionTable,unionPage:this.unionPage,unionProperty:this.unionProperty,tabIndex:this.state.tabIndex,handleTabSwitch:this.handleTabSwitch,showTableSelection:this.state.showTableSelection,toggleTableSelection:this.toggleTableSelection,originTableArray:this.state.originTableArray,tableOpenList:this.state.tableOpenList,toggleTable:this.toggleTable,selectedTableIndex:this.state.selectedTableIndex,showUnionTables:this.state.showUnionTables,showJoinTables:this.state.showJoinTables,toggleUnionJoin:this.toggleUnionJoin,handleJoinTable:this.handleJoinTable,firstColSelection:this.state.firstColSelection,firstColChecked:this.state.firstColChecked,firstColFilled:this.state.firstColFilled,toggleFirstNeighbour:this.toggleFirstNeighbour,tableHeader:this.state.tableHeader,keyCheckedIndex:this.state.keyCheckedIndex,addToFirstCol:this.addToFirstCol,confirmAddFirstCol:this.confirmAddFirstCol,otherColSelection:this.state.otherColSelection,otherColChecked:this.state.otherColChecked,otherCheckedIndex:this.state.otherCheckedIndex,toggleOtherNeighbour:this.toggleOtherNeighbour}))),l.a.createElement("div",{className:t},l.a.createElement("div",null,l.a.createElement(K,{pageHidden:this.state.pageHidden,iframeURL:this.state.iframeURL,toggleWikiPage:this.toggleWikiPage}))),l.a.createElement("div",null,l.a.createElement(A,{showSetting:this.state.showSetting,closeModal:this.closeModal,semanticEnabled:this.state.semanticEnabled,toggleSemantic:this.toggleSemantic,unionCutOff:this.state.unionCutOff,unionCutOffChange:this.unionCutOffChange})),l.a.createElement("div",null,l.a.createElement(N,{showFilter:this.state.showFilter,dataAndChecked:this.state.dataAndChecked,applyFilter:this.applyFilter,cancelFilter:this.cancelFilter,toggleChecked:this.toggleChecked})),l.a.createElement("div",null,l.a.createElement(S,{showJoin:this.state.showJoinModal,cancelJoin:this.cancelJoin,originColOptions:this.state.originColOptions,joinColOptions:this.state.joinColOptions,originJoinIndex:this.state.originJoinIndex,joinJoinIndex:this.state.joinJoinIndex,selectJoinColumn:this.selectJoinColumn,runJoin:this.runJoin})))),l.a.createElement("div",{className:"footer"},l.a.createElement(v,null))),l.a.createElement("div",null,e)}}]),t}(n.Component);function $(e){return fetch("https://mysterious-ridge-15861.herokuapp.com/"+e).then((function(e){return e.json()}))}function z(e){return fetch("https://mysterious-ridge-15861.herokuapp.com/"+e).then((function(e){return e.text()}))}function Y(e){return Promise.all(e)}function Z(e){return e.replace(/\$/g,"%5Cu0024").replace(/%/g,"%5Cu0025").replace(/!/g,"%5Cu0021").replace(/"/g,"%5Cu0022").replace(/#/g,"%5Cu0023").replace(/&/g,"%5Cu0026").replace(/'/g,"%5Cu0027").replace(/\(/g,"%5Cu0028").replace(/\)/g,"%5Cu0029").replace(/\*/g,"%5Cu002A").replace(/\+/g,"%5Cu002B").replace(/-/g,"%5Cu002D").replace(/;/g,"%5Cu003B").replace(/=/g,"%5Cu003D").replace(/\?/g,"%5Cu003F").replace(/\./g,"%5Cu002E").replace(/\//g,"%5Cu002F").replace(/,/g,"%5Cu002C").replace(/\s/g,"_")}function ee(e){return e.replace(/%E2%80%93/g,"%5Cu2013").replace(/\$/g,"%5Cu0024").replace(/!/g,"%5Cu0021").replace(/"/g,"%5Cu0022").replace(/#/g,"%5Cu0023").replace(/&/g,"%5Cu0026").replace(/'/g,"%5Cu0027").replace(/\(/g,"%5Cu0028").replace(/\)/g,"%5Cu0029").replace(/\*/g,"%5Cu002A").replace(/\+/g,"%5Cu002B").replace(/-/g,"%5Cu002D").replace(/;/g,"%5Cu003B").replace(/=/g,"%5Cu003D").replace(/\?/g,"%5Cu003F").replace(/\./g,"%5Cu002E").replace(/\//g,"%5Cu002F").replace(/,/g,"%5Cu002C").replace(/\s/g,"_")}function te(e){return!0===e.includes("http://dbpedia.org/resource/")&&(e=e.slice(28)),e}function ae(e,t,a){var n=t.filter((function(e){return e.p.value.slice(28).length>1&&(e.p.value.includes("ontology")||e.p.value.includes("property"))&&!(e.p.value.includes("wikiPage")||e.p.value.includes("align")||e.p.value.includes("abstract")||e.p.value.includes("caption")||e.p.value.includes("image")||e.p.value.includes("width")||e.p.value.includes("thumbnail")||e.p.value.includes("blank")||e.p.value.includes("fec")||e.p.value.includes("viaf")||e.p.value.includes("soundRecording")||e.p.value.includes("votesmart")||e.p.value.includes("wordnet")||e.p.value.includes("float")||e.p.value.includes("bbr")||"http://dbpedia.org/property/alt"===e.p.value||"http://dbpedia.org/property/by"===e.p.value||"http://dbpedia.org/property/onlinebooks"===e.p.value||"http://dbpedia.org/property/signature"===e.p.value||"http://dbpedia.org/property/video"===e.p.value||"http://dbpedia.org/property/logo"===e.p.value)}));if((n=(n=n.filter((function(e){return void 0===e.subPropertyOf||e.subPropertyOf.value.includes("DUL.owl")}))).sort((function(e,t){return e.p.value.slice(28)>t.p.value.slice(28)?1:-1}))).length>0){var l=1,r=n[0].p.value.slice(28),o=[];o.push(te("subject"===a?n[0].o.value:n[0].s.value));for(var i=void 0!==n[0].range?n[0].range.value:"",s=void 0!==n[0].subPropertyOf?n[0].subPropertyOf.value:"",c=1;c<n.length;++c){var u=n[c].p.value.slice(28);if(u===r)++l,o.push(te("subject"===a?n[c].o.value:n[c].s.value));else{if(l<=50){var p=r;"object"===a&&(p="is "+p+" of");var h={value:r,label:p,type:a,count:l,filledCount:1,data:o,range:i,subPropertyOf:s};e.push(h)}l=1,r=u,o=[te("subject"===a?n[c].o.value:n[c].s.value)],i=void 0!==n[c].range?n[c].range.value:"",s=void 0!==n[c].subPropertyOf?n[c].subPropertyOf.value:""}}if(l<=50){var d=r;"object"===a&&(d="is "+d+" of");var b={value:r,label:d,type:a,count:l,filledCount:1,data:o,range:i,subPropertyOf:s};e.push(b)}}return e}function ne(e,t){var a=e.filter((function(e){return e.p.value.slice(28).length>1&&(e.p.value.includes("ontology")||e.p.value.includes("property"))&&!(e.p.value.includes("wikiPage")||e.p.value.includes("align")||e.p.value.includes("abstract")||e.p.value.includes("caption")||e.p.value.includes("image")||e.p.value.includes("width")||e.p.value.includes("thumbnail")||e.p.value.includes("blank")||e.p.value.includes("fec")||e.p.value.includes("viaf")||e.p.value.includes("soundRecording")||e.p.value.includes("votesmart")||e.p.value.includes("wordnet")||e.p.value.includes("float")||e.p.value.includes("bbr")||"http://dbpedia.org/property/alt"===e.p.value||"http://dbpedia.org/property/by"===e.p.value||"http://dbpedia.org/property/onlinebooks"===e.p.value||"http://dbpedia.org/property/signature"===e.p.value||"http://dbpedia.org/property/video"===e.p.value||"http://dbpedia.org/property/logo"===e.p.value)})),n=[];if((a=a.sort((function(e,t){return e.p.value.slice(28)>t.p.value.slice(28)?1:-1}))).length>1){n.push({key:"subject"===t?a[0].p.value.slice(28):"is "+a[0].p.value.slice(28)+" of",value:[te(a[0].value.value)]});for(var l=0,r=1;r<a.length;++r){a[r].p.value.slice(28)===a[r-1].p.value.slice(28)?n[l].value.length<5&&n[l].value.push(te(a[r].value.value)):(n.push({key:"subject"===t?a[r].p.value.slice(28):"is "+a[r].p.value.slice(28)+" of",value:[te(a[r].value.value)]}),++l)}}return n}function le(e,t,a){for(var n=0;n<a.length;++n)"null"!==a[n]&&a[n]++;a.splice(0,0,0);for(var l=[],r=0;r<t.length;++r){for(var o=[],i=0;i<a.length;++i){var s=a[i];"null"!==s?o.push(t[r][s]):o.push({data:"N/A"})}l.push(o)}return e.concat(l)}function re(e){return"\n"===e[e.length-1]?e.slice(0,-1).trim().split("[")[0]:e.trim().split("[")[0]}function oe(e,t,a,n,l,r){for(var o=[],i=1;i<e.length;++i){for(var s="",c=0;c<e[i].length;++c)s+=e[i][c].value;o.push(s)}for(var u=(new DOMParser).parseFromString(t,"text/html").getElementsByClassName("wikitable"),p=[],h=0;h<u.length;++h)"TH"!==u[h].tagName&&p.push(u[h]);for(var d=[],b=[],g=0;g<p.length;++g)b.push(ie(p[g],o,a,n,l,r));return Y(b).then((function(e){for(var t=0;t<e.length;++t)d.push(e[t]);return(d=d.filter((function(e){return-1!==e}))).sort((function(e,t){return e.unionScore<t.unionScore?1:-1})),Promise.resolve(d)}))}function ie(e,t,a,n,l,r){for(var o=e.rows[0].cells,i=[],s=[],c=[],u=[],p=0;p<o.length;++p){var h=re(o[p].innerText);i.push(h),s.push(p)}if(i.length>=t.length*l){for(var d=0,b=[],g=0;g<t.length;++g){var f=i.indexOf(t[g]);-1!==f?(b.push(f),d+=1/t.length):b.push("null")}if(i.length===t.length){for(var m=!0,v=0;v<b.length;++v)if("null"!==b[v]&&b[v]!==v){m=!1;break}if(!0===m)for(var C=0;C<b.length;++C)"null"===b[C]&&(i[C].includes(t[C])||t[C].includes(i[C]))&&(b[C]=C,d+=1/t.length);1===d&&(d+=.01)}if("enabled"===n){if(d<.999){s=s.filter((function(e){return b.indexOf(e)<0}));for(var y=0;y<b.length;++y)"null"===b[y]&&c.push(y);u.push(se(e,s,r))}return Y(u).then((function(n){if(d>=.999)return Promise.resolve({isOpen:!1,unionScore:d,colMapping:b,data:e,title:i});var r=function(){var r=n[0].slice();if(r.length>0)for(var o=0;o<c.length;++o){var u=c[o];if(a[u].length>0)for(var p=function(e){if(r[e].length>0)if("Number"===a[u][0]||"Number"===r[e][0]){if(a[u][0]===r[e][0])return b[u]=s[e],d+=1/t.length,s.splice(e,1),r.splice(e,1),--e,h=e,"break"}else{var n=a[u].filter((function(t){return h=e,r[e].indexOf(t)>=0}));if(n.length>0){var l=a[u].length,o=r[e].length;if(pe(n.length,780,l,o)>.999)return b[u]=s[e],d+=1/t.length,s.splice(e,1),r.splice(e,1),--e,h=e,"break"}}h=e},h=0;h<s.length;++h){if("break"===p(h))break}}return d>=l?{v:Promise.resolve({isOpen:!1,unionScore:d,colMapping:b,data:e,title:i})}:{v:Promise.resolve(-1)}}();return"object"===typeof r?r.v:void 0}))}return d>=l?Promise.resolve({isOpen:!1,unionScore:d,colMapping:b,data:e,title:i}):Promise.resolve(-1)}return Promise.resolve(-1)}function se(e,t,a){for(var n=e,l=[],r=0;r<n.rows.length;++r){for(var o=[],i=0;i<n.rows[r].cells.length;++i){var s=re(n.rows[r].cells[i].innerText);if(1===r)for(var c=n.rows[r].cells[i].getElementsByTagName("a"),u=0;u<c.length;++u)if(""!==c[u].innerText&&"["!==c[u].innerText[0]){var p=c[u].href.split("/");s=p[p.length-1]}var d=n.rows[r].cells[i].rowSpan,b=n.rows[r].cells[i].colSpan;o.push({data:s,rowSpan:d,colSpan:b})}l.push(o)}for(var g=0;g<l.length;++g)for(var f=0;f<l[g].length;++f){var m=l[g][f].data;if(l[g][f].colSpan>1)for(var v=1;v<l[g][f].colSpan;++v)l[g].splice(f+1,0,{data:m,rowSpan:1,colSpan:1})}for(var C=0;C<l.length;++C)for(var y=0;y<l[C].length;++y){var k=l[C][y].data;if(l[C][y].rowSpan>1)for(var E=1;E<l[C][y].rowSpan;++E)C+E<l.length&&l[C+E].splice(y,0,{data:k,rowSpan:1,colSpan:1})}var A=[],N=Math.min(1,l.length-1);if(void 0===t){t=[];for(var O=0;O<l[0].length;++O)t.push(O)}for(var S=0;S<t.length;++S)for(var D=t[S],I=1;I<=N;++I){var x=void 0===l[I][D]?"NONEXISTING":Z(l[I][D].data);if(isNaN(Number(x))||""===x)if(x.length>40)A.push(Promise.resolve(["Null"]));else{void 0!==x&&""!==x||(x="NONEXISTING");var j="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fo%0D%0AWHERE+%7B%0D%0A++++++dbr%3A"+x+"+rdf%3Atype+%3Fo.%0D%0A++++++BIND%28STR%28%3Fo%29+AS+%3FoString+%29.%0D%0A++++++FILTER%28regex%28%3FoString%2C%22dbpedia.org%2Fontology%2F%22%2C%22i%22%29%29%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+";A.push($(j))}else A.push(Promise.resolve(["Number"]))}return Y(A).then((function(e){for(var a=[],n=0;n<t.length;++n){var l=[];if(void 0!==e[N*n])if(void 0!==e[N*n][0])"Number"===e[N*n][0]?a.push(["Number"]):"Null"===e[N*n][0]&&a.push([]);else{for(var r=0;r<N;++r){for(var o=[],i=e[N*n+r].results.bindings,s=0;s<i.length;++s)o.push(i[s].o.value.slice(28));l=Object(h.a)(new Set([].concat(Object(h.a)(l),o)))}a.push(l)}}return Promise.resolve(a)}))}function ce(e,t){for(var a=e,n=[],l=0;l<a.rows.length;++l){for(var r=[],o=0;o<a.rows[l].cells.length;++o){var i=re(a.rows[l].cells[o].innerText);if(l>0)for(var s=a.rows[l].cells[o].getElementsByTagName("a"),c=0;c<s.length;++c)if(""!==s[c].innerText&&"["!==s[c].innerText[0]){var u=s[c].href.split("/");i=decodeURIComponent(u[u.length-1])}var p=a.rows[l].cells[o].rowSpan,h=a.rows[l].cells[o].colSpan;r.push({data:i,origin:t,rowSpan:p,colSpan:h})}n.push(r)}for(var d=0;d<n.length;++d)for(var b=0;b<n[d].length;++b){var g=n[d][b].data;if(n[d][b].colSpan>1)for(var f=1;f<n[d][b].colSpan;++f)n[d].splice(b+1,0,{data:g,origin:t,rowSpan:n[d][b].rowSpan,colSpan:1})}for(var m=0;m<n.length;++m)for(var v=0;v<n[m].length;++v){var C=n[m][v].data;if(n[m][v].rowSpan>1)for(var y=1;y<n[m][v].rowSpan;++y)m+y<n.length&&n[m+y].splice(v,0,{data:C,origin:t,rowSpan:1,colSpan:1})}n[0].splice(0,0,{data:"OriginURL",origin:t,rowSpan:1,colSpan:1});for(var k=1;k<n.length;++k)n[k].splice(0,0,{data:t,origin:"null",rowSpan:1,colSpan:1});return n}function ue(e){for(var t=[],a=0;a<e[0].length;++a)t.push({value:e[0][a].data,label:e[0][a].data});for(var n=[],l=1;l<e.length;++l){for(var r=[],o=0;o<e[l].length;++o){var i=e[l][o].data,s=[],c=e[l][o].origin+": "+t[o].value+": "+e[l][o].data;s.push(c),r.push({data:i,origin:s})}n.push(r)}return n}function pe(e,t,a,n){for(var l=0,r=Object(b.a)(t,n),o=0;o<=e;++o)l+=Object(b.a)(a,o)*Object(b.a)(t-a,n-o)/r;return l}function he(e){var t=e,a=e.indexOf("(");return-1!==a&&(t=t.slice(0,a-1)),t.replace(/_/g," ")}function de(e){for(var t=[],a=G.a.cloneDeep(e),n=0;n<a.length;++n)t=t.concat(a[n]);if(t.sort((function(e,t){return e.value<t.value?-1:1})),t.length>0)for(var l=1;l<t.length;++l){var r=t[l-1],o=t[l];r.value===o.value&&(t[l-1].filledCount=t[l-1].filledCount+1,t[l-1].count=Math.max(r.count,o.count),t.splice(l,1),--l)}t.sort((function(e,t){return e.filledCount<t.filledCount?1:-1}));for(var i=0;i<t.length;++i){var s=Math.round(t[i].filledCount/a.length*100)/100;t[i].label=t[i].label+" ("+s+")"}return t}function be(e){for(var t=[],a=G.a.cloneDeep(e),n=0;n<a.length;++n){for(var l={},r=0;r<a[n].length;++r){var o=G.a.uniq(a[n][r].data.slice());l[a[n][r].value]=o}t.push(l)}return t}function ge(e){for(var t="",a=0;a<e.length;++a){a>0&&(t+=" OR "),t+="subject"===e[a].type?e[a].value:"is "+e[a].value+" of"}return t}function fe(e){for(var t=G.a.cloneDeep(e),a=0;a<t.length;++a){for(var n=[],l=0;l<t.length;++l)if(a!==l){var r=t[a].value.toUpperCase(),o=t[l].value.toUpperCase();(r.includes(o)||o.includes(r))&&n.push({value:t[l].value,type:t[l].type,relation:"string"}),(t[a].range===t[l].range&&""!==t[a].range||t[a].subPropertyOf===t[l].subPropertyOf&&""!==t[a].subPropertyOf)&&n.push({value:t[l].value,type:t[l].type,relation:"semantic"})}t[a].recommendNeighbours=n}return t}function me(e){for(var t=[],a=0;a<e.length;++a)t=t.concat(e[a].recommendNeighbours);return t=G.a.uniqBy(t,(function(e){return e.value||e.type||e.relation})),t=G.a.differenceBy(t,e,(function(e){return e.value||e.type}))}function ve(e,t){for(var a=0,n=0;n<t.length;++n)t[n].p.value===e&&++a;return a}function Ce(e){for(var t=!1,a="select+%3Fsomevar%0D%0Awhere+%7B",n=0;n<e.length;++n){var l="";"dct"===e[n].pDataset?l="%0D%0A%3Fsomevar+dct%3Asubject+dbc%3A"+Z(e[n].oValue)+".":"http://www.w3.org/2001/XMLSchema#date"===e[n].oType?l="%0D%0A%3Fsomevar+"+e[n].pDataset+"%3A"+Z(e[n].pValue)+"+%22"+e[n].oValue+"%22%5E%5E%3Chttp%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%23date%3E.":"http://www.w3.org/2001/XMLSchema#integer"===e[n].oType?l="%0D%0A%3Fsomevar+"+e[n].pDataset+"%3A"+Z(e[n].pValue)+"+%22"+e[n].oValue+"%22%5E%5E%3Chttp%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%23integer%3E.":"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"===e[n].oType?l="%0D%0A%3Fsomevar+"+e[n].pDataset+"%3A"+Z(e[n].pValue)+"+%22"+e[n].oValue.replace(/\s/g,"+")+"%22%5E%5E%3Chttp%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23langString%3E.":"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"===e[n].oType?l="%0D%0A%3Fsomevar+"+e[n].pDataset+"%3A"+Z(e[n].pValue)+"+%22"+e[n].oValue+"%22%5E%5E%3Chttp%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%23nonNegativeInteger%3E.":""===e[n].oType?l="%0D%0A%3Fsomevar+"+e[n].pDataset+"%3A"+Z(e[n].pValue)+"+dbr%3A"+Z(e[n].oValue)+".":(console.log(e[n].oType),t=!0),a+=l}return a+="%0D%0A%7D%0D%0A&",!0===t?"ERROR":"https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+a+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+"}function ye(e,t){for(var a={},n=[],l=0;l<e.length;++l){var r=ae([],e[l].results.bindings,"subject");n.push(r)}a.subject=be(n);var o=de(n);o=fe(o);for(var i=[],s=0;s<t.length;++s){var c=ae([],t[s].results.bindings,"object");i.push(c)}a.object=be(i);var u=de(i);return u=fe(u),{firstDegNeighbours:a,keyColNeighbours:o.concat(u)}}var ke=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"wrapper "},l.a.createElement("div",{className:"font-body"},l.a.createElement("div",null,l.a.createElement(Q,null))))}}]),t}(n.Component);o.a.render(l.a.createElement(ke,null),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.73dc617c.chunk.js.map