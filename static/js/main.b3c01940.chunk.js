(this.webpackJsonpKTabulator=this.webpackJsonpKTabulator||[]).push([[0],{50:function(e,t,a){e.exports=a(80)},56:function(e,t,a){},57:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),l=a(19),o=a.n(l),i=(a(55),a(56),a(57),a(8)),s=a(9),c=a(10),u=a(11),p=a(12),h=a(32),d=a.n(h),g=a(44),b=a(24),v=a(2),f=a(87),m=a(13),C=a(45),y=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"row header-body"},n.a.createElement("div",{className:"col-md-8"},n.a.createElement("a",{href:"index.html",class:"logo"},n.a.createElement("b",null,n.a.createElement("span",null,"K"),"Tabulator"))),n.a.createElement("div",{className:"offset-md-2 col-md-2 row"},n.a.createElement("div",{className:"col-md-3"},n.a.createElement("a",{href:"data:text/json;charset=utf-8,\n                      ".concat(encodeURIComponent(JSON.stringify(this.props.fullState))),title:"download table",download:"shareTable.json"},n.a.createElement(m.c,{className:"json-link"}))),n.a.createElement("div",{className:"col-md-3"},n.a.createElement("button",{className:"btn btn-default",title:"export table",onClick:function(){return e.props.copyTable()}},n.a.createElement(m.b,{className:"logo-left-color"}))),n.a.createElement("div",{className:"col-md-3"},n.a.createElement("button",{className:"btn btn-default",title:"Union Table Settings"},n.a.createElement(C.a,{className:"logo-left-color",onClick:function(){return e.props.openModal()}}))),n.a.createElement("div",{className:"col-md-3"},n.a.createElement("button",{className:"btn btn-default",title:"undo previous action",onClick:function(){return e.props.undoPreviousStep()}},n.a.createElement(m.l,{className:"color-wrangler"}))))),n.a.createElement("hr",{class:"header-hr"}))}}]),t}(r.Component),E=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"text-center text-sm"}))}}]),t}(r.Component),k=a(22),A=a.n(k),N=a(46),I=a.n(N),x=(a(70),function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(A.a,{isOpen:this.props.showSetting,className:"setting-modal"},n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-6 offset-md-3"},n.a.createElement("h4",null,"Table Union Search Settings"))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-4"},"Semantic Mapping:"),n.a.createElement("div",{className:"col-md-6"},n.a.createElement("div",{onChange:function(t){return e.props.toggleSemantic(t)}},n.a.createElement("input",{type:"radio",value:"enabled",checked:"enabled"===this.props.semanticEnabled})," ","Enabled",n.a.createElement("input",{type:"radio",value:"disabled",checked:"disabled"===this.props.semanticEnabled})," ","Disabled"))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-4"},"Percentage of Columns to Union:"),n.a.createElement("div",{className:"col-md-6"},n.a.createElement(I.a,{value:this.props.unionCutOff,onChange:function(t){return e.props.unionCutOffChange(t)},min:0,max:1,step:.05}))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-4 offset-md-4"},n.a.createElement("button",{onClick:function(){return e.props.closeModal()}},"Confirm Settings"))))))}}]),t}(r.Component)),D=a(83),w=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){for(var e=this,t=[],a=function(a){t.push(n.a.createElement("div",null,n.a.createElement("input",{type:"checkbox",checked:e.props.dataAndChecked[a].checked,onChange:function(t){return e.props.toggleChecked(t,a)}}),e.props.dataAndChecked[a].data.replace(/_\(.*?\)/g,"").replace(/_/g," ")))},r=0;r<this.props.dataAndChecked.length;++r)a(r);var l=null;if(!0===this.props.showFilter){for(var o=!0,i=0;i<this.props.tableData.length;++i)if("N/A"!==this.props.tableData[i][this.props.curFilterIndex].data&&isNaN(Number(this.props.tableData[i][this.props.curFilterIndex].data))){o=!1;break}o&&(l=n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement("input",{placeholder:"min",value:this.props.filterMin,onChange:function(t){return e.props.handleRangeFilter(t,"min")}}),"to",n.a.createElement("input",{placeholder:"max",value:this.props.filterMax,onChange:function(t){return e.props.handleRangeFilter(t,"max")}}))))}return n.a.createElement("div",null,n.a.createElement(A.a,{isOpen:this.props.showFilter,className:"filter-modal"},n.a.createElement("div",{className:"container"},n.a.createElement("div",null,"Here is the list of data to filter."),n.a.createElement("br",null),n.a.createElement("div",{className:"checkbox-list"},n.a.createElement("div",null,n.a.createElement("input",{type:"checkbox",checked:this.props.checkAll,onChange:function(t){return e.props.toggleAll(t)}}),"Check/Uncheck all"),n.a.createElement("br",null),l,t),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-1 offset-md-9"},n.a.createElement(D.a,{onClick:function(t){return e.props.applyFilter(t)}},"OK")),n.a.createElement("div",{className:"col-md-2"},n.a.createElement(D.a,{onClick:function(t){return e.props.cancelFilter(t)}},"Cancel"))))))}}]),t}(r.Component);var S=a(35),O=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=null,a=[];if(this.props.joinPairRecord.length>0){for(var r=function(t){var r=e.props.joinPairRecord[t].indices[0],l=e.props.joinPairRecord[t].indices[1],o=e.props.originColOptions[r].label+" with "+e.props.joinColOptions[l].label;a.push(n.a.createElement("p",null,n.a.createElement(D.a,{onClick:function(t){return e.props.runJoin(t,"suggest",r,l)}},o)))},l=0;l<this.props.joinPairRecord.length;++l)r(l);t=n.a.createElement("div",null,n.a.createElement("p",null,"Here are the suggested columns to join on."),a)}return n.a.createElement("div",null,n.a.createElement(A.a,{isOpen:this.props.showJoin,className:"join-modal"},n.a.createElement("div",{className:"container"},t,n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5"},"Choose join column from table panel"),n.a.createElement("div",{className:"offset-md-1 col-md-5"},"Choose join column from selected table")),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement(S.a,{className:"col-md-5",value:this.props.originColOptions[this.props.originJoinIndex],onChange:function(t){return e.props.selectJoinColumn(t,"originTable")},placeholder:"Choose Join Column",options:this.props.originColOptions,isMulti:!1}),n.a.createElement(S.a,{className:"offset-md-1 col-md-5",value:this.props.joinColOptions[this.props.joinJoinIndex],onChange:function(t){return e.props.selectJoinColumn(t,"joinTable")},placeholder:"Choose Join Column",options:this.props.joinColOptions,isMulti:!1})),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-1 offset-md-9"},n.a.createElement(D.a,{onClick:function(t){return e.props.runJoin(t,"custom")}},"OK")),n.a.createElement("div",{className:"col-md-2"},n.a.createElement(D.a,{onClick:function(t){return e.props.cancelJoin(t)}},"Cancel"))))))}}]),t}(r.Component),j=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(A.a,{isOpen:this.props.showUnionModal,className:"union-modal"},n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5"},"Choose one of the following alignments:")),n.a.createElement("br",null),n.a.createElement("div",{className:"modal-body"},n.a.createElement("div",null,n.a.createElement(D.a,{onClick:function(t){return e.props.hardcodeUnion(t)}},"Suggested Alignment"),n.a.createElement("p",null,"First Column---English title; director---Director(s); country---Country")),n.a.createElement("div",null,n.a.createElement(D.a,null,"Create Manual Alignment"))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-2 offset-md-10"},n.a.createElement(D.a,{onClick:function(){return e.props.cancelUnionAlign()}},"Cancel"))))))}}]),t}(r.Component),T=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.handleURLPaste=a.handleURLPaste.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"handleURLPaste",value:function(e){e.preventDefault();var t=(e.clipboardData||window.clipboardData).getData("text");this.props.handleURLPaste(t)}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",{className:"row text-center"},n.a.createElement("div",{className:"col-md-6 offset-md-3"},n.a.createElement("input",{placeholder:"e.g., https://en.wikipedia.org/wiki/Canada",onPaste:this.handleURLPaste,className:" form-control"}))))}}]),t}(r.Component),F=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"landing-page"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"white-form col-md-5"},n.a.createElement("h1",{className:"text-center"},"Welcome!"),n.a.createElement("hr",{className:"header-hr"}),n.a.createElement("h4",{className:"text-center"},"Enter the URL of a Wikipedia page to get started"),n.a.createElement(T,{handleURLPaste:this.props.handleURLPaste})))))}}]),t}(r.Component),P=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={showFullTitle:!1},a.createSuperTable=a.createSuperTable.bind(Object(v.a)(a)),a.createSelectedTableView=a.createSelectedTableView.bind(Object(v.a)(a)),a.showFullTitle=a.showFullTitle.bind(Object(v.a)(a)),a.showPartialTitle=a.showPartialTitle.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"showFullTitle",value:function(){this.setState({showFullTitle:!0})}},{key:"showPartialTitle",value:function(){this.setState({showFullTitle:!1})}},{key:"columnHeaderGen",value:function(e){var t=this;if(0===e){if(this.props.tableHeader.length>0&&1===this.props.tableHeader[0].length&&"OriginURL"===this.props.tableHeader[0][0].label){for(var a="",r=0;r<this.props.tableHeader[0].length;++r){a+=r>0?"\nAND "+R(this.props.tableHeader[0][r].label):R(this.props.tableHeader[0][r].label)}return n.a.createElement("div",null,a)}var l=this.props.firstColHeaderInfo;if(l.length<2){for(var o=[],i=0;i<l.length;++i){for(var s="",c=0;c<l[i].length;++c){s+=c>0?"\nAND "+R(l[i][c].label):R(l[i][c].label)}o.push(n.a.createElement("p",null,s))}return n.a.createElement("div",null,o)}if(!1===this.state.showFullTitle){for(var u=[],p="",h=0;h<l[0].length;++h){p+=h>0?"\nAND "+R(l[0][h].label):R(l[0][h].label)}return u.push(n.a.createElement("p",null,p,"\xa0",n.a.createElement(m.e,{onMouseEnter:function(){return t.showFullTitle()},onMouseLeave:function(){return t.showPartialTitle()}}))),n.a.createElement("div",null,u)}for(var d=[],g=0;g<l.length;++g){for(var b="",v=0;v<l[g].length;++v){b+=v>0?"\nAND "+R(l[g][v].label):R(l[g][v].label)}0===g?d.push(n.a.createElement("p",null,b,"\xa0",n.a.createElement(m.e,{onMouseEnter:function(){return t.showFullTitle()},onMouseLeave:function(){return t.showPartialTitle()}}))):d.push(n.a.createElement("p",null,b))}return n.a.createElement("div",null,d)}for(var f="",C=0;C<this.props.tableHeader[e].length;++C){var y="object"===this.props.tableHeader[e][C].type?"is "+this.props.tableHeader[e][C].value+" of":this.props.tableHeader[e][C].value;f+=y=C>0?"\nOR "+y:y}return n.a.createElement("div",null,f)}},{key:"createSuperTable",value:function(){for(var e=this,t=this.props.tableData.length,a=this.props.tableData[0].length,r=[],l=[],o=function(t){var a=void 0;if(0===t){var r=null,o=n.a.createElement("div",null,n.a.createElement("br",null));!0===e.props.firstColFilled&&(o=e.columnHeaderGen(t),r="OriginURL"!==e.props.tableHeader[0][0].value?n.a.createElement("div",null,n.a.createElement("button",{className:"btn btn-default",title:"Add entities",onClick:function(){return e.props.handlePlusClick()}},n.a.createElement(m.a,null)),n.a.createElement("button",{className:"btn btn-default",title:"Set as key column",onClick:function(a){return e.props.contextSetColumn(a,t)}},n.a.createElement(m.j,null)),n.a.createElement("button",{className:"btn btn-default",title:"Add column to the right",onClick:function(a){return e.props.contextAddColumn(a,t)}},n.a.createElement(m.i,null)),n.a.createElement("button",{className:"btn btn-default",title:"Filter this column",onClick:function(a){return e.props.showFilterMethods(a,t)}},n.a.createElement(m.f,null))):n.a.createElement("div",null,n.a.createElement("button",{className:"btn btn-default",title:"Add column to the right",onClick:function(a){return e.props.contextAddColumn(a,t)}},n.a.createElement(m.i,null)))),a=n.a.createElement("th",{className:"table-head"},n.a.createElement("div",{className:"super-header-div"}),r,o)}else if(t===e.props.keyColIndex){var i=e.columnHeaderGen(t),s=n.a.createElement("div",null,n.a.createElement("br",null));!0===e.props.firstColFilled&&(s=n.a.createElement("div",null,n.a.createElement("button",{className:"btn btn-default",title:"Add column to the right",onClick:function(a){return e.props.contextAddColumn(a,t)}},n.a.createElement(m.i,null)),n.a.createElement("button",{className:"btn btn-default",title:"Filter this column",onClick:function(a){return e.props.showFilterMethods(a,t)}},n.a.createElement(m.f,null)))),a=n.a.createElement("th",{className:"table-head"},s,i)}else{var c=e.columnHeaderGen(t),u=n.a.createElement("div",null,n.a.createElement("br",null));!0===e.props.firstColFilled&&(u=n.a.createElement("div",null,n.a.createElement("button",{className:"btn btn-default",title:"Add entities",onClick:function(a){return e.props.getOtherOptions(a,t)}},n.a.createElement(m.d,null)),n.a.createElement("button",{className:"btn btn-default",title:"Set as key column",onClick:function(a){return e.props.contextSetColumn(a,t)}},n.a.createElement(m.j,null)),n.a.createElement("button",{className:"btn btn-default",title:"Add column to the right",onClick:function(a){return e.props.contextAddColumn(a,t)}},n.a.createElement(m.i,null)),n.a.createElement("button",{className:"btn btn-default",title:"Delete this column",onClick:function(a){return e.props.contextDeleteColumn(a,t)}},n.a.createElement(m.h,null)),n.a.createElement("button",{className:"btn btn-default",title:"Filter this column",onClick:function(a){return e.props.showFilterMethods(a,t)}},n.a.createElement(m.f,null)))),a=n.a.createElement("th",{className:"table-head"},u,c)}l.push(a)},i=0;i<a;++i)o(i);r.push(n.a.createElement("thead",{className:"table-head"},n.a.createElement("tr",null,l)));for(var s=[],c=function(t){for(var r=[],l=function(a){if(a===e.props.previewColIndex){r.push(n.a.createElement("td",{style:{backgroundColor:"LightGray"}},n.a.createElement("input",{className:"twenty-vw column-preview-color",type:"text",value:R(e.props.tableData[t][a].previewData),readOnly:!0})))}else{var l;l=a===e.props.keyColIndex?{backgroundColor:"LightBlue"}:{backgroundColor:"White"};var o=R(e.props.tableData[t][a].data).replace(/;/g,"\n");r.push(n.a.createElement("td",{style:l},n.a.createElement("input",{className:"twenty-vw",type:"text",value:R(e.props.tableData[t][a].data),title:o,onChange:function(r){return e.props.onCellChange(r,t,a)},onDoubleClick:function(r){return e.props.originPreviewPage(r,t,a)}})))}},o=0;o<a;o++)l(o);s.push(n.a.createElement("tr",null,r))},u=0;u<t;u++)c(u);return r.push(n.a.createElement("tbody",null,s)),r}},{key:"createSelectedTableView",value:function(){for(var e=this.props.tableDataExplore.length,t=this.props.tableDataExplore[0].length,a=[],r=[],l=0;l<t;++l){var o=n.a.createElement("th",{className:"table-head table-col"},this.props.tableDataExplore[0][l].data);r.push(o)}var i=n.a.createElement("tr",{className:"table-head table-col"},r);a.push(n.a.createElement("thead",null,i));for(var s=[],c=1;c<e;c++){for(var u=[],p=0;p<t;p++)u.push(n.a.createElement("td",{className:"table-col"},this.props.tableDataExplore[c][p].data));s.push(n.a.createElement("tr",null,u))}return a.push(n.a.createElement("tbody",null,s)),a}},{key:"render",value:function(){var e;return e=n.a.createElement("div",null,n.a.createElement("table",{class:!0,border:"1",className:"table table-sm table-bordered"},this.createSuperTable())),n.a.createElement("div",null,e)}}]),t}(r.Component);function R(e){return e.replace(/_\(.*?\)/g,"").replace(/_/g," ")}var L=a(84),U=a(85),H=a(86),M=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createButtonArray=a.createButtonArray.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createButtonArray",value:function(){for(var e=this,t=this.props.originTableArray,a=[],r=function(r){for(var l="Table "+r+": ",o=t[r].rows[0].cells,i=0;i<o.length;++i){var s=B(o[i].innerText);"\n"===s[s.length-1]&&(s=s.slice(0,-1)),l=l+s+"| "}var c=n.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.props.originTableArray[r].outerHTML}}),u=void 0;if(!0===e.props.tableOpenList[r]){var p="";p="select"===e.props.listType?"Select":"join"===e.props.listType?"Join":"Union",u=n.a.createElement(D.a,{onClick:function(t){return e.props.buttonFunction(t,r)}},p)}a.push(n.a.createElement("li",{className:"list-group-item"},n.a.createElement("span",{onClick:function(t){return e.props.toggleTable(t,r)}},l," ",n.a.createElement(m.k,null)),u,n.a.createElement(L.a,{isOpen:e.props.tableOpenList[r]},n.a.createElement("div",null,c))))},l=0;l<t.length;++l)r(l);return n.a.createElement("ul",{className:"list-group list-css list-group-flush"},a)}},{key:"render",value:function(){var e=null;return 0!==this.props.originTableArray.length&&(e=n.a.createElement("div",null,this.createButtonArray())),n.a.createElement("div",null,e)}}]),t}(r.Component);function B(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}var _=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=function(e){var t=e,a=e.indexOf("(");-1!==a&&(t=t.slice(0,a-1));return t.replace(/_/g," ")}(this.props.urlPasted.slice(30).replace(/%E2%80%93/,"\u2013"));return n.a.createElement("div",{className:"action-scrollable"},n.a.createElement("ul",{class:"list-group list-css list-group-flush"},n.a.createElement("hr",{className:"m-0"}),n.a.createElement("li",{className:"list-group-item",onClick:function(t){return e.props.handleStartSubject(t,"startSubject")}},"Start creating a table about ",decodeURIComponent(t)),n.a.createElement("li",{className:"list-group-item"},n.a.createElement("span",{onClick:function(){return e.props.toggleTableSelection()}},"Start with an existing table from page ",n.a.createElement(m.g,null)),n.a.createElement(L.a,{isOpen:this.props.showTableSelection},n.a.createElement(U.a,null,n.a.createElement(H.a,null,n.a.createElement("div",null,n.a.createElement(M,{originTableArray:this.props.originTableArray,tableOpenList:this.props.tableOpenList,toggleTable:this.props.toggleTable,buttonFunction:this.props.handleStartTable,listType:"select"})))))),n.a.createElement("hr",{className:"m-0"})))}}]),t}(r.Component);var J=a(18),q=(a(78),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createFirstColSelection=a.createFirstColSelection.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createFirstColSelection",value:function(){var e=this,t=this.props.keyCheckedIndex,a=this.props.firstColSelection,r=this.props.firstColChecked,l=[];r.length!==a.length&&alert("Some error exists");for(var o=0;o<r.length;++o)!0===r[o]&&l.push(a[o]);var i=n.a.createElement("div",{className:"fixed-populateEle"},n.a.createElement("b",null,"Choose from attributes below")," to determine the content for the first column");if(-1!==t&&l.length>0){for(var s=!1===this.props.firstColFilled?"Populate first column with entities that":"Add to first column with entities that",c=0;c<l.length;++c){var u=c>0?", and":"";s+=u="dct"===l[c].pDataset?u+" are "+X(l[c].oValue):u+" have "+l[c].pValue+"="+X(l[c].oValue)}s+="?";var p=!1===this.props.firstColFilled?n.a.createElement(D.a,{className:"btn-sm",onClick:function(t){return e.props.populateKeyColumn(t,0,l)}},"OK"):n.a.createElement(D.a,{className:"btn-sm",onClick:function(t){return e.props.confirmAddFirstCol(t,l)}},"OK");i=n.a.createElement("div",{className:"fixed-populateEle"},n.a.createElement("b",null,s),"\xa0",p,n.a.createElement("br",null))}var h=[],d=n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("p",null,"Search for attributes:","\xa0",n.a.createElement("input",{value:this.props.firstColText,onChange:function(t){return e.props.firstColTextChange(t)},placeholder:"Type here"}))));h.push(d);for(var g=function(t){"category"===a[t].pValue?(""===e.props.firstColText||X(a[t].oValue).toUpperCase().includes(e.props.firstColText.toUpperCase()))&&h.push(n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement("input",{type:"checkbox",checked:r[t],onChange:function(a){return e.props.toggleFirstNeighbour(a,t)}}),"\xa0","\xa0",X(a[t].oValue))))):(""===e.props.firstColText||a[t].pValue.toUpperCase().includes(e.props.firstColText.toUpperCase())||X(a[t].oValue).toUpperCase().includes(e.props.firstColText.toUpperCase()))&&h.push(n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement("input",{type:"checkbox",checked:r[t],onChange:function(a){return e.props.toggleFirstNeighbour(a,t)}}),"\xa0","\xa0",a[t].pValue,":","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0","\xa0",X(a[t].oValue))))},b=0;b<a.length;++b)g(b);return n.a.createElement("div",null,i,n.a.createElement("div",{className:"padding-top-8vh"},h))}},{key:"render",value:function(){var e=this.createFirstColSelection();return n.a.createElement("div",null,e)}}]),t}(r.Component));function X(e){return e.replace(/_\(.*?\)/g,"").replace(/_/g," ")}var V=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createOtherColSelection=a.createOtherColSelection.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createOtherColSelection",value:function(){var e=this,t=this.props.otherColSelection,a=this.props.otherColChecked,r=this.props.otherCheckedIndex;a.length!==t.length&&console.log("Some error exists");for(var l=[],o=0;o<a.length;++o)!0===a[o]&&l.push(t[o]);var i=n.a.createElement("div",{className:"fixed-populateEle"},n.a.createElement("b",null,"Choose from attributes below")," to determine the content for this column",n.a.createElement("br",null));if(-1!==r&&l.length>0){for(var s="Populate this column with attributes ",c=0;c<l.length;++c){var u="object"===l[c].type?"is "+l[c].value+" of":l[c].value;s+=u=c>0?" OR "+u:u}s+="?",i=n.a.createElement("div",{className:"fixed-populateEle"},n.a.createElement("b",null,s),"\xa0",n.a.createElement(D.a,{className:"btn-sm",onClick:function(t){return e.props.populateOtherColumn(t,e.props.colIndex,l)}},"OK"),n.a.createElement("br",null))}var p=[];p.push(i);var h=n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement("br",null))),n.a.createElement("div",null,n.a.createElement("p",null,"Search for attributes:","\xa0",n.a.createElement("input",{value:this.props.otherColText,onChange:function(t){return e.props.otherColTextChange(t)},placeholder:"Type here"}))));p.push(h);for(var d=function(r){(""===e.props.otherColText||t[r].label.toUpperCase().includes(e.props.otherColText.toUpperCase()))&&p.push(n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement("input",{type:"checkbox",checked:a[r],onChange:function(t){return e.props.toggleOtherNeighbour(t,r,e.props.colIndex)}}),"\xa0","\xa0",t[r].label))))},g=0;g<t.length;++g)d(g);return p}},{key:"render",value:function(){var e=this.createOtherColSelection();return n.a.createElement("div",null,e)}}]),t}(r.Component),W=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createPreviewEle=a.createPreviewEle.bind(Object(v.a)(a)),a.createOriginEle=a.createOriginEle.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createPreviewEle",value:function(){var e=this,t=this.props.previewInfoExpanded,a=this.props.previewInfoArray;t.length!==a.length&&alert("Some error exists!");for(var r=[],l=function(l){if(1===a[l].value.length)r.push(n.a.createElement("div",null,n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-4"},n.a.createElement("b",null,a[l].key,":")),n.a.createElement("div",{className:"col-md-7"},K(a[l].value[0]))),n.a.createElement("br",null)));else if(!1===t[l])r.push(n.a.createElement("div",null,n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-4"},n.a.createElement("b",null,a[l].key,":")),n.a.createElement("div",{className:"col-md-7"},K(a[l].value[0])),n.a.createElement("div",{className:"col-md-1"},n.a.createElement("button",{className:"btn btn-default",onClick:function(t){return e.props.togglePreviewElement(t,l)}},n.a.createElement(m.i,null)))),n.a.createElement("br",null)));else{r.push(n.a.createElement("div",null,n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-4"},n.a.createElement("b",null,a[l].key,":")),n.a.createElement("div",{className:"col-md-7"},K(a[l].value[0])),n.a.createElement("div",{className:"col-md-1"},n.a.createElement("button",{className:"btn btn-default",onClick:function(t){return e.props.togglePreviewElement(t,l)}},n.a.createElement(m.h,null))))));for(var o=1;o<a[l].value.length;++o){var i=o===a[l].value.length-1?n.a.createElement("br",null):null;r.push(n.a.createElement("div",null,n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"offset-md-4 col-md-7"},"- "+K(a[l].value[o]))),i))}}},o=0;o<a.length;++o)l(o);return n.a.createElement("div",null,n.a.createElement("p",null,"Preview of ",n.a.createElement("b",null,K(this.props.selectedCell.data))," is:"),r)}},{key:"createOriginEle",value:function(){for(var e=[],t=0;t<this.props.selectedCell.origin.length;++t)e.push(n.a.createElement("p",null,K(this.props.selectedCell.origin[t])));return n.a.createElement("div",null,n.a.createElement("p",null,"Origin of ",n.a.createElement("b",null,K(this.props.selectedCell.data))," is:"),e)}},{key:"render",value:function(){var e=this.createPreviewEle(),t=this.createOriginEle();return n.a.createElement("div",null,e,n.a.createElement("hr",{className:"preview-origin-divider"}),t)}}]),t}(r.Component);function K(e){return e.replace(/_\(.*?\)/g,"").replace(/_/g," ")}var z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.createPropertyArray=a.createPropertyArray.bind(Object(v.a)(a)),a.createSiblingArray=a.createSiblingArray.bind(Object(v.a)(a)),a.createTableArray=a.createTableArray.bind(Object(v.a)(a)),a.createRecommendArray=a.createRecommendArray.bind(Object(v.a)(a)),a.createStartRecommend=a.createStartRecommend.bind(Object(v.a)(a)),a.createCustomizedUnion=a.createCustomizedUnion.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createTableArray",value:function(e,t){for(var a=this,r=this.props.propertyNeighbours[e].siblingArray[t].tableArray,l=[],o=function(o){for(var i="Table "+o+": ",s=0;s<r[o].title.length;++s)i=i+r[o].title[s]+"|";l.push(n.a.createElement("div",null,n.a.createElement(D.a,{onClick:function(r){return a.props.toggleOtherTable(r,e,t,o)}},i,n.a.createElement(m.k,null)),n.a.createElement(L.a,{isOpen:r[o].isOpen},n.a.createElement(H.a,null,n.a.createElement(U.a,null,n.a.createElement("div",null,n.a.createElement("ul",{className:"list-group list-css"},n.a.createElement("li",{className:"col-md-4 list-group-item list-button list-button-backgound-pink",onClick:function(n){return a.props.unionTable(e,t,r[o].data,r[o].colMapping)}},"Union table")),n.a.createElement("div",{dangerouslySetInnerHTML:{__html:r[o].data.outerHTML}})))))))},i=0;i<r.length;++i)o(i);return l}},{key:"createSiblingArray",value:function(e){for(var t=this,a=this.props.propertyNeighbours[e].siblingArray,r=[],l=!1,o=function(o){var i="Examine tables on page "+a[o].name,s="list-group-item";a[o].isOpen&&(s="list-group-item list-with-background"),!1===l&&0===a[o].tableArray.length&&(l=!0,r.push(n.a.createElement("li",{className:"list-group-item"},n.a.createElement("hr",null),n.a.createElement("h5",null,"Below are sibling pages on which no similar tables are found:"),n.a.createElement("hr",null)))),r.push(n.a.createElement("li",{className:s,title:i},n.a.createElement("span",{onClick:function(a){return t.props.toggleSibling(a,e,o)}},Q(a[o].name)+" ",n.a.createElement(m.g,null)),n.a.createElement(L.a,{isOpen:a[o].isOpen},n.a.createElement("div",null,n.a.createElement("ul",{className:"list-group list-css"},n.a.createElement("li",{className:"col-md-4 list-group-item list-button",onClick:function(a){return t.props.unionPage(e,o)}},"Union from page")),t.createTableArray(e,o)))))},i=0;i<a.length;++i)o(i);return n.a.createElement("ul",{className:"list-group list-css list-group-flush"}," ",r," ")}},{key:"createPropertyArray",value:function(){for(var e=this,t=this.props.propertyNeighbours,a=[],r=function(r){var l=t[r].predicate,o=t[r].object,i="subject"!==l?l+": "+o+" ":o+" ",s="Show other pages with "+l+": "+o,c="list-group-item";e.props.propertyNeighbours[r].isOpen&&(c="list-group-item list-with-background"),a.push(n.a.createElement("li",{class:c,title:s},n.a.createElement("span",{onClick:function(t){return e.props.togglePropertyNeighbours(t,r)}},Q(i),n.a.createElement(m.g,null)),n.a.createElement(L.a,{isOpen:e.props.propertyNeighbours[r].isOpen},n.a.createElement("div",null,n.a.createElement("hr",null),e.createSiblingArray(r)))))},l=0;l<t.length;++l)r(l);return n.a.createElement("ul",{className:"list-group list-css list-group-flush"},a)}},{key:"createRecommendArray",value:function(e,t){for(var a=this,r=[],l=function(l){var o=[{value:t[l].value,type:t[l].type}],i=t[l].label;r.push(n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement(D.a,{onClick:function(t){return a.props.populateRecommendation(t,e,o)}},i))))},o=0;o<t.length;++o)l(o);var i="";if(-1!==this.props.keyColIndex){var s=this.props.tableHeader[this.props.keyColIndex];i=0!==this.props.keyColIndex?G(s):"First Column"}return n.a.createElement("div",{className:"container"},n.a.createElement("p",null,"Attribute recommendations:"),n.a.createElement("p",null,"Current Search Column: ",n.a.createElement("b",null,i)),r)}},{key:"createSameNeighbour",value:function(e){var t=this,a=G(e.neighbourArray);return n.a.createElement("div",{className:"container"},n.a.createElement("p",null,"Some cells in this column contain multiple values."),n.a.createElement("p",null,"Expand all other values that are also"),n.a.createElement("p",null,n.a.createElement("b",null,a)," ?"),n.a.createElement("div",{className:"row"},n.a.createElement(D.a,{className:"col-md-4",onClick:function(a){return t.props.sameNeighbourOneRow(a,e.colIndex,e.neighbourArray)}},"In One Row"),n.a.createElement(D.a,{className:"offset-md-1 col-md-4",onClick:function(a){return t.props.sameNeighbourDiffRow(a,e.colIndex,e.neighbourArray)}},"In Separate Rows")))}},{key:"createStartRecommend",value:function(){for(var e=this,t=[],a=this.props.curActionInfo.recommendArray,r=function(r){var l=[{value:a[r].value,type:a[r].type}],o=a[r].label;t.push(n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement(D.a,{onClick:function(t){return e.props.populateStartRecommend(t,e.props.curActionInfo.colIndex,l)}},o))))},l=0;l<a.length;++l)r(l);var o="";if(-1!==this.props.keyColIndex){var i=this.props.tableHeader[this.props.keyColIndex];o=0!==this.props.keyColIndex?G(i):"First Column"}return n.a.createElement("div",{className:"container"},n.a.createElement("p",null,"Attribute recommendations:"),n.a.createElement("p",null,"Current Search Column: ",n.a.createElement("b",null,o)),t)}},{key:"createCustomizedUnion",value:function(){var e,t=this;e=""===this.props.unionURL?n.a.createElement("div",null,n.a.createElement("p",null,"For customized table, please paste URL below to look for tables.")):n.a.createElement("div",null,n.a.createElement("p",null,"The following tables are from page:"," ",n.a.createElement("b",null,decodeURIComponent(this.props.unionURL.slice(30)))));var a=n.a.createElement("div",null,n.a.createElement("div",{className:"row text-center"},n.a.createElement("div",{className:"col-md-9 offset-md-1"},n.a.createElement("input",{placeholder:"e.g., https://en.wikipedia.org/wiki/Canada",onPaste:function(e){return t.props.handleUnionPaste(e)},className:" form-control"}))),n.a.createElement("br",null)),r=n.a.createElement("div",null,n.a.createElement(M,{originTableArray:this.props.unionTableArray,tableOpenList:this.props.unionOpenList,toggleTable:this.props.toggleUnionTable,listType:"union",buttonFunction:this.props.unionCustomized}));return n.a.createElement("div",null,e,a,r)}},{key:"render",value:function(){var e,t,a,r=this;if(a=""===this.props.usecaseSelected?n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-8"},n.a.createElement("h4",{className:"logo-left-color"},"Insert Data",n.a.createElement("span",null," ")))):n.a.createElement("div",{className:"row action-header"},n.a.createElement("div",{className:"col-md-8"},n.a.createElement("h4",{className:"logo-left-color"},"Insert Data",n.a.createElement("span",null," ")))),""===this.props.usecaseSelected)t=n.a.createElement(_,{handleStartSubject:this.props.handleStartSubject,urlPasted:this.props.urlPasted,showTableSelection:this.props.showTableSelection,toggleTableSelection:this.props.toggleTableSelection,originTableArray:this.props.originTableArray,tableOpenList:this.props.tableOpenList,toggleTable:this.props.toggleTable,selectedTableIndex:this.props.selectedTableIndex,handleStartTable:this.props.handleStartTable});else if(null!==this.props.curActionInfo){var l=this.props.curActionInfo;if("afterStartSubject"===l.task)e=n.a.createElement(q,{firstColSelection:this.props.firstColSelection,firstColChecked:this.props.firstColChecked,firstColText:this.props.firstColText,firstColFilled:this.props.firstColFilled,toggleFirstNeighbour:this.props.toggleFirstNeighbour,firstColTextChange:this.props.firstColTextChange,tableHeader:this.props.tableHeader,keyCheckedIndex:this.props.keyCheckedIndex,populateKeyColumn:this.props.populateKeyColumn,confirmAddFirstCol:this.props.confirmAddFirstCol});else if("showOtherColSelection"===l.task)e=n.a.createElement(V,{otherColSelection:this.props.otherColSelection,otherColChecked:this.props.otherColChecked,otherColText:this.props.otherColText,otherCheckedIndex:this.props.otherCheckedIndex,toggleOtherNeighbour:this.props.toggleOtherNeighbour,otherColTextChange:this.props.otherColTextChange,populateOtherColumn:this.props.populateOtherColumn,colIndex:l.colIndex});else if("plusClicked"===l.task)e=0!==this.props.keyColIndex?n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement("b",null,"Please set the first column as the search column before adding more entities to it."))):n.a.createElement("div",null,n.a.createElement("p",null,"Add more entities to the first column?"),n.a.createElement(D.a,{onClick:function(){return r.props.addToFirstCol()}},"OK"));else if("afterPopulateColumn"===l.task)e=n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement("b",null,"Fill an empty column")," by clicking on its ",n.a.createElement("b",null,"edit icon")),n.a.createElement("p",null,"OR"),n.a.createElement("p",null,n.a.createElement("b",null,"Add a new column")," by clicking on a column's ",n.a.createElement("b",null,"plus icon")));else if("populateKeyColumn"===l.task){for(var o="",i=0;i<l.neighbourArray.length;++i)i>0&&(o+=" & "),o+=l.neighbourArray[i].label;e=""!==o?n.a.createElement("div",null,n.a.createElement("p",null,"Fill this column with:"),n.a.createElement("p",null,n.a.createElement("b",null,o)," ?"),n.a.createElement(D.a,{onClick:function(e){return r.props.populateKeyColumn(e,l.colIndex,l.neighbourArray)}},"OK")):n.a.createElement("div",null,n.a.createElement("p",{className:"suggestion-text"},"Fill the ",n.a.createElement("b",null,"first column header")," by choosing from its"," ",n.a.createElement("b",null,"down arrow")))}else if("populateOtherColumn"===l.task){var s=G(l.neighbourArray);e=n.a.createElement("div",null,n.a.createElement("p",null,"Fill this column with:"),n.a.createElement("p",null,n.a.createElement("b",null,s)," ?"),n.a.createElement(D.a,{onClick:function(e){return r.props.populateOtherColumn(e,l.colIndex,l.neighbourArray)}},"OK"))}else if("populateSameNeighbour"===l.task)e=this.createSameNeighbour(l);else if("populateRecommendation"===l.task){var c=this.createRecommendArray(l.colIndex,l.recommendArray);e=n.a.createElement("div",null,c)}else if("sameNeighbourAndRecommendation"===l.task){var u=this.createSameNeighbour(l),p=this.createRecommendArray(l.colIndex,l.recommendArray);e=n.a.createElement("div",null,n.a.createElement(H.a,{className:"action-panel-card"},p),n.a.createElement("br",null),n.a.createElement(H.a,{className:"action-panel-card"},u))}else if("showFilterMethods"===l.task){var h=null;h=0===l.colIndex?n.a.createElement("p",null,n.a.createElement("b",null,"How would you like to process the first column?")):n.a.createElement("p",null,n.a.createElement("b",null,"How would you like to process column"," ",G(this.props.tableHeader[l.colIndex])," ","?")),e=n.a.createElement("div",null,n.a.createElement("div",null,h),n.a.createElement("div",null,n.a.createElement(D.a,{onClick:function(e){return r.props.contextSortColumn(e,l.colIndex,"ascending")}},"Sort ascending")),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(D.a,{onClick:function(e){return r.props.contextSortColumn(e,l.colIndex,"descending")}},"Sort descending")),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(D.a,{onClick:function(e){return r.props.openFilter(e,l.colIndex)}},"Filter this column")),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(D.a,{onClick:function(e){return r.props.contextDedupColumn(e,l.colIndex)}},"Dedup this column")))}else if("contextCellOrigin"===l.task)e=n.a.createElement("div",null,n.a.createElement("p",null,"Origin of selected cell is:"),n.a.createElement("div",null,l.origin));else if("originPreviewPage"===l.task)e=n.a.createElement(W,{previewInfoArray:this.props.previewInfoArray,previewInfoExpanded:this.props.previewInfoExpanded,selectedCell:this.props.selectedCell,togglePreviewElement:this.props.togglePreviewElement});else if("showStartRecommend"===l.task){var d=this.createStartRecommend();e=n.a.createElement("div",null,d)}else if("sameNeighbourAndStartRecommend"===l.task){var g=this.createSameNeighbour(l),b=this.createStartRecommend();e=n.a.createElement("div",null,n.a.createElement(H.a,{className:"action-panel-card"},b),n.a.createElement("br",null),n.a.createElement(H.a,{className:"action-panel-card"},g))}}if("startSubject"===this.props.usecaseSelected){var v=this.props.tabIndex;t=n.a.createElement("div",{className:"height-inherit"},n.a.createElement(J.d,{selectedIndex:v,onSelect:function(e){return r.props.handleTabSwitch(e)}},n.a.createElement(J.b,null,n.a.createElement(J.a,null,"From DBpedia"),n.a.createElement(J.a,null,"From Wiki Tables")),n.a.createElement("div",{className:"action-scrollable"},n.a.createElement(J.c,null,e),n.a.createElement(J.c,null,n.a.createElement("div",null,n.a.createElement("ul",{class:"list-group list-css list-group-flush"},n.a.createElement("hr",{className:"m-0"}),n.a.createElement("li",{className:"list-group-item"},n.a.createElement("span",{onClick:function(e){return r.props.toggleUnionJoin(e,"union")}},"Union Tables from Wikipedia"),n.a.createElement(L.a,{isOpen:this.props.showUnionTables},n.a.createElement(U.a,null,n.a.createElement(H.a,null,this.createCustomizedUnion())))),n.a.createElement("li",{className:"list-group-item"},n.a.createElement("span",{onClick:function(e){return r.props.toggleUnionJoin(e,"join")}},"Join Tables from Wikipedia"),n.a.createElement(L.a,{isOpen:this.props.showJoinTables},n.a.createElement(U.a,null,n.a.createElement(H.a,null,n.a.createElement("p",null,"The following tables are from page:"," ",n.a.createElement("b",null,decodeURIComponent(this.props.urlPasted.slice(30)))),n.a.createElement(M,{originTableArray:this.props.originTableArray,tableOpenList:this.props.tableOpenList,toggleTable:this.props.toggleTable,buttonFunction:this.props.handleJoinTable,listType:"join"}))))),n.a.createElement("hr",{className:"m-0"})))))))}else if("startTable"===this.props.usecaseSelected)if(-1!==this.props.selectedTableIndex){var f=this.props.tabIndex;t=n.a.createElement("div",{className:"height-inherit"},n.a.createElement(J.d,{selectedIndex:f,onSelect:function(e){return r.props.handleTabSwitch(e)},className:"height-inherit"},n.a.createElement(J.b,null,n.a.createElement(J.a,null,"From DBpedia"),n.a.createElement(J.a,null,"From Wiki Tables")),n.a.createElement("div",{className:"action-scrollable"},n.a.createElement(J.c,null,e),n.a.createElement(J.c,null,n.a.createElement("div",null,n.a.createElement("ul",{class:"list-group list-css list-group-flush"},n.a.createElement("hr",{className:"m-0"}),n.a.createElement("li",{className:"list-group-item"},n.a.createElement("span",{onClick:function(e){return r.props.toggleUnionJoin(e,"union")}},"Union Tables from Wikipedia"),n.a.createElement(L.a,{isOpen:this.props.showUnionTables},n.a.createElement(U.a,null,n.a.createElement(H.a,null,"Expand relations below to look at other pages with similar tables:",n.a.createElement("br",null),this.createPropertyArray())))),n.a.createElement("li",{className:"list-group-item"},n.a.createElement("span",{onClick:function(e){return r.props.toggleUnionJoin(e,"join")}},"Join Tables from Wikipedia"),n.a.createElement(L.a,{isOpen:this.props.showJoinTables},n.a.createElement(U.a,null,n.a.createElement(H.a,null,n.a.createElement("p",null,"The following tables are from page:"," ",n.a.createElement("b",null,decodeURIComponent(this.props.urlPasted.slice(30)))),n.a.createElement(M,{originTableArray:this.props.originTableArray,tableOpenList:this.props.tableOpenList,toggleTable:this.props.toggleTable,buttonFunction:this.props.handleJoinTable,listType:"join"}))))),n.a.createElement("hr",{className:"m-0"})))))))}else t=e;return n.a.createElement("div",{className:"height-inherit"},n.a.createElement("div",null,a),n.a.createElement("div",{className:"height-inherit"},t))}}]),t}(r.Component);function G(e){for(var t="",a=0;a<e.length;++a){a>0&&(t+=" OR "),t+="object"===e[a].type?"is "+e[a].value+" of":e[a].value}return t}function Q(e){return e.replace(/_\(.*?\)/g,"").replace(/_/g," ")}var Y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=null,a="small-padding wiki-page-hidden";if(""!==this.props.iframeURL){var r=n.a.createElement("button",{className:"btn btn-sm btn-info toggle-button",onClick:function(){return e.props.toggleWikiPage()}},n.a.createElement("i",{class:"fa fa-chevron-up","aria-hidden":"true"}),"Show");this.props.pageHidden||(a="small-padding wiki-page",r=n.a.createElement("div",null,n.a.createElement("hr",{className:"m-1"}),n.a.createElement("button",{className:"btn btn-sm btn-info toggle-button",onClick:function(){return e.props.toggleWikiPage()}},n.a.createElement("i",{class:"fa fa-chevron-down","aria-hidden":"true"}),"Hide"))),t=n.a.createElement("div",{className:"page-panel text-right"},r,n.a.createElement("div",{className:a},n.a.createElement("iframe",{id:"iframe",title:"URLPage",src:this.props.iframeURL,className:"iframe-cls"})))}return n.a.createElement("div",null,t)}}]),t}(r.Component),$=a(5),Z=a.n($),ee=function(e){function t(e){var a;Object(i.a)(this,t),a=Object(c.a)(this,Object(u.a)(t).call(this,e));for(var r=[],n=[],l=[],o=[],s=[],p=0;p<20;++p){for(var h=[],d=0;d<4;++d)h.push({data:"",origin:[]});r.push(h)}for(var g=0;g<4;++g)o.push([]),s.push([]);for(var b=0;b<4;++b){l.push([]),n.push([])}return a.state={urlPasted:"",tablePasted:"",usecaseSelected:"",pageHidden:!1,iframeURL:"",curActionInfo:null,lastAction:"",prevState:"",showSetting:!1,showTableSelection:!1,tabIndex:1,showUnionTables:!1,showJoinTables:!1,keyColIndex:0,tableHeader:n,tableData:r,optionsMap:l,keyColNeighbours:[],firstDegNeighbours:[],firstColSelection:[],firstColChecked:[],firstColFilled:!1,firstColText:"",keyCheckedIndex:-1,firstColHeaderInfo:[],otherColSelection:[],otherColChecked:[],otherCheckedIndex:-1,otherColText:"",originTableArray:[],tableOpenList:[],selectedTableIndex:-1,selectedClassAnnotation:[],tableDataExplore:[],propertyNeighbours:[],semanticEnabled:"disabled",unionCutOff:.5,showFilter:!1,checkAll:!0,curFilterIndex:-1,dataAndChecked:[],filterMin:null,filterMax:null,showJoinModal:!1,joinTableIndex:-1,joinTableData:[],originColOptions:[],joinColOptions:[],originJoinIndex:-1,joinJoinIndex:-1,joinPairRecord:[],previewColIndex:-1,selectedCell:null,previewInfoArray:[],previewInfoExpanded:[],unionURL:"",unionTableArray:[],unionOpenList:[],showUnionModal:!1,semanticTree:o,typeRecord:s},a.handleURLPaste=a.handleURLPaste.bind(Object(v.a)(a)),a.handleStartSubject=a.handleStartSubject.bind(Object(v.a)(a)),a.handleStartTable=a.handleStartTable.bind(Object(v.a)(a)),a.cellChange=a.cellChange.bind(Object(v.a)(a)),a.selectColHeader=a.selectColHeader.bind(Object(v.a)(a)),a.getKeyOptions=a.getKeyOptions.bind(Object(v.a)(a)),a.getOtherOptions=a.getOtherOptions.bind(Object(v.a)(a)),a.getNeighbourPromise=a.getNeighbourPromise.bind(Object(v.a)(a)),a.populateKeyColumn=a.populateKeyColumn.bind(Object(v.a)(a)),a.getOtherColPromise=a.getOtherColPromise.bind(Object(v.a)(a)),a.populateOtherColumn=a.populateOtherColumn.bind(Object(v.a)(a)),a.addAllNeighbour=a.addAllNeighbour.bind(Object(v.a)(a)),a.getTableStates=a.getTableStates.bind(Object(v.a)(a)),a.sameNeighbourDiffRow=a.sameNeighbourDiffRow.bind(Object(v.a)(a)),a.sameNeighbourOneRow=a.sameNeighbourOneRow.bind(Object(v.a)(a)),a.contextAddColumn=a.contextAddColumn.bind(Object(v.a)(a)),a.contextDeleteColumn=a.contextDeleteColumn.bind(Object(v.a)(a)),a.contextSetColumn=a.contextSetColumn.bind(Object(v.a)(a)),a.originPreviewPage=a.originPreviewPage.bind(Object(v.a)(a)),a.contextSortColumn=a.contextSortColumn.bind(Object(v.a)(a)),a.contextDedupColumn=a.contextDedupColumn.bind(Object(v.a)(a)),a.showFilterMethods=a.showFilterMethods.bind(Object(v.a)(a)),a.toggleTable=a.toggleTable.bind(Object(v.a)(a)),a.togglePropertyNeighbours=a.togglePropertyNeighbours.bind(Object(v.a)(a)),a.toggleSibling=a.toggleSibling.bind(Object(v.a)(a)),a.toggleOtherTable=a.toggleOtherTable.bind(Object(v.a)(a)),a.unionTable=a.unionTable.bind(Object(v.a)(a)),a.unionPage=a.unionPage.bind(Object(v.a)(a)),a.unionProperty=a.unionProperty.bind(Object(v.a)(a)),a.toggleSemantic=a.toggleSemantic.bind(Object(v.a)(a)),a.unionCutOffChange=a.unionCutOffChange.bind(Object(v.a)(a)),a.copyTable=a.copyTable.bind(Object(v.a)(a)),a.toggleWikiPage=a.toggleWikiPage.bind(Object(v.a)(a)),a.undoPreviousStep=a.undoPreviousStep.bind(Object(v.a)(a)),a.handleTabSwitch=a.handleTabSwitch.bind(Object(v.a)(a)),a.openModal=a.openModal.bind(Object(v.a)(a)),a.closeModal=a.closeModal.bind(Object(v.a)(a)),a.toggleTableSelection=a.toggleTableSelection.bind(Object(v.a)(a)),a.toggleUnionJoin=a.toggleUnionJoin.bind(Object(v.a)(a)),a.openFilter=a.openFilter.bind(Object(v.a)(a)),a.cancelFilter=a.cancelFilter.bind(Object(v.a)(a)),a.toggleChecked=a.toggleChecked.bind(Object(v.a)(a)),a.toggleAll=a.toggleAll.bind(Object(v.a)(a)),a.applyFilter=a.applyFilter.bind(Object(v.a)(a)),a.handleRangeFilter=a.handleRangeFilter.bind(Object(v.a)(a)),a.handleJoinTable=a.handleJoinTable.bind(Object(v.a)(a)),a.cancelJoin=a.cancelJoin.bind(Object(v.a)(a)),a.selectJoinColumn=a.selectJoinColumn.bind(Object(v.a)(a)),a.runJoin=a.runJoin.bind(Object(v.a)(a)),a.toggleFirstNeighbour=a.toggleFirstNeighbour.bind(Object(v.a)(a)),a.handlePlusClick=a.handlePlusClick.bind(Object(v.a)(a)),a.addToFirstCol=a.addToFirstCol.bind(Object(v.a)(a)),a.confirmAddFirstCol=a.confirmAddFirstCol.bind(Object(v.a)(a)),a.firstColTextChange=a.firstColTextChange.bind(Object(v.a)(a)),a.toggleOtherNeighbour=a.toggleOtherNeighbour.bind(Object(v.a)(a)),a.otherColTextChange=a.otherColTextChange.bind(Object(v.a)(a)),a.togglePreviewElement=a.togglePreviewElement.bind(Object(v.a)(a)),a.populateRecommendation=a.populateRecommendation.bind(Object(v.a)(a)),a.createStartRecommend=a.createStartRecommend.bind(Object(v.a)(a)),a.populateStartRecommend=a.populateStartRecommend.bind(Object(v.a)(a)),a.handleUnionPaste=a.handleUnionPaste.bind(Object(v.a)(a)),a.toggleUnionTable=a.toggleUnionTable.bind(Object(v.a)(a)),a.showUnionAlign=a.showUnionAlign.bind(Object(v.a)(a)),a.cancelUnionAlign=a.cancelUnionAlign.bind(Object(v.a)(a)),a.hardcodeUnion=a.hardcodeUnion.bind(Object(v.a)(a)),a.handleFileChange=a.handleFileChange.bind(Object(v.a)(a)),a.unionCustomized=a.unionCustomized.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"handleURLPaste",value:function(e){var t=this;if(document.body.classList.add("waiting"),e.includes("https://en.wikipedia.org/wiki/")){var a=[];a.push(ae(e)),re(a).then((function(a){for(var r=a[0],n=(new DOMParser).parseFromString(r,"text/html").getElementsByClassName("wikitable"),l=[],o=0;o<n.length;++o)"TABLE"===n[o].tagName&&void 0!==n[o].rows&&l.push(n[o]);console.log(l);for(var i=[],s=0;s<l.length;++s)i.push(!1);document.body.classList.remove("waiting");t.setState({originTableArray:l,tableOpenList:i,urlPasted:e,iframeURL:e,lastAction:"handleURLPaste",prevState:{urlPasted:"",iframeURL:"",originTableArray:[],tableOpenList:[]}})}))}else document.body.classList.remove("waiting"),alert("Please paste a valid Wikipedia link.")}},{key:"copyTable",value:function(){var e=document.createElement("textarea"),t="";if("startSubject"===this.state.usecaseSelected||"startTable"===this.state.usecaseSelected){for(var a=this.state.tableHeader,r=0;r<a.length;++r){var n="";if(0===r)if("startTable"===this.state.usecaseSelected)n="OriginURL";else for(var l=0;l<a[r].length;++l)l>0&&(n+=" AND "),n+=fe(a[r][l].oValue);else for(var o=0;o<a[r].length;++o){o>0&&(n+=" OR "),n+="object"===a[r][o].type?"is "+a[r][o].value+" of":a[r][o].value}t=t+n+"\t"}t+="\n";for(var i=this.state.tableData,s=i.length,c=i[0].length,u=0;u<s;++u){for(var p=0;p<c;++p){var h=fe(i[u][p].data);void 0!==h&&(t=t+h+"\t")}t+="\n"}}e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),alert("Table content has been exported!")}},{key:"toggleWikiPage",value:function(){var e=this.state.pageHidden;this.setState({pageHidden:!e})}},{key:"handleStartSubject",value:function(e,t){var a=this;if("startSubject"===t){document.body.classList.add("waiting");var r=decodeURIComponent(this.state.urlPasted.slice(30)),n=Z.a.cloneDeep(this.state.tableData);n[0][0].data=r;re([te("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("select+%3Fp+%3Fo%0D%0Awhere+%7B%0D%0Adbr%3A"+ne(r)+"+%3Fp+%3Fo.%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+")]).then((function(e){for(var r=function(e){var t=e.filter((function(e){return e.p.value.slice(28).length>1&&(e.p.value.includes("ontology")||e.p.value.includes("property")||e.p.value.includes("dc/terms/subject"))&&!(e.p.value.includes("wikiPage")||e.p.value.includes("align")||e.p.value.includes("abstract")||e.p.value.includes("caption")||e.p.value.includes("image")||e.p.value.includes("width")||e.p.value.includes("thumbnail")||e.p.value.includes("blank")||e.p.value.includes("fec")||e.p.value.includes("viaf")||e.p.value.includes("soundRecording")||e.p.value.includes("votesmart")||e.p.value.includes("wordnet")||e.p.value.includes("float")||e.p.value.includes("bbr")||"http://dbpedia.org/property/alt"===e.p.value||"http://dbpedia.org/property/by"===e.p.value||"http://dbpedia.org/property/onlinebooks"===e.p.value||"http://dbpedia.org/property/signature"===e.p.value||"http://dbpedia.org/property/video"===e.p.value||"http://dbpedia.org/property/logo"===e.p.value||"http://dbpedia.org/property/shorts"===e.p.value||"http://dbpedia.org/property/patternS"===e.p.value||"http://dbpedia.org/property/patternB"===e.p.value||"http://dbpedia.org/property/body"===e.p.value||"http://dbpedia.org/property/hShorts"===e.p.value||"http://dbpedia.org/property/hPatternS"===e.p.value||"http://dbpedia.org/property/hPatternB"===e.p.value||"http://dbpedia.org/property/hBody"===e.p.value||"http://dbpedia.org/property/aShorts"===e.p.value||"http://dbpedia.org/property/aPatternS"===e.p.value||"http://dbpedia.org/property/aPatternB"===e.p.value||"http://dbpedia.org/property/aBody"===e.p.value||"http://dbpedia.org/property/3Shorts"===e.p.value||"http://dbpedia.org/property/3PatternS"===e.p.value||"http://dbpedia.org/property/3PatternB"===e.p.value||"http://dbpedia.org/property/3Body"===e.p.value||"http://dbpedia.org/property/nba"===e.p.value||"http://dbpedia.org/ontology/termPeriod"===e.p.value)}));t=t.sort((function(e,t){return e.p.value.slice(28)>t.p.value.slice(28)?1:e.p.value.slice(28)<t.p.value.slice(28)?-1:e.p.value.includes("ontology")&&t.p.value.includes("property")?-1:1}));for(var a=1;a<t.length;++a)t[a].p.value.includes("property")&&t[a-1].p.value.includes("ontology")&&t[a].p.value.slice(28)===t[a-1].p.value.slice(28)&&(t.splice(a,1),--a);for(var r=[],n=[],l=0;l<t.length;++l)"http://purl.org/dc/terms/subject"===t[l].p.value?r.push(t[l]):n.push(t[l]);r.sort((function(e,t){return e.o.value.slice(37)<t.o.value.slice(37)?-1:1})),n.sort((function(e,t){return e.p.value.slice(28)<t.p.value.slice(28)?-1:1})),n.length>0&&(n[0].p.count=ke(n[0].p.value,n));for(var o=1;o<n.length;++o){var i=n[o-1],s=n[o];i.p.value===s.p.value?s.p.count=i.p.count:s.p.count=ke(n[o].p.value,n)}n.sort((function(e,t){return void 0===e.o.datatype&&void 0!==t.o.datatype?-1:void 0===t.o.datatype&&void 0!==e.o.datatype?1:e.p.count===t.p.count?e.p.value.slice(28)<t.p.value.slice(28)?-1:1:e.p.count<t.p.count?-1:1})),t=r.concat(n);for(var c=[],u=0;u<t.length;++u)"http://purl.org/dc/terms/subject"===t[u].p.value?c.push({pValue:"category",pDataset:"dct",oValue:t[u].o.value.slice(37),oType:"",value:"category",label:t[u].o.value.slice(37)}):c.push({pValue:t[u].p.value.slice(28),pDataset:t[u].p.value.includes("property")?"dbp":"dbo",oValue:oe(t[u].o.value),oType:void 0===t[u].o.datatype?"":t[u].o.datatype,value:t[u].p.value.slice(28),label:t[u].p.value.slice(28)+":"+oe(t[u].o.value)});return c}(e[0].results.bindings),l=[],o=0;o<r.length;++o)l.push(!1);var i={usecaseSelected:a.state.usecaseSelected,tableData:a.state.tableData,tabIndex:a.state.tabIndex,curActionInfo:a.state.curActionInfo,firstColSelection:a.state.firstColSelection,firstColChecked:a.state.firstColChecked};document.body.classList.remove("waiting"),a.setState({usecaseSelected:t,tableData:n,firstColSelection:r,firstColChecked:l,curActionInfo:{task:"afterStartSubject"},tabIndex:0,firstColText:"",lastAction:"handleStartSubject",prevState:i})}))}}},{key:"toggleFirstNeighbour",value:function(e,t){var a=this.state.firstColChecked.slice(),r=t;a[t]=!a[t],this.setState({firstColChecked:a,keyCheckedIndex:r,firstColText:""})}},{key:"firstColTextChange",value:function(e){e.preventDefault();var t=e.target.value;this.setState({firstColText:t})}},{key:"toggleOtherNeighbour",value:function(e,t,a){var r,n=Z.a.cloneDeep(this.state.tableData),l=Z.a.cloneDeep(this.state.otherColChecked),o=t;l[t]=!l[t];for(var i=[],s=0;s<l.length;++s)!0===l[s]&&i.push(this.state.otherColSelection[s]);if(i.length>0){for(var c=0;c<n.length;++c){for(var u=[],p=0;p<i.length;++p){var h=i[p],d=("subject"===h.type?this.state.firstDegNeighbours.subject:this.state.firstDegNeighbours.object)[c][h.value];void 0!==d&&(u=u.concat(d))}0===u.length?n[c][a].previewData="N/A":n[c][a].previewData=u[0]}r=a}else r=-1;var g={otherColChecked:this.state.otherColChecked,otherColCheckedIndex:this.state.otherCheckedIndex,tableData:this.state.tableData,previewColIndex:this.state.previewColIndex};this.setState({otherColChecked:l,otherCheckedIndex:o,tableData:n,previewColIndex:r,otherColText:"",lastAction:"toggleOtherNeighbour",prevState:g})}},{key:"otherColTextChange",value:function(e){e.preventDefault();var t=e.target.value;this.setState({otherColText:t})}},{key:"handlePlusClick",value:function(){this.setState({curActionInfo:{task:"plusClicked"},previewColIndex:-1,tabIndex:0})}},{key:"addToFirstCol",value:function(){for(var e=[],t=0;t<this.state.firstColChecked.length;++t)e.push(!1);this.setState({firstColChecked:e,keyCheckedIndex:-1,curActionInfo:{task:"afterStartSubject"},firstColText:""})}},{key:"cellChange",value:function(e,t,a){e.preventDefault();var r=this.state.tableData.slice();r[t][a].data=e.target.value;var n=Z.a.cloneDeep(this.state.tableHeader);0===n[a].length&&(n[a]=[{value:"Notes",label:"Notes",type:"subject"}]),this.setState({tableData:r,tableHeader:n})}},{key:"getKeyOptions",value:function(e,t){var a=this;if(t===this.state.keyColIndex){for(var r=[],n=0;n<this.state.tableData.length&&""!==this.state.tableData[n][t].data;++n)r.push(ne(this.state.tableData[n][t].data));for(var l="SELECT+%3Fsomevar%0D%0AWHERE+%7B",o=0;o<r.length;++o)l+="%0D%0A++++++++dbr%3A"+r[o]+"+%28dct%3Asubject%7Crdf%3Atype%29+%3Fsomevar.";var i="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+l+"%0D%0A%7D%0D%0A&format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+",s=[];s.push(te(i)),re(s).then((function(e){for(var t=e[0],r=[],n=0;n<t.results.bindings.length;++n){var l=t.results.bindings[n].somevar.value;if(l.includes("dbpedia.org/resource/Category:")){var o={},i=l.slice(37);o.label=i,o.value=i,o.dataset="dct",r.push(o)}else if(l.includes("dbpedia.org/ontology/")&&!l.includes("Wikidata")){var s={},c=l.slice(28);s.label=c,s.value=c,s.dataset="rdf",r.push(s)}}var u=a.state.optionsMap.slice();u[a.state.keyColIndex]=r,a.setState({optionsMap:u})}))}}},{key:"getOtherOptions",value:function(e,t){for(var a=this,r=[],n=!0,l=!0,o=[],i=0;i<this.state.tableData.length;++i)""!==this.state.tableData[i][t].data?(n=!1,o.push([i,this.state.tableData[i][t].data])):l=!1;if(!1===n&&!1===l){document.body.classList.add("waiting");for(var s="SELECT+%3Fsomevar%0D%0AWHERE+%7B",c=0;c<1;++c){s+="%0D%0A++++++++dbr%3A"+ne(this.state.tableData[o[c][0]][this.state.keyColIndex].data)+"+%3Fsomevar+dbr%3A"+ne(o[c][1])+"."}var u="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+s+"%0D%0A%7D%0D%0A%0D%0A&format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+",p=[];p.push(te(u)),re(p).then((function(e){for(var n=e[0],l=[],o=0;o<n.results.bindings.length;++o){var i={},s=n.results.bindings[o].somevar.value.slice(28);i.label=s,i.value=s,i.type="subject",l.push(i)}for(var c=0;c<l.length;++c)for(var u=0;u<a.state.keyColNeighbours.length;++u)if(l[c].value===a.state.keyColNeighbours[u].value&&l[c].type===a.state.keyColNeighbours[u].type){r.push(a.state.keyColNeighbours[u]);break}0===r.length&&(r=a.state.keyColNeighbours);for(var p=[],h=0;h<r.length;++h)p.push(!1);var d={task:"showOtherColSelection",colIndex:t};document.body.classList.remove("waiting"),a.setState({otherColSelection:r,otherColChecked:p,otherColText:"",otherCheckedIndex:-1,curActionInfo:d,previewColIndex:-1})}))}else{r=this.state.keyColNeighbours;for(var h=[],d=0;d<r.length;++d)h.push(!1);var g={task:"showOtherColSelection",colIndex:t};window.scrollTo(0,0),this.setState({otherColSelection:r,otherColChecked:h,otherColText:"",otherCheckedIndex:-1,curActionInfo:g,previewColIndex:-1})}}},{key:"selectColHeader",value:function(e,t){var a=this.state.tableHeader.slice();if(null!==e){var r=Z.a.cloneDeep(e);if(a[t]=r,t===this.state.keyColIndex){var n={task:"populateKeyColumn"};n.colIndex=t,n.neighbourArray=[];for(var l=0;l<r.length;++l)n.neighbourArray.push(r[l]);this.setState({tableHeader:a,curActionInfo:n})}else{for(var o="",i=0;i<a[this.state.keyColIndex].length;++i){o+=i>0?"&"+a[this.state.keyColIndex][i].label:a[this.state.keyColIndex][i].label}for(var s=0;s<r.length;++s){var c="subject"===a[t][s].type?a[t][s].value:"is "+a[t][s].value+" of";a[t][s].label=c+"--"+o}var u={task:"populateOtherColumn"};u.colIndex=t,u.neighbourArray=[];for(var p=0;p<r.length;++p)u.neighbourArray.push(r[p]);this.setState({tableHeader:a,curActionInfo:u})}}}},{key:"getNeighbourPromise",value:function(e,t,a){for(var r=[],n=0;n<e.length;++n){var l="N/A"===e[n][a].data?"NONEXISTINGSTRING":ne(e[n][a].data),o=te("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("subject"===t?"select+%3Fp+%3Fo+%3Frange+%3FsubPropertyOf%0D%0Awhere+%7B%0D%0Adbr%3A"+l+"+%3Fp+%3Fo.%0D%0AOPTIONAL+%7B%3Fp+rdfs%3Arange+%3Frange%7D.%0D%0AOPTIONAL+%7B%3Fp+rdfs%3AsubPropertyOf+%3FsubPropertyOf%7D.%0D%0A%7D&":"select+%3Fs+%3Fp+%3Frange+%3FsubPropertyOf%0D%0Awhere+%7B%0D%0A%3Fs+%3Fp+dbr%3A"+l+".%0D%0AOPTIONAL+%7B%3Fp+rdfs%3Arange+%3Frange%7D.%0D%0AOPTIONAL+%7B%3Fp+rdfs%3AsubPropertyOf+%3FsubPropertyOf%7D.%0D%0A%7B%0D%0Aselect+%3Fp+%28count%28%3Fs%29+as+%3Fcount%29+%0D%0Awhere+%7B%0D%0A%3Fs+%3Fp+dbr%3A"+l+"%0D%0A%7D%0D%0Agroup+by+%3Fp%0D%0Ahaving+%28count%28%3Fs%29+%3C%3D+30%29%0D%0A%7D%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(o)}return r}},{key:"populateKeyColumn",value:function(e,t,a){var r=this,n=Ae(a);"ERROR"===n?alert("Unsupported datatype in selected neighbours. Please select some other neighbours."):(document.body.classList.add("waiting"),re([te(n)]).then((function(e){var n=Z.a.cloneDeep(r.state.tableHeader);n[0]=a;var l=[];l.push(a);var o=Z.a.cloneDeep(r.state.tableData);0===r.state.tableHeader[0].length&&(o=function(e,t,a,r){var n=Math.min(e.length,20);if(t.length>n)t=t.slice(0,n);else if(t.length<n)for(var l=n-t.length,o=0;o<l;++o){for(var i=[],s=0;s<4;++s)i.push({data:"",origin:[]});t.push(i)}for(var c=t.length,u=c,p=0;p<c&&""!==t[p][r].data;++p)u--;for(var h=c-u,d=0;d<u;++d)t[d+h][r].data=e[d].somevar.value.slice(28);for(var g=0;g<c;++g){var b=t[g][r].data;t[g][r].origin.push(b)}return t=Z.a.uniqBy(t,(function(e){return e[0].data}))}(e[0].results.bindings,o,0,t));var i=r.getNeighbourPromise(o,"subject",t),s=r.getNeighbourPromise(o,"object",t),c=Z.a.sampleSize(o,Math.min(o.length,3)),u=je(c,0);re(i).then((function(e){re(s).then((function(a){re(u).then((function(i){var s=Ie(e),u=Ne(e,a),p=u.keyColNeighbours,h=u.firstDegNeighbours,d=Te(c,0,i),g=Z.a.cloneDeep(r.state.typeRecord);g[0]=d;var b={task:"showStartRecommend"};b.colIndex=t,b.recommendArray=r.createStartRecommend(p);var v={keyColIndex:r.state.keyColIndex,keyColNeighbours:r.state.keyColNeighbours,firstDegNeighbours:r.state.firstDegNeighbours,curActionInfo:r.state.curActionInfo,tableData:r.state.tableData,tableHeader:r.state.tableHeader,firstColFilled:r.state.firstColFilled,firstColHeaderInfo:r.state.firstColHeaderInfo,firstColSelection:r.state.firstColSelection,firstColChecked:r.state.firstColChecked,typeRecord:r.state.typeRecord};document.body.classList.remove("waiting"),r.setState({keyColIndex:t,keyColNeighbours:p,firstDegNeighbours:h,curActionInfo:b,tableData:o,tableHeader:n,firstColFilled:!0,firstColHeaderInfo:l,firstColText:"",lastAction:"populateKeyColumn",prevState:v,firstColSelection:s.firstColSelection,firstColChecked:s.firstColChecked,typeRecord:g})}))}))}))})))}},{key:"confirmAddFirstCol",value:function(e,t){var a=this,r=xe(this.state.tableData),n=Ae(t);"ERROR"===n?alert("Unsupported datatype in selected neighbours. Please select some other neighbours."):(document.body.classList.add("waiting"),re([te(n)]).then((function(e){for(var n=Math.min(e[0].results.bindings.length,20),l=[],o=0;o<n;++o){for(var i=[],s=0;s<a.state.tableHeader.length;++s)0===s?i.push({data:e[0].results.bindings[o].somevar.value.slice(28),origin:[e[0].results.bindings[o].somevar.value.slice(28)]}):i.push({data:"",origin:[]});l.push(i)}var c=a.state.tableData.length;l=Z.a.cloneDeep(a.state.tableData).concat(l),l=Z.a.uniqBy(l,(function(e){return e[0].data}));var u=a.getNeighbourPromise(l,"subject",0),p=a.getNeighbourPromise(l,"object",0),h=r.columnInfo,d=we(l,h,c,"startSubject",-1);re(u).then((function(e){re(p).then((function(n){re(d).then((function(o){for(var i=Ie(e),s=Ne(e,n),u=s.keyColNeighbours,p=s.firstDegNeighbours,d=Se(h,o,"startSubject"),g=0,b=0;b<h.length;++b){var v=b+1;1===h[b].length&&(l=De(l,h[b],v,c,p,a.state.keyColIndex)),2!==h[b].length&&3!==h[b].length||(l=Oe(l,h[b],d[g],v,c),++g)}document.body.classList.remove("waiting"),r.longHopWarning&&alert("Neighbours more than 3 hops away is not autofilled.");var f=Z.a.cloneDeep(a.state.firstColHeaderInfo);f.push(t);var m={tableData:a.state.tableData,keyColNeighbours:a.state.keyColNeighbours,firstDegNeighbours:a.state.firstDegNeighbours,firstColHeaderInfo:a.state.firstColHeaderInfo,previewColIndex:a.state.previewColIndex,firstColSelection:a.state.firstColSelection,firstColChecked:a.state.firstColChecked};a.setState({tableData:l,keyColNeighbours:u,firstDegNeighbours:p,firstColHeaderInfo:f,curActionInfo:{task:"afterPopulateColumn"},previewColIndex:-1,firstColText:"",firstColSelection:i.firstColSelection,firstColChecked:i.firstColChecked,lastAction:"confirmAddFirstCol",prevState:m})}))}))}))})))}},{key:"getOtherColPromise",value:function(e,t){for(var a=[],r=0;r<this.state.tableData.length;++r){var n=ne(this.state.tableData[r][this.state.keyColIndex].data);"N/A"===n&&(n="NONEXISTINGSTRING");var l=te("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("subject"===t?"SELECT+%3Fsomevar%0D%0AWHERE+%7B%0D%0A++++++++dbr%3A"+n+"+%28dbo%3A"+ne(e)+"%7Cdbp%3A"+ne(e)+"%29+%3Fsomevar.%0D%0A%7D%0D%0A%0D%0A&":"SELECT+%3Fsomevar+%0D%0AWHERE+%7B%0D%0A++++++++%3Fsomevar+%28dbo%3A"+ne(e)+"%7Cdbp%3A"+ne(e)+"%29+dbr%3A"+n+"%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");a.push(l)}return a}},{key:"populateOtherColumn",value:function(e,t,a){var r=this;document.body.classList.add("waiting");for(var n=Z.a.cloneDeep(this.state.tableData),l=!1,o=0;o<n.length;++o){for(var i=[],s=0;s<a.length;++s){var c=a[s],u=("subject"===c.type?this.state.firstDegNeighbours.subject:this.state.firstDegNeighbours.object)[o][c.value];void 0!==u&&(i=i.concat(u))}if(0===i.length){n[o][t].data="N/A";var p=ye(a)+":N/A",h=n[o][this.state.keyColIndex].origin.slice();h.push(p),n[o][t].origin=h}else{n[o][t].data=i[0];var d=ye(a)+":"+i[0],g=n[o][this.state.keyColIndex].origin.slice();if(g.push(d),n[o][t].origin=g,i.length>1){l=!0;var b=Math.min(i.length,10);n[o][t].dataArray=i.slice(1,b)}}}var v=Z.a.cloneDeep(this.state.tableHeader);v[t]=a;var f=function(e,t){for(var a=[],r=0;r<e.length;++r)a=a.concat(e[r].recommendNeighbours);a=Z.a.uniqBy(a,(function(e){return e.value||e.type||e.relation})),a=Z.a.differenceBy(a,e,(function(e){return e.value||e.type}));for(var n=0;n<a.length;++n)for(var l=0;l<t.length;++l)if(a[n].value===t[l].value&&a[n].type===t[l].type){a[n].label=t[l].label,a[n].filledPercent=t[l].filledPercent;break}return a.sort((function(e,t){return e.filledPercent<t.filledPercent?1:-1})),a}(a,this.state.keyColNeighbours),m={};!0===l&&f.length>0?(m.task="sameNeighbourAndRecommendation",m.colIndex=t,m.neighbourArray=a,m.recommendArray=f):!0===l?(m.task="populateSameNeighbour",m.colIndex=t,m.neighbourArray=a):f.length>0?(m.task="populateRecommendation",m.colIndex=t,m.recommendArray=f):m.task="afterPopulateColumn";var C=Z.a.sampleSize(n,Math.min(n.length,3));re(je(C,t)).then((function(e){var a=Te(C,t,e),l=Z.a.cloneDeep(r.state.typeRecord);l[t]=a,document.body.classList.remove("waiting");var o={curActionInfo:r.state.curActionInfo,tableData:r.state.tableData,tableHeader:r.state.tableHeader,previewColIndex:r.state.previewColIndex,otherColText:r.state.otherColText,typeRecord:r.state.typeRecord};r.setState({curActionInfo:m,tableData:n,tableHeader:v,previewColIndex:-1,otherColText:"",lastAction:"populateOtherColumn",prevState:o,typeRecord:l})}))}},{key:"addAllNeighbour",value:function(e,t,a,r,n,l,o,i,s){var c=l.length,u=l[0].length,p=r;e<r&&(p+=a);for(var h=[],d=0;d<c;++d){for(var g=[],b=0;b<e+1;++b)g.push(l[d][b]);for(var v=0;v<a;++v)g.push({data:"",origin:[]});for(var f=e+1;f<u;++f)g.push(l[d][f]);h.push(g)}for(var m,C=[],y=0;y<e+1;++y)C.push(n[y]);if(!1===s)m=n[e];else{for(var E="",k=0;k<n[r].length;++k){E+=k>0?"&"+n[r][k].label:n[r][k].label}var A="subject"===t[0].type?t[0].value:"is "+t[0].value+" of";m=[{value:t[0].value,label:A+"--"+E,type:t[0].type}]}for(var N=0;N<a;++N)C.push(m);for(var I=e+1;I<u;++I)C.push(n[I]);for(var x=[],D=0;D<e;++D)x.push(i[D]);for(var w=0;w<a;++w)x.push([]);for(var S=e;S<u-1;++S)x.push(i[S]);for(var O=[],j=0;j<e+1;++j)O.push(o[j]);for(var T=0;T<a;++T)O.push([]);for(var F=e+1;F<u;++F)O.push(o[F]);for(var P=0;P<l.length;++P){for(var R=[],L=0;L<t.length;++L){var U=t[L],H=("subject"===U.type?this.state.firstDegNeighbours.subject:this.state.firstDegNeighbours.object)[P][U.value];void 0!==H&&(R=R.concat(H))}for(var M=e+1;M<e+1+a;++M){var B=!0===s?M-e:M-e+1;if(R.length<B){h[P][M].data="N/A";var _=ye(t)+":N/A",J=l[P][this.state.keyColIndex].origin.slice();J.push(_),l[P][e].origin=J}else{var q=R[B-1];h[P][M].data=q;var X=ye(t)+":"+q,V=h[P][p].origin.slice();V.push(X),h[P][M].origin=V}}}return{tableHeader:C,tableData:h,optionsMap:O,selectedClassAnnotation:x,keyColIndex:p}}},{key:"sameNeighbourDiffRow",value:function(e,t,a){for(var r=[],n=[],l=[],o=Z.a.cloneDeep(this.state.tableData),i=Z.a.cloneDeep(this.state.firstDegNeighbours),s=0;s<o.length;++s){var c=Z.a.cloneDeep(o[s]);if(void 0===c[t].dataArray)r.push(c);else{r.push(c);for(var u=0;u<c[t].dataArray.length;++u){var p=Z.a.cloneDeep(c);p[t].data=c[t].dataArray[u];var h=ye(a)+":"+c[t].dataArray[u],d=o[s][this.state.keyColIndex].origin.slice();d.push(h),p[t].origin=d,delete p[t].dataArray,r.push(p)}}}for(var g=0;g<o.length;++g){var b=Z.a.cloneDeep(o[g]);if(void 0===b[t].dataArray)n.push(i.subject[g]),l.push(i.object[g]);else for(var v=0;v<1+b[t].dataArray.length;++v)n.push(i.subject[g]),l.push(i.object[g])}var f={subject:n,object:l},m={},C=Z.a.cloneDeep(this.state.curActionInfo);"sameNeighbourAndRecommendation"===C.task?(m.task="populateRecommendation",m.colIndex=C.colIndex,m.recommendArray=C.recommendArray):"sameNeighbourAndStartRecommend"===C.task?(m.task="showStartRecommend",m.colIndex=C.colIndex,m.recommendArray=C.recommendArray):m.task="afterPopulateColumn";var y={curActionInfo:this.state.curActionInfo,tableData:this.state.tableData,firstDegNeighbours:this.state.firstDegNeighbours};this.setState({curActionInfo:m,tableData:r,firstDegNeighbours:f,lastAction:"sameNeighbourDiffRow",prevState:y})}},{key:"sameNeighbourOneRow",value:function(e,t,a){for(var r=Z.a.cloneDeep(this.state.tableData),n=0;n<r.length;++n){for(var l=[],o=0;o<a.length;++o){var i=a[o],s=("subject"===i.type?this.state.firstDegNeighbours.subject:this.state.firstDegNeighbours.object)[n][i.value];void 0!==s&&(l=l.concat(s))}if(0===l.length){r[n][t].data="N/A";var c=ye(a)+":N/A",u=r[n][this.state.keyColIndex].origin.slice();u.push(c),r[n][t].origin=u}else{for(var p="",h=0;h<l.length;++h){p+=h>0?";"+l[h]:l[h]}r[n][t].data=p;var d=ye(a)+":"+p,g=r[n][this.state.keyColIndex].origin.slice();g.push(d),r[n][t].origin=g}}var b={},v=Z.a.cloneDeep(this.state.curActionInfo);"sameNeighbourAndRecommendation"===v.task?(b.task="populateRecommendation",b.colIndex=v.colIndex,b.recommendArray=v.recommendArray):"sameNeighbourAndStartRecommend"===v.task?(b.task="showStartRecommend",b.colIndex=v.colIndex,b.recommendArray=v.recommendArray):b.task="afterPopulateColumn";var f={curActionInfo:this.state.curActionInfo,tableData:this.state.tableData};this.setState({curActionInfo:b,tableData:r,lastAction:"sameNeighbourOneRow",prevState:f})}},{key:"populateRecommendation",value:function(e,t,a){var r=this;document.body.classList.add("waiting");for(var n=this.state.tableData.length,l=this.state.tableData[0].length,o=[],i=0;i<n;++i){for(var s=[],c=0;c<t+1;++c)s.push(this.state.tableData[i][c]);s.push({data:"",origin:[]});for(var u=t+1;u<l;++u)s.push(this.state.tableData[i][u]);o.push(s)}for(var p=[],h=0;h<t+1;++h)p.push(this.state.tableHeader[h]);p.push([]);for(var d=t+1;d<l;++d)p.push(this.state.tableHeader[d]);for(var g=[],b=0;b<t;++b)g.push(this.state.selectedClassAnnotation[b]);g.push([]);for(var v=t;v<l-1;++v)g.push(this.state.selectedClassAnnotation[v]);var f=this.state.keyColIndex;t<f&&++f,++t;for(var m=!1,C=0;C<o.length;++C){for(var y=[],E=0;E<a.length;++E){var k=a[E],A=("subject"===k.type?this.state.firstDegNeighbours.subject:this.state.firstDegNeighbours.object)[C][k.value];void 0!==A&&(y=y.concat(A))}if(0===y.length){o[C][t].data="N/A";var N=ye(a)+":N/A",I=o[C][f].origin.slice();I.push(N),o[C][t].origin=I}else{o[C][t].data=y[0];var x=ye(a)+":"+y[0],D=o[C][f].origin.slice();if(D.push(x),o[C][t].origin=D,y.length>1){m=!0;var w=Math.min(y.length,10);o[C][t].dataArray=y.slice(1,w)}}}p[t]=a;for(var S=Z.a.cloneDeep(this.state.curActionInfo.recommendArray),O=a[0],j=-1,T=0;T<S.length;++T)if(S[T].value===O.value&&S[T].type===O.type){j=T;break}-1!==j&&S.splice(j,1);var F={};!0===m&&S.length>0?(F.task="sameNeighbourAndRecommendation",F.colIndex=t,F.neighbourArray=a,F.recommendArray=S):!1===m&&S.length>0?(F.task="populateRecommendation",F.colIndex=t,F.recommendArray=S):!0===m?(F.task="populateSameNeighbour",F.colIndex=t,F.neighbourArray=a):F.task="afterPopulateColumn";var P=Z.a.sampleSize(o,Math.min(o.length,3));re(je(P,t)).then((function(e){for(var a=Te(P,t,e),n=[],i=0;i<t;++i)n.push(r.state.typeRecord[i]);n.push(a);for(var s=t;s<l;++s)n.push(r.state.typeRecord[s]);document.body.classList.remove("waiting");var c={tableData:r.state.tableData,tableHeader:r.state.tableHeader,curActionInfo:r.state.curActionInfo,keyColIndex:r.state.keyColIndex,selectedClassAnnotation:r.state.selectedClassAnnotation,tabIndex:r.state.tabIndex,previewColIndex:r.state.previewColIndex,typeRecord:r.state.typeRecord};r.setState({tableData:o,tableHeader:p,selectedClassAnnotation:g,keyColIndex:f,curActionInfo:F,tabIndex:0,previewColIndex:-1,prevState:c,lastAction:"populateRecommendation",typeRecord:n})}))}},{key:"createStartRecommend",value:function(e){for(var t=[],a=Math.min(5,e.length),r=0;r<a;++r)t.push(e[r]);return t}},{key:"populateStartRecommend",value:function(e,t,a){var r=this;document.body.classList.add("waiting");for(var n=this.state.tableData.length,l=this.state.tableData[0].length,o=[],i=0;i<n;++i){for(var s=[],c=0;c<t+1;++c)s.push(this.state.tableData[i][c]);s.push({data:"",origin:[]});for(var u=t+1;u<l;++u)s.push(this.state.tableData[i][u]);o.push(s)}for(var p=[],h=0;h<t+1;++h)p.push(this.state.tableHeader[h]);p.push([]);for(var d=t+1;d<l;++d)p.push(this.state.tableHeader[d]);for(var g=[],b=0;b<t;++b)g.push(this.state.selectedClassAnnotation[b]);g.push([]);for(var v=t;v<l-1;++v)g.push(this.state.selectedClassAnnotation[v]);var f=this.state.keyColIndex;t<f&&++f,++t;for(var m=!1,C=0;C<o.length;++C){for(var y=[],E=0;E<a.length;++E){var k=a[E],A=("subject"===k.type?this.state.firstDegNeighbours.subject:this.state.firstDegNeighbours.object)[C][k.value];void 0!==A&&(y=y.concat(A))}if(0===y.length){o[C][t].data="N/A";var N=ye(a)+":N/A",I=o[C][f].origin.slice();I.push(N),o[C][t].origin=I}else{o[C][t].data=y[0];var x=ye(a)+":"+y[0],D=o[C][f].origin.slice();if(D.push(x),o[C][t].origin=D,y.length>1){m=!0;var w=Math.min(y.length,10);o[C][t].dataArray=y.slice(1,w)}}}p[t]=a;for(var S=Z.a.cloneDeep(this.state.curActionInfo.recommendArray),O=a[0],j=-1,T=0;T<S.length;++T)if(S[T].value===O.value&&S[T].type===O.type){j=T;break}-1!==j&&S.splice(j,1);var F={};!0===m&&S.length>0?(F.task="sameNeighbourAndStartRecommend",F.colIndex=t,F.neighbourArray=a,F.recommendArray=S):!1===m&&S.length>0?(F.task="showStartRecommend",F.colIndex=t,F.recommendArray=S):!0===m?(F.task="populateSameNeighbour",F.colIndex=t,F.neighbourArray=a):F.task="afterPopulateColumn";var P=Z.a.sampleSize(o,Math.min(o.length,3));re(je(P,t)).then((function(e){for(var a=Te(P,t,e),n=[],i=0;i<t;++i)n.push(r.state.typeRecord[i]);n.push(a);for(var s=t;s<l;++s)n.push(r.state.typeRecord[s]);document.body.classList.remove("waiting");var c={tableData:r.state.tableData,tableHeader:r.state.tableHeader,curActionInfo:r.state.curActionInfo,keyColIndex:r.state.keyColIndex,selectedClassAnnotation:r.state.selectedClassAnnotation,tabIndex:r.state.tabIndex,previewColIndex:r.state.previewColIndex,typeRecord:r.state.typeRecord};r.setState({tableData:o,tableHeader:p,selectedClassAnnotation:g,keyColIndex:f,curActionInfo:F,tabIndex:0,previewColIndex:-1,prevState:c,lastAction:"populateStartRecommend",typeRecord:n})}))}},{key:"contextAddColumn",value:function(e,t){for(var a=this.state.tableData.length,r=this.state.tableData[0].length,n=[],l=0;l<a;++l){for(var o=[],i=0;i<t+1;++i)o.push(this.state.tableData[l][i]);o.push({data:"",origin:[]});for(var s=t+1;s<r;++s)o.push(this.state.tableData[l][s]);n.push(o)}for(var c=[],u=0;u<t+1;++u)c.push(this.state.tableHeader[u]);c.push([]);for(var p=t+1;p<r;++p)c.push(this.state.tableHeader[p]);for(var h=[],d=0;d<t+1;++d)h.push(this.state.selectedClassAnnotation[d]);h.push([]);for(var g=t+1;g<r;++g)h.push(this.state.selectedClassAnnotation[g]);for(var b=[],v=0;v<t+1;++v)b.push(this.state.typeRecord[v]);b.push([]);for(var f=t+1;f<r;++f)b.push(this.state.typeRecord[f]);var m=this.state.keyColIndex;t<m&&++m;var C={tableData:this.state.tableData,tableHeader:this.state.tableHeader,curActionInfo:this.state.curActionInfo,keyColIndex:this.state.keyColIndex,selectedClassAnnotation:this.state.selectedClassAnnotation,tabIndex:this.state.tabIndex,previewColIndex:this.state.previewColIndex,typeRecord:this.state.typeRecord};this.setState({tableData:n,tableHeader:c,curActionInfo:{task:"afterPopulateColumn"},keyColIndex:m,selectedClassAnnotation:h,tabIndex:0,previewColIndex:-1,lastAction:"contextAddColumn",prevState:C,typeRecord:b})}},{key:"contextDeleteColumn",value:function(e,t){if(t===this.state.keyColIndex)alert("The current column is the search column.\n\nPlease set another search column before deleting the current column.");else if(0===t)alert("Deleting the first column causes unexpected behavior.\n\nPlease do not delete the first column.");else{for(var a=Z.a.cloneDeep(this.state.tableData),r=this.state.tableHeader.slice(),n=this.state.optionsMap.slice(),l=this.state.selectedClassAnnotation.slice(),o=Z.a.cloneDeep(this.state.typeRecord),i=0;i<a.length;++i)a[i].splice(t,1);r.splice(t,1),n.splice(t,1),t>0&&l.splice(t-1,1),o.splice(t,1);var s=this.state.keyColIndex;t<s&&--s;var c=Z.a.cloneDeep(this.state.propertyNeighbours);if(1===this.state.tabIndex)for(var u=0;u<c.length;++u)c[u].isOpen=!1;var p={tableData:this.state.tableData,tableHeader:this.state.tableHeader,selectedClassAnnotation:this.state.selectedClassAnnotation,keyColIndex:this.state.keyColIndex,previewColIndex:this.state.previewColIndex,propertyNeighbours:this.state.propertyNeighbours,curActionInfo:this.state.curActionInfo,typeRecord:this.state.typeRecord};this.setState({tableData:a,tableHeader:r,selectedClassAnnotation:l,typeRecord:o,keyColIndex:s,previewColIndex:-1,propertyNeighbours:c,curActionInfo:{task:"afterPopulateColumn"},lastAction:"contextDeleteColumn",prevState:p})}}},{key:"contextSortColumn",value:function(e,t,a){var r=this;document.body.classList.add("waiting");for(var n=Z.a.cloneDeep(this.state.tableData),l=!0,o=0;o<n.length;++o)if("N/A"!==n[o][t].data&&isNaN(Number(n[o][t].data))){l=!1;break}l?n.sort((function(e,r){var n=e[t].data,l=r[t].data;return"N/A"===n?1:"N/A"===l?-1:"ascending"===a?Number(n)-Number(l):Number(l)-Number(n)})):n.sort((function(e,r){var n=e[t].data,l=r[t].data;return"N/A"===n?1:"N/A"===l?-1:"ascending"===a?n<l?-1:1:n<l?1:-1}));var i=this.getNeighbourPromise(n,"subject",this.state.keyColIndex),s=this.getNeighbourPromise(n,"object",this.state.keyColIndex);re(i).then((function(e){re(s).then((function(t){var a=Ne(e,t).firstDegNeighbours;document.body.classList.remove("waiting");var l={tableData:r.state.tableData,firstDegNeighbours:r.state.firstDegNeighbours,previewColIndex:r.state.previewColIndex};r.setState({tableData:n,firstDegNeighbours:a,previewColIndex:-1,lastAction:"contextSortColumn",prevState:l})}))}))}},{key:"contextDedupColumn",value:function(e,t){var a=this;document.body.classList.add("waiting");var r=Z.a.cloneDeep(this.state.tableData);r=Z.a.uniqBy(r,(function(e){return e[t].data}));var n=this.getNeighbourPromise(r,"subject",this.state.keyColIndex),l=this.getNeighbourPromise(r,"object",this.state.keyColIndex);re(n).then((function(e){re(l).then((function(t){var n=Ne(e,t),l=n.keyColNeighbours,o=n.firstDegNeighbours;document.body.classList.remove("waiting");var i={tableData:a.state.tableData,keyColNeighbours:a.state.keyColNeighbours,firstDegNeighbours:a.state.firstDegNeighbours,tabIndex:a.state.tabIndex,previewColIndex:a.state.previewColIndex};a.setState({tableData:r,keyColNeighbours:l,firstDegNeighbours:o,tabIndex:0,previewColIndex:-1,lastAction:"contextDedupColumn",prevState:i})}))}))}},{key:"showFilterMethods",value:function(e,t){var a={task:"showFilterMethods"};a.colIndex=t,this.setState({curActionInfo:a,tabIndex:0,previewColIndex:-1})}},{key:"contextSetColumn",value:function(e,t){for(var a=this,r=!0,n=0;n<this.state.tableData.length;++n)if(""!==this.state.tableData[n][t].data){r=!1;break}if(!0===r)alert("This column is currently empty. Try set the data for this column before setting it as the search column.");else{document.body.classList.add("waiting");var l=Z.a.cloneDeep(this.state.tableData),o=this.getNeighbourPromise(l,"subject",t),i=this.getNeighbourPromise(l,"object",t);re(o).then((function(e){re(i).then((function(r){var n=Ne(e,r),l=n.keyColNeighbours,o=n.firstDegNeighbours,i={task:"showStartRecommend"};i.colIndex=t,i.recommendArray=a.createStartRecommend(l),document.body.classList.remove("waiting");var s={keyColIndex:a.state.keyColIndex,keyColNeighbours:a.state.keyColNeighbours,firstDegNeighbours:a.state.firstDegNeighbours,curActionInfo:a.state.curActionInfo,tabIndex:a.state.tabIndex,previewColIndex:a.state.previewColIndex};a.setState({keyColIndex:t,keyColNeighbours:l,firstDegNeighbours:o,curActionInfo:i,tabIndex:0,previewColIndex:-1,lastAction:"contextSetColumn",prevState:s})}))}))}}},{key:"originPreviewPage",value:function(e,t,a){var r=this;document.body.classList.add("waiting");var n=[],l=te("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("select+%3Fp+%3Fo%0D%0Awhere+%7B%0D%0Adbr%3A"+ne(this.state.tableData[t][a].data)+"+%3Fp+%3Fo.%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");n.push(l);var o=te("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("select+%3Fp+%3Fo%0D%0Awhere+%7B%0D%0A%3Fo+%3Fp+dbr%3A"+ne(this.state.tableData[t][a].data)+".%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");n.push(o),re(n).then((function(e){for(var n=se(e[0].results.bindings,"subject"),l=se(e[1].results.bindings,"object"),o=n.concat(l),i=[],s=0;s<o.length;++s)i.push(!1);var c=Z.a.cloneDeep(r.state.tableData[t][a]),u="https://en.wikipedia.org/wiki/"+r.state.tableData[t][a].data,p={task:"originPreviewPage"};document.body.classList.remove("waiting");var h={curActionInfo:r.state.curActionInfo,tabIndex:r.state.tabIndex,pageHidden:r.state.pageHidden,iframeURL:r.state.iframeURL,previewInfoArray:r.state.previewInfoArray,previewInfoExpanded:r.state.previewInfoExpanded,selectedCell:r.state.selectedCell,previewColIndex:r.state.previewColIndex};r.setState({curActionInfo:p,tabIndex:0,previewColIndex:-1,pageHidden:!1,iframeURL:u,previewInfoArray:o,previewInfoExpanded:i,selectedCell:c,lastAction:"originPreviewPage",prevState:h})}))}},{key:"toggleTable",value:function(e,t){var a=this.state.tableOpenList.slice();a[t]=!a[t];for(var r=0;r<a.length;++r)r!==t&&(a[r]=!1);this.setState({tableOpenList:a})}},{key:"getTableStates",value:function(e,t){for(var a=-1,r=0;r<t.length;++r)if(t[r].length>0&&(1!==t[r].length||"Number"!==t[r][0])&&(1!==t[r].length||"originURL"!==t[r][0])){a=r+1;break}-1===a&&(a=0);for(var n=[],l=0;l<e[0].length;++l)n.push([{value:e[0][l].data,label:e[0][l].data}]);for(var o=[],i=1;i<e.length;++i){for(var s=[],c=Math.min(e[i].length,n.length),u=0;u<c;++u){var p=e[i][u].data,h=[],d=n[u][0].value+": "+e[i][u].data;h.push(d),s.push({data:p,origin:h})}o.push(s)}var g=this.getNeighbourPromise(o,"subject",a),b=this.getNeighbourPromise(o,"object",a);return re(g).then((function(e){return re(b).then((function(t){var r=Ne(e,t),l=r.keyColNeighbours,i=r.firstDegNeighbours;return Promise.resolve({keyColIndex:a,tableHeader:n,tableData:o,keyColNeighbours:l,firstDegNeighbours:i})}))}))}},{key:"handleStartTable",value:function(e,t){var a=this;document.body.classList.add("waiting");var r=[],n=te("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fp+%3Fo%0D%0AWHERE+%7B%0D%0A++++++dbr%3A"+le(decodeURIComponent(this.state.urlPasted.slice(30)))+"+%3Fp+%3Fo.%0D%0A++++++BIND%28STR%28%3Fp%29+AS+%3FpString+%29.%0D%0A++++++FILTER%28isIRI%28%3Fo%29+%26%26+regex%28%3FpString%2C%22property%22%2C%22i%22%29+%26%26+%28%21regex%28%3FpString%2C%22text%22%2C%22i%22%29%29%29.%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(n);var l=te("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fo%0D%0AWHERE+%7B%0D%0A++++++dbr%3A"+le(decodeURIComponent(this.state.urlPasted.slice(30)))+"+dct%3Asubject+%3Fo%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(l),r.push(de(this.state.originTableArray[t])),re(r).then((function(e){var r=e[2],n=[],l=[],o=[];o=e[0].results.bindings;for(var i=0;i<o.length;++i){var s=o[i].p.value.slice(28),c=o[i].o.value.slice(28);c.includes("/")&&(c="NONEXISTING");var u=te("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fs+%0D%0AWHERE+%7B%0D%0A%09%3Fs+dbp%3A"+ne(s)+"+dbr%3A"+ne(c)+"%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");n.push({predicate:s,object:c}),l.push(u)}o=e[1].results.bindings;for(var p=0;p<o.length;++p){var h=o[p].o.value.slice(37),d=te("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fs%0D%0AWHERE+%7B%0D%0A++++++%3Fs+dct%3Asubject+dbc%3A"+ne(h)+"%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");n.push({predicate:"subject",object:h}),l.push(d)}re(l).then((function(e){for(var l=[],o=decodeURIComponent(a.state.urlPasted.slice(30)),i=0;i<e.length;++i){var s=e[i].results.bindings;if(s.length>1&&s.length<150){for(var c=[],u=0;u<s.length;++u){var p=s[u].s.value.slice(28);c.push({isOpen:!1,name:p,tableArray:[]})}l.push({predicate:n[i].predicate,object:n[i].object,isOpen:!1,siblingArray:c})}}l.sort((function(e,t){return e.siblingArray.length<t.siblingArray.length?1:-1}));var h=ge(a.state.originTableArray[t],o);re([a.getTableStates(h,r)]).then((function(e){var n=e[0],o=Z.a.sampleSize(n.tableData,Math.min(n.tableData.length,3));re(je(o,-1,"startTable")).then((function(e){var i=Te(o,-1,e,"startTable"),s={task:"showStartRecommend"};s.colIndex=n.keyColIndex,s.recommendArray=a.createStartRecommend(n.keyColNeighbours),document.body.classList.remove("waiting");var c={firstColFilled:a.state.firstColFilled,selectedTableIndex:a.state.selectedTableIndex,propertyNeighbours:a.state.propertyNeighbours,curActionInfo:a.state.curActionInfo,selectedClassAnnotation:a.state.selectedClassAnnotation,keyColIndex:a.state.keyColIndex,keyColNeighbours:a.state.keyColNeighbours,firstDegNeighbours:a.state.firstDegNeighbours,tableData:a.state.tableData,tableHeader:a.state.tableHeader,usecaseSelected:a.state.usecaseSelected,tabIndex:a.state.tabIndex,typeRecord:a.state.typeRecord};a.setState({firstColFilled:!0,selectedTableIndex:t,propertyNeighbours:l,curActionInfo:s,selectedClassAnnotation:r,keyColIndex:n.keyColIndex,keyColNeighbours:n.keyColNeighbours,firstDegNeighbours:n.firstDegNeighbours,tableData:n.tableData,tableHeader:n.tableHeader,usecaseSelected:"startTable",tabIndex:1,lastAction:"handleStartTable",prevState:c,typeRecord:i})}))}))}))}))}},{key:"togglePropertyNeighbours",value:function(e,t){var a=this;document.body.classList.add("waiting");var r=this.state.propertyNeighbours.slice();if(r[t].isOpen=!r[t].isOpen,!0===r[t].isOpen){for(var n=r[t].siblingArray,l=[],o=[],i=[],s=0;s<n.length;++s){var c=n[s].name,u=ae("https://en.wikipedia.org/wiki/"+c);i.push(u),o.push(c)}re(i).then((function(e){for(var n=[],i=0;i<e.length;++i){var s=e[i];n.push(pe(a.state.tableHeader,s,a.state.selectedClassAnnotation,a.state.semanticEnabled,a.state.unionCutOff,o[i]))}re(n).then((function(e){for(var n=0;n<e.length;++n)l.push({isOpen:!1,name:o[n],tableArray:e[n]});l.sort((function(e,t){var a=e.tableArray.length,r=t.tableArray.length,n=e.name,l=t.name;return a===r?n<l?-1:n>l?1:0:a>r?-1:1})),r[t].siblingArray=l,document.body.classList.remove("waiting"),a.setState({propertyNeighbours:r})}))}))}else document.body.classList.remove("waiting"),this.setState({propertyNeighbours:r})}},{key:"toggleSibling",value:function(e,t,a){var r=this.state.propertyNeighbours.slice(),n=r[t].siblingArray[a];if(0===n.tableArray.length){var l="https://en.wikipedia.org/wiki/"+n.name;this.setState({pageHidden:!1,iframeURL:l})}else if(n.isOpen=!n.isOpen,!0===n.isOpen){var o="https://en.wikipedia.org/wiki/"+n.name;r[t].isOpen=!0,this.setState({propertyNeighbours:r,iframeURL:o})}else this.setState({propertyNeighbours:r})}},{key:"toggleOtherTable",value:function(e,t,a,r){var n=this.state.propertyNeighbours.slice(),l=n[t].siblingArray[a].tableArray[r];l.isOpen=!l.isOpen,this.setState({propertyNeighbours:n})}},{key:"unionTable",value:function(e,t,a,r){var n=this;document.body.classList.add("waiting");var l=Z.a.cloneDeep(this.state.tableData),o=l.length;re([Fe(this.state.typeRecord)]).then((function(r){var i=Re(r[0],n.state.typeRecord),s=n.state.propertyNeighbours[e].siblingArray[t].name,c=ge(a,s);c=be(c);var u=Z.a.sampleSize(c,Math.min(c.length,3));re(je(u,-1,"startTable")).then((function(e){var t=Te(u,-1,e,"startTable");re([Fe(t)]).then((function(e){for(var r=Re(e[0],t),u=[],p=[],h=Z.a.cloneDeep(n.state.tableHeader),d=0;d<n.state.tableHeader.length;++d){for(var g="",b=0;b<h[d].length;++b)g+=h[d][b].value;p.push(g),u.push(-1)}for(var v=["OriginURL"],f=a.rows[0].cells,m=0;m<f.length;++m){var C=ue(f[m].innerText);v.push(C)}for(var y=0;y<u.length;++y)for(var E=p[y].toUpperCase(),k=0;k<v.length;++k){var A=v[k].toUpperCase();if(E.includes(A)||A.includes(E)){u[y]=k;break}}for(var N=0;N<u.length;++N)if(-1===u[N]){var I=Ue(N,i,r);-1!==I&&-1===u.indexOf(I)&&(u[N]=I)}var x=u.slice(),D=xe(l=ce(l,c,s,x),p),w=n.getNeighbourPromise(l,"subject",n.state.keyColIndex),S=n.getNeighbourPromise(l,"object",n.state.keyColIndex),O=D.columnInfo,j=D.refInfo,T=we(l,O,o,"startTable",j);re(w).then((function(e){re(S).then((function(t){re(T).then((function(a){var r=Ie(e),i=Se(O,a,"startTable"),s=0;console.log(i);for(var c=Ne(e,t),u=c.keyColNeighbours,p=c.firstDegNeighbours,h=0;h<O.length;++h){var d=h+1;O[h].length>0&&O[h].length<4&&(l=Oe(l,O[h],i[s],d,o),++s)}console.log(l),document.body.classList.remove("waiting");var g={tableData:n.state.tableData,keyColNeighbours:n.state.keyColNeighbours,firstDegNeighbours:n.state.firstDegNeighbours,previewColIndex:n.state.previewColIndex,firstColSelection:n.state.firstColSelection,firstColChecked:n.state.firstColChecked};n.setState({tableData:l,keyColNeighbours:u,firstDegNeighbours:p,previewColIndex:-1,lastAction:"unionTable",prevState:g,firstColSelection:r.firstColSelection,firstColChecked:r.firstColChecked})}))}))}))}))}))}))}},{key:"unionCustomized",value:function(e,t){var a=this;document.body.classList.add("waiting");var r=Z.a.cloneDeep(this.state.tableData),n=r.length;re([Fe(this.state.typeRecord)]).then((function(e){var l=Re(e[0],a.state.typeRecord),o=decodeURIComponent(a.state.unionURL.slice(30)),i=a.state.unionTableArray[t],s=ge(i,o);s=be(s);var c=Z.a.sampleSize(s,Math.min(s.length,3));re(je(c,-1,"startTable")).then((function(e){var t=Te(c,-1,e,"startTable");re([Fe(t)]).then((function(e){for(var c=Re(e[0],t),u=[],p=[],h=Z.a.cloneDeep(a.state.tableHeader),d=0;d<a.state.tableHeader.length;++d){for(var g="",b=0;b<h[d].length;++b)g+=h[d][b].value;p.push(g),u.push(-1)}for(var v=["OriginURL"],f=i.rows[0].cells,m=0;m<f.length;++m){var C=ue(f[m].innerText);v.push(C)}for(var y=1;y<u.length;++y)for(var E=p[y].toUpperCase(),k=0;k<v.length;++k){var A=v[k].toUpperCase();if(E.includes(A)||A.includes(E)){u[y]=k;break}}for(var N=0;N<u.length;++N)if(-1===u[N]){var I=Ue(N,l,c);-1!==I&&-1===u.indexOf(I)&&(u[N]=I)}var x=u.slice(),D=xe(r=ce(r,s,o,x),!1,u),w=a.getNeighbourPromise(r,"subject",a.state.keyColIndex),S=a.getNeighbourPromise(r,"object",a.state.keyColIndex),O=D.columnInfo,j=we(r,O,n,"startSubject",-1);re(w).then((function(e){re(S).then((function(t){re(j).then((function(l){for(var o=Ie(e),i=Ne(e,t),s=i.keyColNeighbours,c=i.firstDegNeighbours,u=Se(O,l,"startSubject"),h=0,d=0;d<O.length;++d){var g=d+1;1===O[d].length&&(r=De(r,O[d],g,n,c,a.state.keyColIndex)),2!==O[d].length&&3!==O[d].length||(r=Oe(r,O[d],u[h],g,n),++h)}r=function(e,t){var a=Z.a.cloneDeep(e);console.log(e),console.log(t);for(var r=0;r<t.length;++r)if("Notes"===t[r])for(var n=0;n<a.length;++n)"N/A"===a[n][r].data&&(a[n][r].data="");return a}(r,p),document.body.classList.remove("waiting");var b={tableData:a.state.tableData,keyColNeighbours:a.state.keyColNeighbours,firstDegNeighbours:a.state.firstDegNeighbours,previewColIndex:a.state.previewColIndex,firstColSelection:a.state.firstColSelection,firstColChecked:a.state.firstColChecked};a.setState({tableData:r,keyColNeighbours:s,firstDegNeighbours:c,previewColIndex:-1,lastAction:"unionCustomized",prevState:b,firstColSelection:o.firstColSelection,firstColChecked:o.firstColChecked})}))}))}))}))}))}))}},{key:"unionPage",value:function(e,t){var a=this;document.body.classList.add("waiting");for(var r=Z.a.cloneDeep(this.state.tableData),n=this.state.propertyNeighbours[e].siblingArray[t].tableArray,l=this.state.propertyNeighbours[e].siblingArray[t].name,o=0;o<n.length;++o){var i=ge(n[o].data,l),s=i[0];i=be(i);var c=!1;if(l===decodeURIComponent(this.state.urlPasted.slice(30))&&s.length===r[0].length){for(var u=!1,p=0;p<s.length;++p)if(s[p].data!==this.state.tableHeader[p].value){u=!0;break}!1===u&&(c=!0)}var h=n[o].colMapping.slice();!1===c&&(r=ce(r,i,h))}var d=this.getNeighbourPromise(r,"subject",this.state.keyColIndex),g=this.getNeighbourPromise(r,"object",this.state.keyColIndex);re(d).then((function(e){re(g).then((function(t){var n=Ne(e,t),l=n.keyColNeighbours,o=n.firstDegNeighbours;document.body.classList.remove("waiting");var i={tableData:a.state.tableData,keyColNeighbours:a.state.keyColNeighbours,firstDegNeighbours:a.state.firstDegNeighbours,previewColIndex:a.state.previewColIndex};a.setState({tableData:r,keyColNeighbours:l,firstDegNeighbours:o,previewColIndex:-1,lastAction:"unionPage",prevState:i})}))}))}},{key:"unionProperty",value:function(e){for(var t=Z.a.cloneDeep(this.state.tableData),a=this.state.propertyNeighbours[e].siblingArray,r=0;r<a.length;++r){var n=a[r].tableArray,l=a[r].name;if(0===n.length)break;for(var o=0;o<n.length;++o){var i=ge(n[o].data,l),s=i[0];i=be(i);var c=!1;if(l===decodeURIComponent(this.state.urlPasted.slice(30))&&s.length===t[0].length){for(var u=!1,p=0;p<s.length;++p)if(s[p].data!==this.state.tableHeader[p].value){u=!0;break}!1===u&&(c=!0)}var h=n[o].colMapping.slice();!1===c&&(t=ce(t,i,h))}}var d={tableData:this.state.tableData};this.setState({tableData:t,lastAction:"unionProperty",prevState:d})}},{key:"toggleSemantic",value:function(e){for(var t=this.state.propertyNeighbours.slice(),a=0;a<t.length;++a)t[a].isOpen=!1;this.setState({semanticEnabled:e.target.value,propertyNeighbours:t})}},{key:"unionCutOffChange",value:function(e){for(var t=this.state.propertyNeighbours.slice(),a=0;a<t.length;++a)t[a].isOpen=!1;this.setState({unionCutOff:e.target.value,propertyNeighbours:t})}},{key:"openFilter",value:function(e,t){for(var a=[],r=0;r<this.state.tableData.length;++r)a.push(this.state.tableData[r][t].data);(a=Object(b.a)(new Set(a))).sort((function(e,t){return"N/A"===e?-1:"N/A"===t?1:0}));for(var n=[],l=0;l<a.length;++l)n.push({data:a[l],checked:!0});this.setState({dataAndChecked:n,showFilter:!0,checkAll:!0,curFilterIndex:t})}},{key:"cancelFilter",value:function(e){this.setState({dataAndChecked:[],showFilter:!1,curFilterIndex:-1,filterMin:null,filterMax:null})}},{key:"toggleChecked",value:function(e,t){var a=this.state.dataAndChecked;a[t].checked=!a[t].checked,this.setState({dataAndChecked:a})}},{key:"toggleAll",value:function(e){var t=this.state.checkAll,a=this.state.dataAndChecked;t=!t;for(var r=0;r<a.length;++r)a[r].checked=t;this.setState({checkAll:t,dataAndChecked:a})}},{key:"applyFilter",value:function(e){for(var t=this,a=!0,r=0;r<this.state.dataAndChecked.length;++r)if(!0===this.state.dataAndChecked[r].checked){a=!1;break}if(!0===a)alert("Please do not remove every value from the table!");else if(null!==this.state.filterMin||null!==this.state.filterMax){var n,l;null===this.state.filterMin?(n=Number.NEGATIVE_INFINITY,l=Number(this.state.filterMax)):null===this.state.filterMax?(n=Number(this.state.filterMin),l=Number.POSITIVE_INFINITY):(n=Number(this.state.filterMin),l=Number(this.state.filterMax));for(var o=Z.a.cloneDeep(this.state.tableData),i=0;i<o.length;++i){var s=Number(o[i][this.state.curFilterIndex].data);(isNaN(s)||s>l||s<n)&&(o.splice(i,1),--i)}var c=this.getNeighbourPromise(o,"subject",this.state.keyColIndex),u=this.getNeighbourPromise(o,"object",this.state.keyColIndex),p=Z.a.sampleSize(o,Math.min(o.length,3));re(je(p,-1,this.state.usecaseSelected)).then((function(e){re(c).then((function(a){re(u).then((function(r){var n=Ne(a,r),l=n.keyColNeighbours,i=n.firstDegNeighbours,s=Te(p,-1,e,t.state.usecaseSelected),c={tableData:t.state.tableData,curActionInfo:t.state.curActionInfo,keyColNeighbours:t.state.keyColNeighbours,firstDegNeighbours:t.state.firstDegNeighbours,previewColIndex:t.state.previewColIndex,typeRecord:t.state.typeRecord};t.setState({dataAndChecked:[],showFilter:!1,curFilterIndex:-1,filterMin:null,filterMax:null,tableData:o,keyColNeighbours:l,firstDegNeighbours:i,previewColIndex:-1,lastAction:"applyFilter",prevState:c,typeRecord:s})}))}))}))}else{for(var h=[],d=0;d<this.state.dataAndChecked.length;++d)!0===this.state.dataAndChecked[d].checked&&h.push(this.state.dataAndChecked[d].data);for(var g=Z.a.cloneDeep(this.state.tableData),b=0;b<g.length;++b)h.includes(g[b][this.state.curFilterIndex].data)||(g.splice(b,1),--b);var v=this.getNeighbourPromise(g,"subject",this.state.keyColIndex),f=this.getNeighbourPromise(g,"object",this.state.keyColIndex),m=Z.a.sampleSize(g,Math.min(g.length,3));re(je(m,-1,this.state.usecaseSelected)).then((function(e){re(v).then((function(a){re(f).then((function(r){var n=Ne(a,r),l=n.keyColNeighbours,o=n.firstDegNeighbours,i=Te(m,-1,e,t.state.usecaseSelected),s={tableData:t.state.tableData,curActionInfo:t.state.curActionInfo,keyColNeighbours:t.state.keyColNeighbours,firstDegNeighbours:t.state.firstDegNeighbours,previewColIndex:t.state.previewColIndex,typeRecord:t.state.typeRecord};t.setState({dataAndChecked:[],showFilter:!1,curFilterIndex:-1,filterMin:null,filterMax:null,tableData:g,keyColNeighbours:l,firstDegNeighbours:o,previewColIndex:-1,lastAction:"applyFilter",prevState:s,typeRecord:i})}))}))}))}}},{key:"handleTabSwitch",value:function(e){if(1===e){for(var t=this.state.propertyNeighbours.slice(),a=0;a<t.length;++a)t[a].isOpen=!1;this.setState({propertyNeighbours:t,tabIndex:e})}else this.setState({tabIndex:e})}},{key:"handleRangeFilter",value:function(e,t){e.preventDefault(),"min"===t?this.setState({filterMin:e.target.value}):this.setState({filterMax:e.target.value})}},{key:"undoPreviousStep",value:function(){var e=this.state.lastAction,t=this.state.prevState;"handleURLPaste"===e?this.setState({urlPasted:t.urlPasted,iframeURL:t.iframeURL,originTableArray:t.originTableArray,tableOpenList:t.tableOpenList,lastAction:""}):"handleStartSubject"===e?this.setState({usecaseSelected:t.usecaseSelected,tableData:t.tableData,firstColSelection:t.firstColSelection,firstColChecked:t.firstColChecked,tabIndex:t.tabIndex,curActionInfo:t.curActionInfo,lastAction:""}):"handleStartTable"===e?this.setState({firstColFilled:t.firstColFilled,selectedTableIndex:t.selectedTableIndex,propertyNeighbours:t.propertyNeighbours,curActionInfo:t.curActionInfo,selectedClassAnnotation:t.selectedClassAnnotation,keyColIndex:t.keyColIndex,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,tableData:t.tableData,tableHeader:t.tableHeader,usecaseSelected:t.usecaseSelected,tabIndex:t.tabIndex,lastAction:""}):"populateKeyColumn"===e?this.setState({keyColIndex:t.keyColIndex,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,curActionInfo:t.curActionInfo,tableData:t.tableData,tableHeader:t.tableHeader,firstColFilled:t.firstColFilled,firstColHeaderInfo:t.firstColHeaderInfo,firstColSelection:t.firstColSelection,firstColChecked:t.firstColChecked,lastAction:""}):"populateOtherColumn"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,tableHeader:t.tableHeader,previewColIndex:t.previewColIndex,otherColText:t.otherColText,lastAction:""}):"sameNeighbourDiffRow"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,firstDegNeighbours:t.firstDegNeighbours,lastAction:""}):"sameNeighbourOneRow"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,lastAction:""}):"unionTable"===e||"unionPage"===e||"unionProperty"===e?this.setState({tableData:t.tableData,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,previewColIndex:t.previewColIndex,lastAction:""}):"contextAddColumn"===e?this.setState({tableData:t.tableData,tableHeader:t.tableHeader,curActionInfo:t.curActionInfo,keyColIndex:t.keyColIndex,previewColIndex:t.previewColIndex,selectedClassAnnotation:t.selectedClassAnnotation,tabIndex:t.tabIndex,lastAction:""}):"contextSetColumn"===e?this.setState({keyColIndex:t.keyColIndex,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,curActionInfo:t.curActionInfo,tabIndex:t.tabIndex,previewColIndex:t.previewColIndex,lastAction:""}):"originPreviewPage"===e?this.setState({curActionInfo:t.curActionInfo,tabIndex:t.tabIndex,pageHidden:t.pageHidden,iframeURL:t.iframeURL,previewInfoArray:t.previewInfoArray,previewInfoExpanded:t.previewInfoExpanded,selectedCell:t.selectedCell,previewColIndex:t.previewColIndex,lastAction:""}):"contextDeleteColumn"===e?this.setState({tableData:t.tableData,tableHeader:t.tableHeader,selectedClassAnnotation:t.selectedClassAnnotation,keyColIndex:t.keyColIndex,previewColIndex:t.previewColIndex,propertyNeighbours:t.propertyNeighbours,curActionInfo:t.curActionInfo,lastAction:""}):"contextSortColumn"===e?this.setState({tableData:t.tableData,firstDegNeighbours:t.firstDegNeighbours,previewColIndex:t.previewColIndex,lastAction:""}):"contextDedupColumn"===e?this.setState({tableData:t.tableData,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,curActionInfo:t.curActionInfo,tabIndex:t.tabIndex,previewColIndex:t.previewColIndex,lastAction:""}):"applyFilter"===e?this.setState({tableData:t.tableData,keyColNeighbours:t.keyColNeighbours,firstDegNeighbours:t.firstDegNeighbours,curActionInfo:t.curActionInfo,previewColIndex:t.previewColIndex,lastAction:""}):"runJoin"===e?this.setState({curActionInfo:t.curActionInfo,tableData:t.tableData,tableHeader:t.tableHeader,keyColNeighbours:t.keyColNeighbours,previewColIndex:t.previewColIndex,firstDegNeighbours:t.firstDegNeighbours,selectedClassAnnotation:t.selectedClassAnnotation,lastAction:""}):"confirmAddFirstCol"===e?this.setState({tableData:t.tableData,firstDegNeighbours:t.firstDegNeighbours,keyColNeighbours:t.keyColNeighbours,firstColHeaderInfo:t.firstColHeaderInfo,previewColIndex:t.previewColIndex,firstColSelection:t.firstColSelection,firstColChecked:t.firstColChecked,lastAction:""}):"toggleOtherNeighbour"===e?this.setState({tableData:t.tableData,previewColIndex:t.previewColIndex,otherColChecked:t.otherColChecked,otherColCheckedIndex:t.otherColCheckedIndex,lastAction:""}):"populateRecommendation"===e?this.setState({tableData:t.tableData,tableHeader:t.tableHeader,keyColIndex:t.keyColIndex,selectedClassAnnotation:t.selectedClassAnnotation,curActionInfo:t.curActionInfo,tabIndex:t.tabIndex,previewColIndex:t.previewColIndex,lastAction:""}):"populateStartRecommend"===e&&this.setState({tableData:t.tableData,tableHeader:t.tableHeader,keyColIndex:t.keyColIndex,selectedClassAnnotation:t.selectedClassAnnotation,curActionInfo:t.curActionInfo,tabIndex:t.tabIndex,previewColIndex:t.previewColIndex,lastAction:""})}},{key:"openModal",value:function(){this.setState({showSetting:!0})}},{key:"closeModal",value:function(){this.setState({showSetting:!1})}},{key:"toggleTableSelection",value:function(){var e=!this.state.showTableSelection;this.setState({showTableSelection:e})}},{key:"toggleUnionJoin",value:function(e,t){if("union"===t)this.setState({showUnionTables:!this.state.showUnionTables,showJoinTables:!1});else{for(var a=this.state.tableOpenList.slice(),r=0;r<a.length;++r)a[r]=!1;this.setState({showUnionTables:!1,showJoinTables:!this.state.showJoinTables,tableOpenList:a})}}},{key:"handleJoinTable",value:function(e,t){for(var a=Z.a.cloneDeep(this.state.tableHeader),r=[],n=[],l=0;l<a.length&&0!==a[l].length;++l){for(var o="",i=0;i<a[l].length;++i){o+=i>0?"&"+a[l][i].value:a[l][i].value}r.push({value:o,label:o,index:l})}for(var s=decodeURIComponent(this.state.urlPasted.slice(30)),c=ge(this.state.originTableArray[t],s),u=0;u<c[0].length;++u)n.push({value:c[0][u].data,label:c[0][u].data,index:u});if(0===r.length||0===n.length)alert("One of the join tables have no data. Join cannot be performed.");else{var p=function(e,t,a,r){for(var n=[],l="OriginURL"===a[0].value?1:0;l<a.length;++l){for(var o=[],i=0;i<e.length;++i)o.push(e[i][l].data);n.push(o)}for(var s=[],c=1;c<r.length;++c){for(var u=[],p=1;p<t.length;++p)u.push(t[p][c].data);s.push(u)}for(var h=[],d=0;d<n.length;++d)for(var g=0;g<s.length;++g){for(var b=0,v=0;v<n[d].length;++v){var f=n[d][v];s[g].includes(f)&&b++}var m="OriginURL"===a[0].value?1:0,C=b/n[d].length;h.push({indices:[d+m,g+1],joinScore:C})}return h.sort((function(e,t){return e.joinScore<t.joinScore?1:-1})),h=(h=h.slice(0,Math.min(h.length,3))).filter((function(e){return e.joinScore>0}))}(this.state.tableData,c,r,n);this.setState({showJoinModal:!0,joinTableIndex:t,joinTableData:c,originColOptions:r,joinColOptions:n,joinPairRecord:p})}}},{key:"cancelJoin",value:function(e){this.setState({showJoinModal:!1})}},{key:"selectJoinColumn",value:function(e,t){"originTable"===t?this.setState({originJoinIndex:e.index}):this.setState({joinJoinIndex:e.index})}},{key:"runJoin",value:function(e,t,a,r){var n=this,l=this.state.joinTableData.slice(),o="",i="";"custom"===t?(o=this.state.originJoinIndex,i=this.state.joinJoinIndex):(o=a,i=r);for(var s=this.state.tableHeader.slice(),c=this.state.optionsMap.slice(),u=this.state.selectedClassAnnotation.slice(),p=0;p<s.length;++p)""===s[p]&&(s.splice(p,1),--p);for(var h=0;h<l[0].length;++h)h!==i&&s.push([{value:l[0][h].data,label:l[0][h].data}]);for(var d=1;d<l[0].length;++d)c.push([]);re([de(this.state.originTableArray[this.state.joinTableIndex])]).then((function(e){e[0].splice(0,0,[]);for(var t=0;t<e[0].length;++t)t!==i&&u.push(e[0][t]);console.log(u);for(var a=Z.a.cloneDeep(n.state.tableData),r=[],c=[],p=0;p<l[0].length;++p)c.push({value:l[0][p].data,label:l[0][p].data});for(var h=[],d=1;d<l.length;++d){for(var g=[],b=0;b<l[d].length;++b){var v=l[d][b].data,f=[],m=l[d][b].origin+": "+c[b].value+": "+l[d][b].data;f.push(m),g.push({data:v,origin:f})}h.push(g)}for(var C=0;C<a.length;++C){for(var y=a[C][o].data,E=!1,k=0;k<h.length;++k)if(h[k][i].data===y){for(var A=Z.a.cloneDeep(a[C]),N=0;N<h[k].length;++N)N!==i&&A.push(h[k][N]);r.push(A),E=!0}if(!1===E){for(var I=Z.a.cloneDeep(a[C]),x=0;x<h[0].length;++x)x!==i&&I.push({data:"N/A",origin:[]});r.push(I)}}var D=n.getNeighbourPromise(r,"subject",n.state.keyColIndex),w=n.getNeighbourPromise(r,"object",n.state.keyColIndex),S=Z.a.sampleSize(r,Math.min(r.length,3));re(je(S,-1,n.state.usecaseSelected)).then((function(e){re(D).then((function(t){re(w).then((function(a){var l=Ne(t,a),o=l.keyColNeighbours,i=l.firstDegNeighbours,c=Te(S,-1,e,n.state.usecaseSelected),p={curActionInfo:n.state.curActionInfo,tableData:n.state.tableData,tableHeader:n.state.tableHeader,keyColNeighbours:n.state.keyColNeighbours,firstDegNeighbours:n.state.firstDegNeighbours,selectedClassAnnotation:n.state.selectedClassAnnotation,previewColIndex:n.state.previewColIndex,typeRecord:n.state.typeRecord};n.setState({curActionInfo:{task:"afterPopulateColumn"},tableData:r,tableHeader:s,keyColNeighbours:o,firstDegNeighbours:i,selectedClassAnnotation:u,showJoinModal:!1,previewColIndex:-1,lastAction:"runJoin",prevState:p,typeRecord:c})}))}))}))}))}},{key:"togglePreviewElement",value:function(e,t){var a=this.state.previewInfoExpanded.slice();a[t]=!a[t],this.setState({previewInfoExpanded:a})}},{key:"handleUnionPaste",value:function(e){var t=this;document.body.classList.add("waiting"),e.preventDefault();var a=(e.clipboardData||window.clipboardData).getData("text");if(a.includes("https://en.wikipedia.org/wiki/")){var r=[];r.push(ae(a)),re(r).then((function(e){for(var r=e[0],n=(new DOMParser).parseFromString(r,"text/html").getElementsByClassName("wikitable"),l=[],o=0;o<n.length;++o)"TABLE"===n[o].tagName&&void 0!==n[o].rows&&l.push(n[o]);for(var i=[],s=0;s<l.length;++s)i.push(!1);document.body.classList.remove("waiting"),t.setState({unionURL:a,unionTableArray:l,unionOpenList:i})}))}else document.body.classList.remove("waiting"),alert("Please paste a valid Wikipedia link.")}},{key:"toggleUnionTable",value:function(e,t){var a=this.state.unionOpenList.slice();a[t]=!a[t];for(var r=0;r<a.length;++r)r!==t&&(a[r]=!1);this.setState({unionOpenList:a})}},{key:"showUnionAlign",value:function(e,t){this.setState({showUnionModal:!0})}},{key:"cancelUnionAlign",value:function(){this.setState({showUnionModal:!1})}},{key:"hardcodeUnion",value:function(e){var t=this;document.body.classList.add("waiting");for(var a=ge(this.state.unionTableArray[0],""),r=[],n=0;n<a.length;++n){var l=te("https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("select+%3Fo%0D%0Awhere+%7B%0D%0Adbr%3A"+("N/A"===a[n][2].data?"NONEXISTINGSTRING":ne(a[n][2].data))+"+dbo%3Astarring+%3Fo.%0D%0A%7D&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+");r.push(l)}re(r).then((function(e){for(var r=[],n=0;n<a.length;++n){var l=[];if(l.push(a[n][2]),l.push(a[n][4]),l.push({data:"",origin:""}),0===e[n].results.bindings.length)l.push({data:"N/A"});else{for(var o="",i=0;i<e[n].results.bindings.length;++i)i>0&&(o+=";"),o+=oe(e[n].results.bindings[i].o.value);l.push({data:o,origin:""})}l.push(a[n][5]),r.push(l)}var s=Z.a.cloneDeep(t.state.tableData);s=s.concat(r),document.body.classList.remove("waiting"),t.setState({showUnionModal:!1,tableData:s})}))}},{key:"handleFileChange",value:function(e){var t=this;document.body.classList.add("waiting"),console.log("File just uploaded");var a=e.target.files[0],r=new FileReader;r.readAsText(a),console.log("Reading file is done"),r.onload=function(){var e=Object(g.a)(d.a.mark((function e(a){var r,n,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.target.result,e.next=3,JSON.parse(r);case 3:n=e.sent,console.log(n),(l=[]).push(ae(n.urlPasted)),re(l).then((function(e){for(var a=e[0],r=(new DOMParser).parseFromString(a,"text/html").getElementsByClassName("wikitable"),l=[],o=0;o<r.length;++o)"TABLE"===r[o].tagName&&void 0!==r[o].rows&&l.push(r[o]);l="startTable"===n.usecaseSelected?l:n.originTableArray,document.body.classList.remove("waiting"),t.setState({urlPasted:n.urlPasted,tablePasted:n.tablePasted,usecaseSelected:n.usecaseSelected,pageHidden:n.pageHidden,iframeURL:n.iframeURL,curActionInfo:n.curActionInfo,lastAction:n.lastAction,prevState:n.prevState,showSetting:!1,showTableSelection:n.showTableSelection,tabIndex:n.tabIndex,showUnionTables:n.showUnionTables,showJoinTables:n.showJoinTables,keyColIndex:n.keyColIndex,tableHeader:n.tableHeader,tableData:n.tableData,optionsMap:n.optionsMap,keyColNeighbours:n.keyColNeighbours,firstDegNeighbours:n.firstDegNeighbours,firstColSelection:n.firstColSelection,firstColChecked:n.firstColChecked,firstColFilled:n.firstColFilled,firstColText:n.firstColIndex,keyCheckedIndex:n.keyCheckedIndex,firstColHeaderInfo:n.firstColHeaderInfo,otherColSelection:n.otherColSelection,otherColChecked:n.otherColChecked,otherCheckedIndex:n.otherCheckedIndex,otherColText:n.otherColText,originTableArray:l,tableOpenList:n.tableOpenList,selectedTableIndex:n.selectedTableIndex,selectedClassAnnotation:n.selectedClassAnnotation,tableDataExplore:n.tableDataExplore,propertyNeighbours:n.propertyNeighbours,semanticEnabled:n.semanticEnabled,unionCutOff:n.unionCutOff,showFilter:!1,checkAll:!0,curFilterIndex:-1,dataAndChecked:[],filterMin:null,filterMax:null,showJoinModal:!1,joinTableIndex:-1,joinTableData:[],originColOptions:[],joinColOptions:[],originJoinIndex:-1,joinJoinIndex:-1,joinPairRecord:[],previewColIndex:n.previewColIndex,selectedCell:n.selectedCell,previewInfoArray:n.previewInfoArray,previewInfoExpanded:n.previewInfoExpanded,unionURL:n.unionURL,unionTableArray:n.unionTableArray,unionOpenList:n.unionOpenList,showUnionModal:!1,semanticTree:n.semanticTree,typeRecord:n.typeRecord})}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},{key:"render",value:function(){var e,t=" bottom-content",a="row top-content";return this.state.pageHidden&&(t=" bottom-content-hidden",a="row top-content-large"),e=""===this.state.urlPasted?n.a.createElement(F,{handleURLPaste:this.handleURLPaste,handleFileChange:this.handleFileChange}):n.a.createElement("div",null,n.a.createElement("div",{className:"header"},n.a.createElement(y,{copyTable:this.copyTable,undoPreviousStep:this.undoPreviousStep,openModal:this.openModal,fullState:this.state})),n.a.createElement("div",{className:"mainbody"},n.a.createElement("div",{className:""},n.a.createElement("div",{className:a},n.a.createElement("div",{className:"col-md-7 small-padding table-panel"},n.a.createElement(P,{urlPasted:this.state.urlPasted,usecaseSelected:this.state.usecaseSelected,tableHeader:this.state.tableHeader,tableData:this.state.tableData,keyColIndex:this.state.keyColIndex,onCellChange:this.cellChange,selectColHeader:this.selectColHeader,getKeyOptions:this.getKeyOptions,optionsMap:this.state.optionsMap,contextAddColumn:this.contextAddColumn,contextDeleteColumn:this.contextDeleteColumn,contextSetColumn:this.contextSetColumn,originPreviewPage:this.originPreviewPage,showFilterMethods:this.showFilterMethods,firstColFilled:this.state.firstColFilled,handlePlusClick:this.handlePlusClick,firstColHeaderInfo:this.state.firstColHeaderInfo,getOtherOptions:this.getOtherOptions,previewColIndex:this.state.previewColIndex})),n.a.createElement("div",{className:"col-md-5 small-padding action-panel"},n.a.createElement(z,{urlPasted:this.state.urlPasted,usecaseSelected:this.state.usecaseSelected,curActionInfo:this.state.curActionInfo,handleStartSubject:this.handleStartSubject,populateKeyColumn:this.populateKeyColumn,populateOtherColumn:this.populateOtherColumn,sameNeighbourDiffRow:this.sameNeighbourDiffRow,sameNeighbourOneRow:this.sameNeighbourOneRow,populateRecommendation:this.populateRecommendation,populateStartRecommend:this.populateStartRecommend,handleStartTable:this.handleStartTable,propertyNeighbours:this.state.propertyNeighbours,togglePropertyNeighbours:this.togglePropertyNeighbours,toggleSibling:this.toggleSibling,toggleOtherTable:this.toggleOtherTable,unionTable:this.unionTable,unionPage:this.unionPage,unionProperty:this.unionProperty,tabIndex:this.state.tabIndex,handleTabSwitch:this.handleTabSwitch,showTableSelection:this.state.showTableSelection,toggleTableSelection:this.toggleTableSelection,originTableArray:this.state.originTableArray,tableOpenList:this.state.tableOpenList,toggleTable:this.toggleTable,selectedTableIndex:this.state.selectedTableIndex,showUnionTables:this.state.showUnionTables,showJoinTables:this.state.showJoinTables,toggleUnionJoin:this.toggleUnionJoin,handleJoinTable:this.handleJoinTable,firstColSelection:this.state.firstColSelection,firstColChecked:this.state.firstColChecked,firstColText:this.state.firstColText,firstColFilled:this.state.firstColFilled,keyColIndex:this.state.keyColIndex,toggleFirstNeighbour:this.toggleFirstNeighbour,firstColTextChange:this.firstColTextChange,tableHeader:this.state.tableHeader,keyCheckedIndex:this.state.keyCheckedIndex,addToFirstCol:this.addToFirstCol,confirmAddFirstCol:this.confirmAddFirstCol,otherColSelection:this.state.otherColSelection,otherColChecked:this.state.otherColChecked,otherColText:this.state.otherColText,otherCheckedIndex:this.state.otherCheckedIndex,toggleOtherNeighbour:this.toggleOtherNeighbour,otherColTextChange:this.otherColTextChange,contextSortColumn:this.contextSortColumn,contextDedupColumn:this.contextDedupColumn,openFilter:this.openFilter,previewInfoArray:this.state.previewInfoArray,previewInfoExpanded:this.state.previewInfoExpanded,selectedCell:this.state.selectedCell,togglePreviewElement:this.togglePreviewElement,keyColNeighbours:this.state.keyColNeighbours,unionURL:this.state.unionURL,handleUnionPaste:this.handleUnionPaste,unionTableArray:this.state.unionTableArray,unionOpenList:this.state.unionOpenList,toggleUnionTable:this.toggleUnionTable,showUnionAlign:this.showUnionAlign,unionCustomized:this.unionCustomized}))),n.a.createElement("div",{className:t},n.a.createElement("div",null,n.a.createElement(Y,{pageHidden:this.state.pageHidden,iframeURL:this.state.iframeURL,toggleWikiPage:this.toggleWikiPage}))),n.a.createElement("div",null,n.a.createElement(x,{showSetting:this.state.showSetting,closeModal:this.closeModal,semanticEnabled:this.state.semanticEnabled,toggleSemantic:this.toggleSemantic,unionCutOff:this.state.unionCutOff,unionCutOffChange:this.unionCutOffChange})),n.a.createElement("div",null,n.a.createElement(w,{showFilter:this.state.showFilter,dataAndChecked:this.state.dataAndChecked,checkAll:this.state.checkAll,applyFilter:this.applyFilter,cancelFilter:this.cancelFilter,toggleChecked:this.toggleChecked,toggleAll:this.toggleAll,tableData:this.state.tableData,curFilterIndex:this.state.curFilterIndex,filterMin:this.state.filterMin,filterMax:this.state.filterMax,handleRangeFilter:this.handleRangeFilter})),n.a.createElement("div",null,n.a.createElement(O,{showJoin:this.state.showJoinModal,cancelJoin:this.cancelJoin,originColOptions:this.state.originColOptions,joinColOptions:this.state.joinColOptions,originJoinIndex:this.state.originJoinIndex,joinJoinIndex:this.state.joinJoinIndex,selectJoinColumn:this.selectJoinColumn,runJoin:this.runJoin,joinPairRecord:this.state.joinPairRecord})),n.a.createElement("div",null,n.a.createElement(j,{showUnionModal:this.state.showUnionModal,cancelUnionAlign:this.cancelUnionAlign,hardcodeUnion:this.hardcodeUnion})))),n.a.createElement("div",{className:"footer"},n.a.createElement(E,null))),n.a.createElement("div",null,e)}}]),t}(r.Component);function te(e){return fetch("https://mysterious-ridge-15861.herokuapp.com/"+e).then((function(e){if(!e.ok)throw Error(1);return e})).then((function(e){return e.json()})).catch((function(e){return document.body.classList.remove("waiting"),1}))}function ae(e){return fetch("https://mysterious-ridge-15861.herokuapp.com/"+e).then((function(e){return e.text()})).catch((function(e){return document.body.classList.remove("waiting"),1}))}function re(e){return Promise.all(e)}function ne(e){return e.replace(/\$/g,"%5Cu0024").replace(/%/g,"%5Cu0025").replace(/!/g,"%5Cu0021").replace(/"/g,"%5Cu0022").replace(/#/g,"%5Cu0023").replace(/&/g,"%5Cu0026").replace(/'/g,"%5Cu0027").replace(/\(/g,"%5Cu0028").replace(/\)/g,"%5Cu0029").replace(/\*/g,"%5Cu002A").replace(/\+/g,"%5Cu002B").replace(/-/g,"%5Cu002D").replace(/;/g,"%5Cu003B").replace(/</g,"%5Cu003C").replace(/=/g,"%5Cu003D").replace(/>/g,"%5Cu003E").replace(/\?/g,"%5Cu003F").replace(/\./g,"%5Cu002E").replace(/\//g,"%5Cu002F").replace(/,/g,"%5Cu002C").replace(/\s/g,"_").replace(/@/g,"%5Cu0040").replace(/\^/g,"%5Cu005E").replace(/~/g,"%5Cu007E").replace(/`/g,"%5Cu0060").replace(/\|/g,"%5Cu007C").replace(/\[/g,"%5Cu005B").replace(/\\/g,"%5Cu005C").replace(/\]/g,"%5Cu005D").replace(/\{/g,"%5Cu007B").replace(/\}/g,"%5Cu007D")}function le(e){return e.replace(/%E2%80%93/g,"%5Cu2013").replace(/\$/g,"%5Cu0024").replace(/!/g,"%5Cu0021").replace(/"/g,"%5Cu0022").replace(/#/g,"%5Cu0023").replace(/&/g,"%5Cu0026").replace(/'/g,"%5Cu0027").replace(/\(/g,"%5Cu0028").replace(/\)/g,"%5Cu0029").replace(/\*/g,"%5Cu002A").replace(/\+/g,"%5Cu002B").replace(/-/g,"%5Cu002D").replace(/;/g,"%5Cu003B").replace(/</g,"%5Cu003C").replace(/=/g,"%5Cu003D").replace(/>/g,"%5Cu003E").replace(/\?/g,"%5Cu003F").replace(/\./g,"%5Cu002E").replace(/\//g,"%5Cu002F").replace(/,/g,"%5Cu002C").replace(/\s/g,"_").replace(/@/g,"%5Cu0040").replace(/\^/g,"%5Cu005E").replace(/~/g,"%5Cu007E").replace(/`/g,"%5Cu0060").replace(/\|/g,"%5Cu007C").replace(/\[/g,"%5Cu005B").replace(/\\/g,"%5Cu005C").replace(/\]/g,"%5Cu005D").replace(/\{/g,"%5Cu007B").replace(/\}/g,"%5Cu007D")}function oe(e){return!0===e.includes("http://dbpedia.org/resource/")&&(e=e.slice(28)),e}function ie(e,t,a){var r=t.filter((function(e){return e.p.value.slice(28).length>1&&(e.p.value.includes("ontology")||e.p.value.includes("property"))&&!(e.p.value.includes("wikiPage")||e.p.value.includes("align")||e.p.value.includes("abstract")||e.p.value.includes("caption")||e.p.value.includes("image")||e.p.value.includes("width")||e.p.value.includes("thumbnail")||e.p.value.includes("blank")||e.p.value.includes("fec")||e.p.value.includes("viaf")||e.p.value.includes("soundRecording")||e.p.value.includes("votesmart")||e.p.value.includes("wordnet")||e.p.value.includes("float")||e.p.value.includes("bbr")||"http://dbpedia.org/property/alt"===e.p.value||"http://dbpedia.org/property/by"===e.p.value||"http://dbpedia.org/property/onlinebooks"===e.p.value||"http://dbpedia.org/property/signature"===e.p.value||"http://dbpedia.org/property/video"===e.p.value||"http://dbpedia.org/property/logo"===e.p.value||"http://dbpedia.org/property/shorts"===e.p.value||"http://dbpedia.org/property/patternS"===e.p.value||"http://dbpedia.org/property/patternB"===e.p.value||"http://dbpedia.org/property/body"===e.p.value||"http://dbpedia.org/property/hShorts"===e.p.value||"http://dbpedia.org/property/hPatternS"===e.p.value||"http://dbpedia.org/property/hPatternB"===e.p.value||"http://dbpedia.org/property/hBody"===e.p.value||"http://dbpedia.org/property/aShorts"===e.p.value||"http://dbpedia.org/property/aPatternS"===e.p.value||"http://dbpedia.org/property/aPatternB"===e.p.value||"http://dbpedia.org/property/aBody"===e.p.value||"http://dbpedia.org/property/3Shorts"===e.p.value||"http://dbpedia.org/property/3PatternS"===e.p.value||"http://dbpedia.org/property/3PatternB"===e.p.value||"http://dbpedia.org/property/3Body"===e.p.value||"http://dbpedia.org/property/nba"===e.p.value||"http://dbpedia.org/ontology/termPeriod"===e.p.value)}));r=r.sort((function(e,t){return e.p.value.slice(28)>t.p.value.slice(28)?1:e.p.value.slice(28)<t.p.value.slice(28)?-1:e.p.value.includes("ontology")&&t.p.value.includes("property")?-1:1}));for(var n=1;n<r.length;++n)r[n].p.value.includes("property")&&r[n-1].p.value.includes("ontology")&&r[n].p.value.slice(28)===r[n-1].p.value.slice(28)&&(r.splice(n,1),--n);if((r=(r=r.filter((function(e){return void 0===e.subPropertyOf||e.subPropertyOf.value.includes("DUL.owl")}))).sort((function(e,t){return e.p.value.slice(28)>t.p.value.slice(28)?1:-1}))).length>0){var l=1,o=r[0].p.value.slice(28),i=[];i.push(oe("subject"===a?r[0].o.value:r[0].s.value));for(var s=void 0!==r[0].range?r[0].range.value:"",c=void 0!==r[0].subPropertyOf?r[0].subPropertyOf.value:"",u=1;u<r.length;++u){var p=r[u].p.value.slice(28);if(p===o)++l,i.push(oe("subject"===a?r[u].o.value:r[u].s.value));else{var h=o;"object"===a&&(h="is "+h+" of");var d={value:o,label:h,type:a,count:l,filledCount:1,data:i.length<=10?i:i.slice(0,10),range:s,subPropertyOf:c};e.push(d),l=1,o=p,i=[oe("subject"===a?r[u].o.value:r[u].s.value)],s=void 0!==r[u].range?r[u].range.value:"",c=void 0!==r[u].subPropertyOf?r[u].subPropertyOf.value:""}}var g=o;"object"===a&&(g="is "+g+" of");var b={value:o,label:g,type:a,count:l,filledCount:1,data:i.length<=10?i:i.slice(0,10),range:s,subPropertyOf:c};e.push(b)}return e}function se(e,t){var a=e.filter((function(e){return e.p.value.slice(28).length>1&&(e.p.value.includes("ontology")||e.p.value.includes("property"))&&!(e.p.value.includes("wikiPage")||e.p.value.includes("align")||e.p.value.includes("abstract")||e.p.value.includes("caption")||e.p.value.includes("image")||e.p.value.includes("width")||e.p.value.includes("thumbnail")||e.p.value.includes("blank")||e.p.value.includes("fec")||e.p.value.includes("viaf")||e.p.value.includes("soundRecording")||e.p.value.includes("votesmart")||e.p.value.includes("wordnet")||e.p.value.includes("float")||e.p.value.includes("bbr")||"http://dbpedia.org/property/alt"===e.p.value||"http://dbpedia.org/property/by"===e.p.value||"http://dbpedia.org/property/onlinebooks"===e.p.value||"http://dbpedia.org/property/signature"===e.p.value||"http://dbpedia.org/property/video"===e.p.value||"http://dbpedia.org/property/logo"===e.p.value||"http://dbpedia.org/property/shorts"===e.p.value||"http://dbpedia.org/property/patternS"===e.p.value||"http://dbpedia.org/property/patternB"===e.p.value||"http://dbpedia.org/property/body"===e.p.value||"http://dbpedia.org/property/hShorts"===e.p.value||"http://dbpedia.org/property/hPatternS"===e.p.value||"http://dbpedia.org/property/hPatternB"===e.p.value||"http://dbpedia.org/property/hBody"===e.p.value||"http://dbpedia.org/property/aShorts"===e.p.value||"http://dbpedia.org/property/aPatternS"===e.p.value||"http://dbpedia.org/property/aPatternB"===e.p.value||"http://dbpedia.org/property/aBody"===e.p.value||"http://dbpedia.org/property/3Shorts"===e.p.value||"http://dbpedia.org/property/3PatternS"===e.p.value||"http://dbpedia.org/property/3PatternB"===e.p.value||"http://dbpedia.org/property/3Body"===e.p.value||"http://dbpedia.org/property/nba"===e.p.value||"http://dbpedia.org/ontology/termPeriod"===e.p.value)})),r=[];if((a=a.sort((function(e,t){return e.p.value.slice(28)>t.p.value.slice(28)?1:-1}))).length>1){r.push({key:"subject"===t?a[0].p.value.slice(28):"is "+a[0].p.value.slice(28)+" of",value:[oe(a[0].o.value)]});for(var n=0,l=1;l<a.length;++l){a[l].p.value.slice(28)===a[l-1].p.value.slice(28)?r[n].value.length<10&&r[n].value.push(oe(a[l].o.value)):(r.push({key:"subject"===t?a[l].p.value.slice(28):"is "+a[l].p.value.slice(28)+" of",value:[oe(a[l].o.value)]}),++n)}}var o=[];if("subject"===t){var i=e.filter((function(e){return e.p.value.includes("dc/terms/subject")}));if(i.length>0){o.push({key:"Category",value:[i[0].o.value.slice(37)]});for(var s=1;s<i.length;++s)o[0].value.push(i[s].o.value.slice(37))}}return r=o.concat(r)}function ce(e,t,a,r){for(var n=[],l=0;l<t.length;++l){for(var o=[],i=0;i<r.length;++i){var s=r[i];-1!==s?o.push(t[l][s]):o.push({data:"N/A",origin:[a]})}n.push(o)}return e.concat(n)}function ue(e){return"\n"===e[e.length-1]?e.slice(0,-1).trim().split("[")[0]:e.trim().split("[")[0]}function pe(e,t,a,r,n,l){for(var o=[],i=1;i<e.length;++i){for(var s="",c=0;c<e[i].length;++c)s+=e[i][c].value;o.push(s)}for(var u=(new DOMParser).parseFromString(t,"text/html").getElementsByClassName("wikitable"),p=[],h=0;h<u.length;++h)"TABLE"===u[h].tagName&&void 0!==u[h].rows&&p.push(u[h]);for(var d=[],g=[],b=0;b<p.length;++b)g.push(he(p[b],o,a,r,n,l));return re(g).then((function(e){for(var t=0;t<e.length;++t)d.push(e[t]);return(d=d.filter((function(e){return-1!==e}))).sort((function(e,t){return e.unionScore<t.unionScore?1:-1})),Promise.resolve(d)}))}function he(e,t,a,r,n,l){for(var o=e.rows[0].cells,i=[],s=[],c=[],u=[],p=0;p<o.length;++p){var h=ue(o[p].innerText);i.push(h),s.push(p)}if(i.length>=t.length*n){for(var d=0,g=[],b=0;b<t.length;++b){var v=i.indexOf(t[b]);-1!==v?(g.push(v),d+=1/t.length):g.push("null")}if(i.length===t.length){for(var f=!0,m=0;m<g.length;++m)if("null"!==g[m]&&g[m]!==m){f=!1;break}if(!0===f)for(var C=0;C<g.length;++C)"null"===g[C]&&(i[C].includes(t[C])||t[C].includes(i[C]))&&(g[C]=C,d+=1/t.length);1===d&&(d+=.01)}if("enabled"===r){if(d<.999){s=s.filter((function(e){return g.indexOf(e)<0}));for(var y=0;y<g.length;++y)"null"===g[y]&&c.push(y);u.push(de(e,s,l))}return re(u).then((function(r){if(d>=.999)return Promise.resolve({isOpen:!1,unionScore:d,colMapping:g,data:e,title:i});var l=function(){var l=r[0].slice();if(l.length>0)for(var o=0;o<c.length;++o){var u=c[o];if(a[u].length>0)for(var p=function(e){if(l[e].length>0)if("Number"===a[u][0]||"Number"===l[e][0]){if(a[u][0]===l[e][0])return g[u]=s[e],d+=1/t.length,s.splice(e,1),l.splice(e,1),--e,h=e,"break"}else{var r=a[u].filter((function(t){return h=e,l[e].indexOf(t)>=0}));if(r.length>0){var n=a[u].length,o=l[e].length;if(ve(r.length,780,n,o)>.999)return g[u]=s[e],d+=1/t.length,s.splice(e,1),l.splice(e,1),--e,h=e,"break"}}h=e},h=0;h<s.length;++h){if("break"===p(h))break}}return d>=n?{v:Promise.resolve({isOpen:!1,unionScore:d,colMapping:g,data:e,title:i})}:{v:Promise.resolve(-1)}}();return"object"===typeof l?l.v:void 0}))}return d>=n?Promise.resolve({isOpen:!1,unionScore:d,colMapping:g,data:e,title:i}):Promise.resolve(-1)}return Promise.resolve(-1)}function de(e,t,a){for(var r=e,n=[],l=0;l<r.rows.length;++l){for(var o=[],i=0;i<r.rows[l].cells.length;++i){var s=ue(r.rows[l].cells[i].innerText);if(1===l)for(var c=r.rows[l].cells[i].getElementsByTagName("a"),u=0;u<c.length;++u)if(""!==c[u].innerText&&"["!==c[u].innerText[0]){var p=c[u].href.split("/");s=p[p.length-1]}var h=r.rows[l].cells[i].rowSpan,d=r.rows[l].cells[i].colSpan;o.push({data:s,rowSpan:h,colSpan:d})}n.push(o)}for(var g=0;g<n.length;++g)for(var v=0;v<n[g].length;++v){var f=n[g][v].data;if(n[g][v].colSpan>1)for(var m=1;m<n[g][v].colSpan;++m)n[g].splice(v+1,0,{data:f,rowSpan:1,colSpan:1})}for(var C=0;C<n.length;++C)for(var y=0;y<n[C].length;++y){var E=n[C][y].data;if(n[C][y].rowSpan>1)for(var k=1;k<n[C][y].rowSpan;++k)C+k<n.length&&n[C+k].splice(y,0,{data:E,rowSpan:1,colSpan:1})}var A=[],N=Math.min(1,n.length-1);if(void 0===t){t=[];for(var I=0;I<n[0].length;++I)t.push(I)}for(var x=0;x<t.length;++x)for(var D=t[x],w=1;w<=N;++w){var S=void 0===n[w][D]?"NONEXISTING":ne(n[w][D].data);if(isNaN(Number(S))||""===S)if(S.length>40)A.push(Promise.resolve(["Null"]));else{void 0!==S&&""!==S||(S="NONEXISTING");var O="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+("SELECT+%3Fo%0D%0AWHERE+%7B%0D%0A++++++dbr%3A"+S+"+rdf%3Atype+%3Fo.%0D%0A++++++BIND%28STR%28%3Fo%29+AS+%3FoString+%29.%0D%0A++++++FILTER%28regex%28%3FoString%2C%22dbpedia.org%2Fontology%2F%22%2C%22i%22%29%29%0D%0A%7D%0D%0A&")+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+";A.push(te(O))}else A.push(Promise.resolve(["Number"]))}return re(A).then((function(e){for(var a=[],r=0;r<t.length;++r){var n=[];if(void 0!==e[N*r])if(void 0!==e[N*r][0])"Number"===e[N*r][0]?a.push(["Number"]):"Null"===e[N*r][0]&&a.push([]);else{for(var l=0;l<N;++l){for(var o=[],i=e[N*r+l].results.bindings,s=0;s<i.length;++s)o.push(i[s].o.value.slice(28));n=Object(b.a)(new Set([].concat(Object(b.a)(n),o)))}a.push(n)}}return Promise.resolve(a)}))}function ge(e,t){for(var a=e,r=[],n=0;n<a.rows.length;++n){for(var l=[],o=0;o<a.rows[n].cells.length;++o){var i=ue(a.rows[n].cells[o].innerText);if(n>0)for(var s=a.rows[n].cells[o].getElementsByTagName("a"),c=0;c<s.length;++c)if(""!==s[c].innerText&&"["!==s[c].innerText[0]){var u=s[c].href.split("/");i=decodeURIComponent(u[u.length-1])}var p=a.rows[n].cells[o].rowSpan,h=a.rows[n].cells[o].colSpan;l.push({data:i,origin:t,rowSpan:p,colSpan:h})}r.push(l)}for(var d=0;d<r.length;++d)for(var g=0;g<r[d].length;++g){var b=r[d][g].data;if(r[d][g].colSpan>1)for(var v=1;v<r[d][g].colSpan;++v)r[d].splice(g+1,0,{data:b,origin:t,rowSpan:r[d][g].rowSpan,colSpan:1})}for(var f=0;f<r.length;++f)for(var m=0;m<r[f].length;++m){var C=r[f][m].data;if(r[f][m].rowSpan>1)for(var y=1;y<r[f][m].rowSpan;++y)f+y<r.length&&r[f+y].splice(m,0,{data:C,origin:t,rowSpan:1,colSpan:1})}r[0].splice(0,0,{data:"OriginURL",origin:t,rowSpan:1,colSpan:1});for(var E=1;E<r.length;++E)r[E].splice(0,0,{data:t,origin:"null",rowSpan:1,colSpan:1});return r}function be(e){for(var t=[],a=0;a<e[0].length;++a)t.push({value:e[0][a].data,label:e[0][a].data});for(var r=[],n=1;n<e.length;++n){for(var l=[],o=Math.min(e[n].length,t.length),i=0;i<o;++i){var s=e[n][i].data,c=[],u=e[n][i].origin+": "+t[i].value+": "+e[n][i].data;c.push(u),l.push({data:s,origin:c})}r.push(l)}return r}function ve(e,t,a,r){for(var n=0,l=Object(f.a)(t,r),o=0;o<=e;++o)n+=Object(f.a)(a,o)*Object(f.a)(t-a,r-o)/l;return n}function fe(e){var t=e,a=e.indexOf("(");return-1!==a&&(t=t.slice(0,a-1)),t.replace(/_/g," ")}function me(e){for(var t=[],a=Z.a.cloneDeep(e),r=0;r<a.length;++r)t=t.concat(a[r]);if(t.sort((function(e,t){return e.value<t.value?-1:1})),t.length>0)for(var n=1;n<t.length;++n){var l=t[n-1],o=t[n];l.value===o.value&&(t[n-1].filledCount=t[n-1].filledCount+1,t[n-1].count=Math.max(l.count,o.count),t.splice(n,1),--n)}t.sort((function(e,t){return e.filledCount<t.filledCount?1:-1}));for(var i=0;i<t.length;++i){var s=Math.round(t[i].filledCount/a.length*100)/100;t[i].filledPercent=s,t[i].label=t[i].label+" ("+s+")"}return t}function Ce(e){for(var t=[],a=Z.a.cloneDeep(e),r=0;r<a.length;++r){for(var n={},l=0;l<a[r].length;++l){var o=Z.a.uniq(a[r][l].data.slice());n[a[r][l].value]=o}t.push(n)}return t}function ye(e){for(var t="",a=0;a<e.length;++a){a>0&&(t+=" OR "),t+="object"===e[a].type?"is "+e[a].value+" of":e[a].value}return t}function Ee(e){for(var t=Z.a.cloneDeep(e),a=0;a<t.length;++a){for(var r=[],n=0;n<t.length;++n)if(a!==n){var l=t[a].value.toUpperCase(),o=t[n].value.toUpperCase();(l.includes(o)||o.includes(l))&&r.push({value:t[n].value,type:t[n].type,relation:"string"}),(t[a].range===t[n].range&&""!==t[a].range||t[a].subPropertyOf===t[n].subPropertyOf&&""!==t[a].subPropertyOf)&&r.push({value:t[n].value,type:t[n].type,relation:"semantic"})}t[a].recommendNeighbours=r}return t}function ke(e,t){for(var a=0,r=0;r<t.length;++r)t[r].p.value===e&&++a;return a}function Ae(e){for(var t=!1,a="select+%3Fsomevar%0D%0Awhere+%7B",r=0;r<e.length;++r){var n="";"dct"===e[r].pDataset?n="%0D%0A%3Fsomevar+dct%3Asubject+dbc%3A"+ne(e[r].oValue)+".":"http://www.w3.org/2001/XMLSchema#date"===e[r].oType?n="%0D%0A%3Fsomevar+"+e[r].pDataset+"%3A"+ne(e[r].pValue)+"+%22"+e[r].oValue+"%22%5E%5E%3Chttp%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%23date%3E.":"http://www.w3.org/2001/XMLSchema#integer"===e[r].oType?n="%0D%0A%3Fsomevar+"+e[r].pDataset+"%3A"+ne(e[r].pValue)+"+%22"+e[r].oValue+"%22%5E%5E%3Chttp%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%23integer%3E.":"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"===e[r].oType?n="%0D%0A%3Fsomevar+"+e[r].pDataset+"%3A"+ne(e[r].pValue)+"+%22"+e[r].oValue.replace(/\s/g,"+")+"%22%5E%5E%3Chttp%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23langString%3E.":"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"===e[r].oType?n="%0D%0A%3Fsomevar+"+e[r].pDataset+"%3A"+ne(e[r].pValue)+"+%22"+e[r].oValue+"%22%5E%5E%3Chttp%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%23nonNegativeInteger%3E.":""===e[r].oType?n="%0D%0A%3Fsomevar+"+e[r].pDataset+"%3A"+ne(e[r].pValue)+"+dbr%3A"+ne(e[r].oValue)+".":(console.log(e[r].oType),t=!0),a+=n}return a+="%0D%0A%7D%0D%0A&",!0===t?"ERROR":"https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+a+"format=application%2Fsparql-results%2Bjson&CXML_redir_for_subjs=121&CXML_redir_for_hrefs=&timeout=30000&debug=on&run=+Run+Query+"}function Ne(e,t){for(var a={},r=[],n=0;n<e.length;++n){var l=ie([],e[n].results.bindings,"subject");r.push(l)}a.subject=Ce(r);var o=me(r);o=Ee(o);for(var i=[],s=0;s<t.length;++s){var c=ie([],t[s].results.bindings,"object");i.push(c)}a.object=Ce(i);var u=me(i);return u=Ee(u),{firstDegNeighbours:a,keyColNeighbours:o.concat(u)}}function Ie(e){for(var t=[],a=[],r=[],n=0;n<e.length;++n)for(var l=e[n].results.bindings.filter((function(e){return e.p.value.slice(28).length>1&&(e.p.value.includes("ontology")||e.p.value.includes("property")||e.p.value.includes("dc/terms/subject"))&&!(e.p.value.includes("wikiPage")||e.p.value.includes("align")||e.p.value.includes("abstract")||e.p.value.includes("caption")||e.p.value.includes("image")||e.p.value.includes("width")||e.p.value.includes("thumbnail")||e.p.value.includes("blank")||e.p.value.includes("fec")||e.p.value.includes("viaf")||e.p.value.includes("soundRecording")||e.p.value.includes("votesmart")||e.p.value.includes("wordnet")||e.p.value.includes("float")||e.p.value.includes("bbr")||"http://dbpedia.org/property/alt"===e.p.value||"http://dbpedia.org/property/by"===e.p.value||"http://dbpedia.org/property/onlinebooks"===e.p.value||"http://dbpedia.org/property/signature"===e.p.value||"http://dbpedia.org/property/video"===e.p.value||"http://dbpedia.org/property/logo"===e.p.value||"http://dbpedia.org/property/shorts"===e.p.value||"http://dbpedia.org/property/patternS"===e.p.value||"http://dbpedia.org/property/patternB"===e.p.value||"http://dbpedia.org/property/body"===e.p.value||"http://dbpedia.org/property/hShorts"===e.p.value||"http://dbpedia.org/property/hPatternS"===e.p.value||"http://dbpedia.org/property/hPatternB"===e.p.value||"http://dbpedia.org/property/hBody"===e.p.value||"http://dbpedia.org/property/aShorts"===e.p.value||"http://dbpedia.org/property/aPatternS"===e.p.value||"http://dbpedia.org/property/aPatternB"===e.p.value||"http://dbpedia.org/property/aBody"===e.p.value||"http://dbpedia.org/property/3Shorts"===e.p.value||"http://dbpedia.org/property/3PatternS"===e.p.value||"http://dbpedia.org/property/3PatternB"===e.p.value||"http://dbpedia.org/property/3Body"===e.p.value||"http://dbpedia.org/property/nba"===e.p.value||"http://dbpedia.org/ontology/termPeriod"===e.p.value)})),o=0;o<l.length;++o)"http://purl.org/dc/terms/subject"===l[o].p.value?a.push(l[o]):r.push(l[o]);(a=Z.a.uniqBy(a,(function(e){return e.o.value}))).sort((function(e,t){return e.o.value.slice(37)<t.o.value.slice(37)?-1:1})),(r=Z.a.uniqBy(r,(function(e){return e.p.value&&e.o.value}))).sort((function(e,t){return void 0===e.o.datatype&&void 0!==t.o.datatype?-1:void 0===t.o.datatype&&void 0!==e.o.datatype?1:e.p.value.slice(28)<t.p.value.slice(28)?-1:1}));for(var i=0;i<a.length;++i)t.push({pValue:"category",pDataset:"dct",oValue:a[i].o.value.slice(37),oType:"",value:"category",label:a[i].o.value.slice(37)});for(var s=0;s<r.length;++s)t.push({pValue:r[s].p.value.slice(28),pDataset:r[s].p.value.includes("property")?"dbp":"dbo",oValue:oe(r[s].o.value),oType:void 0===r[s].o.datatype?"":r[s].o.datatype,value:r[s].p.value.slice(28),label:r[s].p.value.slice(28)+":"+oe(r[s].o.value)});for(var c=[],u=0;u<t.length;++u)c.push(!1);return{firstColSelection:t,firstColChecked:c}}function xe(e,t,a){console.log(a);for(var r=e[0].slice(),n=[],l=[],o=[],i=[],s=[],c=!1,u=1;u<r.length;++u){var p=r[u].origin;if(void 0===a?p.length>=2&&p.length<=4:p.length>=2&&p.length<=4&&-1===a[u]){var h=p[0],d=-1;void 0!==t&&!1!==t&&(d=t.indexOf(h.split(":")[0])-1),p=p.slice(1);for(var g=[],b=0;b<p.length;++b){var v=p[b].split(":")[0].split(" OR ")[0],f="is "===v.substring(0,3)?"object":"subject",m="object"===f?v.substring(3,v.length-3):v;g.push({value:m,type:f})}1===g.length?n.push(g):2===g.length?l.push(g):3===g.length?o.push(g):alert("Autofill information has caused an error!"),i.push(g),s.push(d)}else i.push([]),s.push(-1);p.length>4&&(c=!0)}return{longHopWarning:c,oneDegInfo:n,twoDegInfo:l,threeDegInfo:o,columnInfo:i,refInfo:s}}function De(e,t,a,r,n,l){for(var o=Z.a.cloneDeep(e),i=Z.a.cloneDeep(n),s=r;s<o.length;++s){var c=[],u=t[0],p=("subject"===u.type?i.subject:i.object)[s][u.value];if(void 0!==p&&(c=c.concat(p)),0===c.length){o[s][a].data="N/A";var h=("object"===u.type?"is "+u.value+" of":u.value)+":N/A",d=o[s][l].origin.slice();d.push(h),o[s][a].origin=d}else{var g=c[0];o[s][a].data=g;var b=("object"===u.type?"is "+u.value+" of":u.value)+":"+g,v=o[s][l].origin.slice();v.push(b),o[s][a].origin=v}}return o}function we(e,t,a,r,n){for(var l=[],o="startTable"===r?0:1,i=a;i<e.length;++i){for(var s=0,c=0;c<t.length;++c)t[c].length>o&&s++;for(var u="select",p=1;p<=s;++p)u=u+"+%3Fo"+p;u+="%0D%0A";for(var h="",d=1,g=0;g<t.length;++g)if(t[g].length>o){var b="OPTIONAL+%7Bdbr%3A",v="startTable"===r?n[g]+1:0;b=b+ne(e[i][v].data)+"+";for(var f=0;f<t[g].length;++f)f>0&&(b+="%2F"),"object"===t[g][f].type&&(b+="%5E"),b=b+"dbo%3A"+t[g][f].value;b=b+"+%3Fo"+d+"%7D.%0D%0A",d++,h+=b}var m="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+u+"where+%7B%0D%0A"+h+"%7D%0D%0Alimit+1&format=application%2Fsparql-results%2Bjson&timeout=30000&signal_void=on&signal_unconnected=on";""!==h&&l.push(te(m))}return l}function Se(e,t,a){for(var r=0,n="startTable"===a?0:1,l=0;l<e.length;++l)e[l].length>n&&e[l].length<4&&r++;for(var o=[],i=0;i<r;++i)o.push([]);for(var s=0;s<t.length;++s)for(var c=t[s].results.bindings[0],u=0;u<r;++u){var p="o"+(u+1);if(void 0===c[p])o[u].push("");else{var h=c[p].value.includes("dbpedia.org")?c[p].value.slice(28):c[p].value;o[u].push(h)}}return o}function Oe(e,t,a,r,n){for(var l=Z.a.cloneDeep(e),o=n;o<l.length;++o){var i=""===a[o-n]?"N/A":a[o-n];l[o][r].data=i;for(var s="",c=0;c<t.length;++c){c>0&&(s+="/"),s+="object"===t[c].type?"is "+t[c].value+" of":t[c].value}var u=s+":"+i,p=l[o][0].origin.slice();p.push(u),l[o][r].origin=p}return l}function je(e,t,a){var r=[],n="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query=",l="format=application%2Fsparql-results%2Bjson&timeout=30000&signal_void=on&signal_unconnected=on";if(-1!==t){for(var o=[],i=0;i<e.length;++i)o.push(e[i][t].data);for(var s=0;s<o.length;++s){var c=n+("select+%3Ftype%0D%0Awhere+%7B%0D%0Adbr%3A"+("N/A"===o[s]?"NONEXISTINGSTRING":ne(o[s]))+"+rdf%3Atype+%3Ftype.%0D%0A%7D%0D%0A&")+l;r.push(te(c))}}else{for(var u=[],p="startTable"===a?1:0;p<e[0].length;++p)for(var h=0;h<e.length;++h)u.push(e[h][p].data);for(var d=0;d<u.length;++d){var g=n+("select+%3Ftype%0D%0Awhere+%7B%0D%0Adbr%3A"+("N/A"===u[d]?"NONEXISTINGSTRING":ne(u[d]))+"+rdf%3Atype+%3Ftype.%0D%0A%7D%0D%0A&")+l;r.push(te(g))}}return r}function Te(e,t,a,r){if(-1!==t){for(var n=[],l=0;l<e.length;++l)n.push(e[l][t].data);for(var o=[],i=0;i<a.length;++i){var s=a[i].results.bindings,c=[];s=s.filter((function(e){return e.type.value.includes("dbpedia.org/ontology")}));for(var u=0;u<s.length;++u)c.push(s[u].type.value.slice(28));o.push(c)}for(var p=[],h=0;h<n.length;++h)p.push({data:n[h],type:o[h]});return p}for(var d="startTable"===r?1:0,g=[],b=d;b<e[0].length;++b){for(var v=[],f=0;f<e.length;++f)v.push(e[f][b].data);g.push(v)}for(var m=[],C=0,y=d;y<e[0].length;++y){for(var E=[],k=0;k<e.length;++k){var A=a[C*e.length+k].results.bindings,N=[];A=A.filter((function(e){return e.type.value.includes("dbpedia.org/ontology")}));for(var I=0;I<A.length;++I)N.push(A[I].type.value.slice(28));E.push(N)}++C,m.push(E)}for(var x=[],D=0;D<g.length;++D){var w=[];if(g[D].length>0&&""!==g[D][0])for(var S=0;S<g[D].length;++S)w.push({data:g[D][S],type:m[D][S]});x.push(w)}for(var O=[],j=0;j<e.length;++j)O.push({data:"originURL",type:[]});return"startTable"===r&&x.splice(0,0,O),x}function Fe(e){for(var t=[],a=0;a<e.length;++a){var r=Pe(e[a]);t.push(r)}return re(t).then((function(e){return Promise.resolve(e)}))}function Pe(e){for(var t=[],a=0;a<e.length;++a){var r=e[a].type;if(r.length>0){for(var n="SELECT",l=0;l<r.length;++l)n=n+"+%3Ftype"+l;n+="%0D%0A";for(var o="",i=0;i<r.length;++i)i>0&&(o+="UNION%0D%0A"),o=o+"%7Bdbo%3A"+r[i]+"+rdfs%3AsubClassOf%2B+%3Ftype"+i+"%7D%0D%0A";var s="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query="+n+"WHERE+%7B+%0D%0A"+(o+="%7D")+"&format=application%2Fsparql-results%2Bjson&timeout=30000&signal_void=on&signal_unconnected=on";t.push(te(s))}}return re(t).then((function(e){return Promise.resolve(e)}))}function Re(e,t){for(var a=[],r=0;r<t.length;++r)a.push(Le(e[r],t[r]));return a}function Le(e,t){for(var a=[],r=[],n=Z.a.cloneDeep(t),l=0;l<n.length;++l)0===n[l].type.length&&(n.splice(l,1),--l);for(var o=0;o<e.length;++o){for(var i={},s=0,c=e[o].results.bindings,u=0;u<c.length;++u){var p=Object.keys(c[u])[0];i[p]=(i[p]||0)+1,i[p]>s&&(s=i[p])}for(var h=[],d=0;d<Object.keys(i).length;++d){var g=Object.keys(i)[d];i[g]===s&&h.push(g)}for(var b=[],v=0;v<Object.keys(i).length;++v){for(var f=Object.keys(i)[v],m=[],C=0;C<c.length;++C)void 0!==c[C][f]&&"http://www.w3.org/2002/07/owl#Thing"!==c[C][f].value&&m.push(c[C][f].value.slice(28));m.length>0&&b.push({type:f,tree:m})}b.sort((function(e,t){return e.tree.length>t.tree.length?1:-1}));for(var y=0;y<h.length;++y){var E=Number(h[y].substring(4));h[y]=n[o].type[E]}for(var k=[],A=[],N=0;N<b.length;++N){for(var I=[],x=0;x<b[N].tree.length;++x){var D=b[N].tree[x];A.includes(D)||(A.push(D),I.push(D))}k.push(I)}k.push(h),a.push(k)}for(var w=0,S=0;S<t.length;++S)0===t[S].type.length?r.push([]):(r.push(a[w]),++w);for(var O=[],j=0,T=0;T<r.length;++T)r[T].length>j&&(j=r[T].length);for(var F=0;F<j;++F){for(var P={},R=0;R<r.length;++R)if(r[R].length>F)for(var L=0;L<r[R][F].length;++L){var U=r[R][F][L];P[U]=(P[U]||0)+1}O.push(P)}for(var H=t.length,M=0;M<O.length;++M)for(var B=O[M],_=0;_<Object.keys(B).length;++_){B[Object.keys(B)[_]]/=H}return O}function Ue(e,t,a){if(0===t[e].length)return-1;for(var r=-1,n=0,l=0;l<a.length;++l){var o=He(t[e],a[l]);o>n&&(n=o,r=l)}return r}function He(e,t){if(0===t.length)return 0;for(var a=0,r=0;r<e.length;++r){var n=Object.keys(e[r]);if(t.length>r)for(var l=0;l<n.length;++l){var o=n[l];if(void 0!==t[r][o])a+=Math.min(e[r][o],t[r][o])*(2^r)}}return a}var Me=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"wrapper "},n.a.createElement("div",{className:"font-body"},n.a.createElement("div",null,n.a.createElement(ee,null))))}}]),t}(r.Component);o.a.render(n.a.createElement(Me,null),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.b3c01940.chunk.js.map